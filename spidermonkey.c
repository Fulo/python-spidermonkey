/* Generated by Pyrex 0.9.8.5 on Thu Jan 22 22:14:29 2009 */

#define PY_SSIZE_T_CLEAN
#include "Python.h"
#include "structmember.h"
#ifndef PY_LONG_LONG
  #define PY_LONG_LONG LONG_LONG
#endif
#if PY_VERSION_HEX < 0x02050000
  typedef int Py_ssize_t;
  #define PY_SSIZE_T_MAX INT_MAX
  #define PY_SSIZE_T_MIN INT_MIN
  #define PyInt_FromSsize_t(z) PyInt_FromLong(z)
  #define PyInt_AsSsize_t(o)	PyInt_AsLong(o)
#endif
#if !defined(WIN32) && !defined(MS_WINDOWS)
  #ifndef __stdcall
    #define __stdcall
  #endif
  #ifndef __cdecl
    #define __cdecl
  #endif
#endif
#ifdef __cplusplus
#define __PYX_EXTERN_C extern "C"
#else
#define __PYX_EXTERN_C extern
#endif
#include <math.h>
#include "string.h"
#include "stdlib.h"
#include "jsapi.h"
#include "support.c"


typedef struct {PyObject **p; int i; char *s; long n;} __Pyx_StringTabEntry; /*proto*/

static PyObject *__pyx_m;
static PyObject *__pyx_b;
static int __pyx_lineno;
static char *__pyx_filename;
static char **__pyx_f;

static PyObject *__Pyx_GetName(PyObject *dict, PyObject *name); /*proto*/

static void __Pyx_WriteUnraisable(char *name); /*proto*/

static void __Pyx_Raise(PyObject *type, PyObject *value, PyObject *tb); /*proto*/

static int __Pyx_TypeTest(PyObject *obj, PyTypeObject *type); /*proto*/

static int __Pyx_GetStarArgs(PyObject **args, PyObject **kwds, char *kwd_list[],     Py_ssize_t nargs, PyObject **args2, PyObject **kwds2, char rqd_kwds[]); /*proto*/

static int __Pyx_ArgTypeTest(PyObject *obj, PyTypeObject *type, int none_allowed, char *name); /*proto*/

static PyObject *__Pyx_UnpackItem(PyObject *); /*proto*/
static int __Pyx_EndUnpack(PyObject *); /*proto*/

static int __Pyx_GetException(PyObject **type, PyObject **value, PyObject **tb); /*proto*/

static PyObject *__Pyx_GetItemInt(PyObject *o, Py_ssize_t i); /*proto*/

static int __Pyx_SetItemInt(PyObject *o, Py_ssize_t i, PyObject *v); /*proto*/

static int __Pyx_InitStrings(__Pyx_StringTabEntry *t); /*proto*/

static PyObject *__Pyx_Import(PyObject *name, PyObject *from_list); /*proto*/

static PyObject *__Pyx_CreateClass(PyObject *bases, PyObject *dict, PyObject *name, char *modname); /*proto*/

static void __Pyx_AddTraceback(char *funcname); /*proto*/

/* Declarations from spidermonkey */


/* Declarations from implementation of spidermonkey */

typedef int __pyx_t_12spidermonkey_jsuint;

typedef int __pyx_t_12spidermonkey_jsint;

typedef int __pyx_t_12spidermonkey_uint8;

typedef int __pyx_t_12spidermonkey_uint16;

typedef int __pyx_t_12spidermonkey_uint32;

typedef int __pyx_t_12spidermonkey_uintN;

typedef int __pyx_t_12spidermonkey_size_t;

typedef int __pyx_t_12spidermonkey_JSBool;

typedef int __pyx_t_12spidermonkey_jsval;

typedef int __pyx_t_12spidermonkey_jsid;

typedef int __pyx_t_12spidermonkey_jsword;

typedef char __pyx_t_12spidermonkey_jschar;

typedef double __pyx_t_12spidermonkey_jsdouble;

struct __pyx_obj_12spidermonkey_Runtime {
  PyObject_HEAD
  struct JSRuntime *rt;
  PyObject *_cxs;
};

struct __pyx_obj_12spidermonkey_Context {
  PyObject_HEAD
  struct JSContext *cx;
  struct JSObject *globj;
  struct __pyx_obj_12spidermonkey_Runtime *rt;
  PyObject *_funcs;
  PyObject *_classes;
  PyObject *_objs;
  PyObject *_script;
  PyObject *_evaled_script;
  PyObject *_last_error;
};

struct __pyx_obj_12spidermonkey_ProxyClass {
  PyObject_HEAD
  struct JSClass *jsc;
  PyObject *klass;
};

struct __pyx_obj_12spidermonkey_ProxyObject {
  PyObject_HEAD
  struct JSObject *jsobj;
  PyObject *obj;
};

struct __pyx_obj_12spidermonkey_ProxyFunction {
  PyObject_HEAD
  struct __pyx_obj_12spidermonkey_Context *cx;
  __pyx_t_12spidermonkey_jsval fun;
};






static PyTypeObject *__pyx_ptype_12spidermonkey_Runtime = 0;
static PyTypeObject *__pyx_ptype_12spidermonkey_Context = 0;
static PyTypeObject *__pyx_ptype_12spidermonkey_ProxyClass = 0;
static PyTypeObject *__pyx_ptype_12spidermonkey_ProxyObject = 0;
static PyTypeObject *__pyx_ptype_12spidermonkey_ProxyFunction = 0;
static __pyx_t_12spidermonkey_JSBool __pyx_f_12spidermonkey_report(struct JSContext *); /*proto*/
static void __pyx_f_12spidermonkey_report_error(struct JSContext *,char *,struct JSErrorReport *); /*proto*/
static void *__pyx_f_12spidermonkey_xmalloc(__pyx_t_12spidermonkey_size_t); /*proto*/
static struct __pyx_obj_12spidermonkey_Runtime *__pyx_f_12spidermonkey_get_runtime(struct JSRuntime *); /*proto*/
static struct __pyx_obj_12spidermonkey_Context *__pyx_f_12spidermonkey_get_context(struct JSContext *); /*proto*/
static struct __pyx_obj_12spidermonkey_Context *__pyx_f_12spidermonkey_runtime_get_context(struct __pyx_obj_12spidermonkey_Runtime *,struct JSContext *); /*proto*/
static void __pyx_f_12spidermonkey_context_register_object(struct __pyx_obj_12spidermonkey_Context *,PyObject *,struct JSObject *); /*proto*/
static void __pyx_f_12spidermonkey_context_add_object(struct __pyx_obj_12spidermonkey_Context *,struct __pyx_obj_12spidermonkey_ProxyObject *); /*proto*/
static void __pyx_f_12spidermonkey_context_remove_object(struct __pyx_obj_12spidermonkey_Context *,struct __pyx_obj_12spidermonkey_ProxyObject *); /*proto*/
static PyObject *__pyx_f_12spidermonkey_context_get_object(struct __pyx_obj_12spidermonkey_Context *,struct JSObject *); /*proto*/
static PyObject *__pyx_f_12spidermonkey_context_get_object_from_obj(struct __pyx_obj_12spidermonkey_Context *,PyObject *); /*proto*/
static PyObject *__pyx_f_12spidermonkey_context_get_callback_fn(struct __pyx_obj_12spidermonkey_Context *,PyObject *); /*proto*/
static struct __pyx_obj_12spidermonkey_ProxyClass *__pyx_f_12spidermonkey_context_get_class(struct __pyx_obj_12spidermonkey_Context *,PyObject *); /*proto*/
static struct __pyx_obj_12spidermonkey_ProxyFunction *__pyx_f_12spidermonkey_create_proxy_function(struct __pyx_obj_12spidermonkey_Context *,__pyx_t_12spidermonkey_jsval); /*proto*/
static __pyx_t_12spidermonkey_JSBool __pyx_f_12spidermonkey_constructor_cb(struct JSContext *,struct JSObject *,__pyx_t_12spidermonkey_uintN,__pyx_t_12spidermonkey_jsval *,__pyx_t_12spidermonkey_jsval *); /*proto*/
static __pyx_t_12spidermonkey_JSBool __pyx_f_12spidermonkey_bound_method_cb(struct JSContext *,struct JSObject *,__pyx_t_12spidermonkey_uintN,__pyx_t_12spidermonkey_jsval *,__pyx_t_12spidermonkey_jsval *); /*proto*/
static __pyx_t_12spidermonkey_jsval __pyx_f_12spidermonkey_new_method(struct JSContext *,PyObject *); /*proto*/
static __pyx_t_12spidermonkey_JSBool __pyx_f_12spidermonkey_resolve_global(struct JSContext *,struct JSObject *,__pyx_t_12spidermonkey_jsval); /*proto*/
static void __pyx_f_12spidermonkey_finalize(struct JSContext *,struct JSObject *); /*proto*/
static __pyx_t_12spidermonkey_JSBool __pyx_f_12spidermonkey_get_property(struct JSContext *,struct JSObject *,__pyx_t_12spidermonkey_jsval,__pyx_t_12spidermonkey_jsval *); /*proto*/
static __pyx_t_12spidermonkey_JSBool __pyx_f_12spidermonkey_set_property(struct JSContext *,struct JSObject *,__pyx_t_12spidermonkey_jsval,__pyx_t_12spidermonkey_jsval *); /*proto*/
static __pyx_t_12spidermonkey_JSBool __pyx_f_12spidermonkey_function_cb(struct JSContext *,struct JSObject *,__pyx_t_12spidermonkey_uintN,__pyx_t_12spidermonkey_jsval *,__pyx_t_12spidermonkey_jsval *); /*proto*/
static __pyx_t_12spidermonkey_jsval __pyx_f_12spidermonkey_JS_from_Py(struct JSContext *,struct JSObject *,PyObject *); /*proto*/
static PyObject *__pyx_f_12spidermonkey_dict_from_JShash(struct JSContext *,struct JSObject *); /*proto*/
static PyObject *__pyx_f_12spidermonkey_list_from_JSarray(struct JSContext *,struct JSObject *); /*proto*/
static PyObject *__pyx_f_12spidermonkey_Py_from_JSprimitive(__pyx_t_12spidermonkey_jsval); /*proto*/
static PyObject *__pyx_f_12spidermonkey_Py_from_JS(struct JSContext *,__pyx_t_12spidermonkey_jsval); /*proto*/

static char __pyx_k1[] = "TupleType";
static char __pyx_k2[] = "compat_isinstance";
static char __pyx_k3[] = "IntType";
static char __pyx_k4[] = "LongType";
static char __pyx_k5[] = "FloatType";
static char __pyx_k6[] = "StringTypes";
static char __pyx_k7[] = "ListType";
static char __pyx_k8[] = "DictType";
static char __pyx_k9[] = "StringIO";
static char __pyx_k10[] = "traceback";
static char __pyx_k11[] = "print_exc";
static char __pyx_k12[] = "getvalue";
static char __pyx_k13[] = "sys";
static char __pyx_k14[] = "stderr";
static char __pyx_k15[] = "write";
static char __pyx_k16[] = "%s:\n<no code>\n";
static char __pyx_k17[] = "max";
static char __pyx_k18[] = "min";
static char __pyx_k19[] = " %s\n";
static char __pyx_k20[] = "+%s\n";
static char __pyx_k21[] = "\nJavaScript error at line %d: \"%s\":\n%s\n";
static char __pyx_k22[] = "RUNTIMES";
static char __pyx_k23[] = "Runtime not found";
static char __pyx_k24[] = "can't create JavaScript runtime";
static char __pyx_k25[] = "append";
static char __pyx_k26[] = "finish_initialization";
static char __pyx_k27[] = "JSContext not found in Runtime '%s'";
static char __pyx_k28[] = "rt";
static char __pyx_k29[] = "can't create JavaScript context";
static char __pyx_k30[] = "bind_class";
static char __pyx_k31[] = "__class__";
static char __pyx_k32[] = "js_classname";
static char __pyx_k33[] = "can't create JS global object";
static char __pyx_k34[] = "can't initialise standard JS classes";
static char __pyx_k35[] = "can't define JavaScript functions";
static char __pyx_k36[] = "isstringlike";
static char __pyx_k37[] = "name must be string-like";
static char __pyx_k38[] = "can't get JavaScript property";
static char __pyx_k39[] = "no global named '%s'";
static char __pyx_k40[] = "callable";
static char __pyx_k41[] = "not a callable object";
static char __pyx_k42[] = "inspect";
static char __pyx_k43[] = "isclass";
static char __pyx_k44[] = "klass must be a class";
static char __pyx_k45[] = "isinteger";
static char __pyx_k46[] = "flags must be an integer";
static char __pyx_k47[] = "failed to bind Python object %s";
static char __pyx_k48[] = "no function named '%s'";
static char __pyx_k49[] = "extend";
static char __pyx_k50[] = "split";
static char __pyx_k51[] = "\n";
static char __pyx_k52[] = "Python";
static char __pyx_k53[] = "JSError";
static char __pyx_k54[] = "can't evaluate JavaScript script: %s";
static char __pyx_k55[] = "remove";
static char __pyx_k56[] = "object not found in context";
static char __pyx_k57[] = "no callback function named '%s' is bound";
static char __pyx_k58[] = "no class named '%s' is bound";
static char __pyx_k59[] = "couldn't initialise JavaScript proxy class";
static char __pyx_k60[] = "AttributeError";
static char __pyx_k61[] = "%s has no detectable class.";
static char __pyx_k62[] = "js_name";
static char __pyx_k63[] = "__name__";
static char __pyx_k64[] = "%s js_name attribute is not string-like";
static char __pyx_k65[] = "ok";
static char __pyx_k66[] = "Value is not a function: %s";
static char __pyx_k67[] = "couldn't get JS constructor";
static char __pyx_k68[] = "js_constructor";
static char __pyx_k69[] = "func_name";
static char __pyx_k70[] = "StringType";
static char __pyx_k71[] = "MethodType";
static char __pyx_k72[] = "bind_callable";
static char __pyx_k73[] = "bind_attribute";
static char __pyx_k74[] = "startswith";
static char __pyx_k75[] = "_";
static char __pyx_k76[] = "Illegal key: %s";
static char __pyx_k77[] = "Didn't expect key: %s";
static char __pyx_k78[] = "isfloat";
static char __pyx_k79[] = "can't create new double";
static char __pyx_k80[] = "can't create new string";
static char __pyx_k81[] = "ismapping";
static char __pyx_k82[] = "can't create new object";
static char __pyx_k83[] = "iteritems";
static char __pyx_k84[] = "can't define property";
static char __pyx_k85[] = "issequence";
static char __pyx_k86[] = "can't create new array object";
static char __pyx_k87[] = "can't define element";
static char __pyx_k88[] = "FunctionType";
static char __pyx_k89[] = "LambdaType";
static char __pyx_k90[] = "couldn't look up or create new object";
static char __pyx_k91[] = "can't happen";
static char __pyx_k92[] = "unknown primitive type";
static char __pyx_k93[] = "cStringIO";
static char __pyx_k94[] = "types";
static char __pyx_k95[] = "InstanceType";

static PyObject *__pyx_n_AttributeError;
static PyObject *__pyx_n_DictType;
static PyObject *__pyx_n_FloatType;
static PyObject *__pyx_n_FunctionType;
static PyObject *__pyx_n_InstanceType;
static PyObject *__pyx_n_IntType;
static PyObject *__pyx_n_JSError;
static PyObject *__pyx_n_LambdaType;
static PyObject *__pyx_n_ListType;
static PyObject *__pyx_n_LongType;
static PyObject *__pyx_n_MethodType;
static PyObject *__pyx_n_RUNTIMES;
static PyObject *__pyx_n_StringIO;
static PyObject *__pyx_n_StringType;
static PyObject *__pyx_n_StringTypes;
static PyObject *__pyx_n_TupleType;
static PyObject *__pyx_n__;
static PyObject *__pyx_n___class__;
static PyObject *__pyx_n___name__;
static PyObject *__pyx_n_append;
static PyObject *__pyx_n_bind_attribute;
static PyObject *__pyx_n_bind_callable;
static PyObject *__pyx_n_bind_class;
static PyObject *__pyx_n_cStringIO;
static PyObject *__pyx_n_callable;
static PyObject *__pyx_n_compat_isinstance;
static PyObject *__pyx_n_extend;
static PyObject *__pyx_n_finish_initialization;
static PyObject *__pyx_n_func_name;
static PyObject *__pyx_n_getvalue;
static PyObject *__pyx_n_inspect;
static PyObject *__pyx_n_isclass;
static PyObject *__pyx_n_isfloat;
static PyObject *__pyx_n_isinteger;
static PyObject *__pyx_n_ismapping;
static PyObject *__pyx_n_issequence;
static PyObject *__pyx_n_isstringlike;
static PyObject *__pyx_n_iteritems;
static PyObject *__pyx_n_js_classname;
static PyObject *__pyx_n_js_constructor;
static PyObject *__pyx_n_js_name;
static PyObject *__pyx_n_max;
static PyObject *__pyx_n_min;
static PyObject *__pyx_n_ok;
static PyObject *__pyx_n_print_exc;
static PyObject *__pyx_n_remove;
static PyObject *__pyx_n_rt;
static PyObject *__pyx_n_split;
static PyObject *__pyx_n_startswith;
static PyObject *__pyx_n_stderr;
static PyObject *__pyx_n_sys;
static PyObject *__pyx_n_traceback;
static PyObject *__pyx_n_types;
static PyObject *__pyx_n_write;

static PyObject *__pyx_k16p;
static PyObject *__pyx_k19p;
static PyObject *__pyx_k20p;
static PyObject *__pyx_k21p;
static PyObject *__pyx_k23p;
static PyObject *__pyx_k24p;
static PyObject *__pyx_k27p;
static PyObject *__pyx_k29p;
static PyObject *__pyx_k33p;
static PyObject *__pyx_k34p;
static PyObject *__pyx_k35p;
static PyObject *__pyx_k37p;
static PyObject *__pyx_k38p;
static PyObject *__pyx_k39p;
static PyObject *__pyx_k41p;
static PyObject *__pyx_k44p;
static PyObject *__pyx_k46p;
static PyObject *__pyx_k47p;
static PyObject *__pyx_k48p;
static PyObject *__pyx_k51p;
static PyObject *__pyx_k54p;
static PyObject *__pyx_k56p;
static PyObject *__pyx_k57p;
static PyObject *__pyx_k58p;
static PyObject *__pyx_k59p;
static PyObject *__pyx_k61p;
static PyObject *__pyx_k64p;
static PyObject *__pyx_k66p;
static PyObject *__pyx_k67p;
static PyObject *__pyx_k76p;
static PyObject *__pyx_k77p;
static PyObject *__pyx_k79p;
static PyObject *__pyx_k80p;
static PyObject *__pyx_k82p;
static PyObject *__pyx_k84p;
static PyObject *__pyx_k86p;
static PyObject *__pyx_k87p;
static PyObject *__pyx_k90p;
static PyObject *__pyx_k91p;
static PyObject *__pyx_k92p;

static __Pyx_StringTabEntry __pyx_string_tab[] = {
  {&__pyx_n_AttributeError, 1, __pyx_k60, sizeof(__pyx_k60)},
  {&__pyx_n_DictType, 1, __pyx_k8, sizeof(__pyx_k8)},
  {&__pyx_n_FloatType, 1, __pyx_k5, sizeof(__pyx_k5)},
  {&__pyx_n_FunctionType, 1, __pyx_k88, sizeof(__pyx_k88)},
  {&__pyx_n_InstanceType, 1, __pyx_k95, sizeof(__pyx_k95)},
  {&__pyx_n_IntType, 1, __pyx_k3, sizeof(__pyx_k3)},
  {&__pyx_n_JSError, 1, __pyx_k53, sizeof(__pyx_k53)},
  {&__pyx_n_LambdaType, 1, __pyx_k89, sizeof(__pyx_k89)},
  {&__pyx_n_ListType, 1, __pyx_k7, sizeof(__pyx_k7)},
  {&__pyx_n_LongType, 1, __pyx_k4, sizeof(__pyx_k4)},
  {&__pyx_n_MethodType, 1, __pyx_k71, sizeof(__pyx_k71)},
  {&__pyx_n_RUNTIMES, 1, __pyx_k22, sizeof(__pyx_k22)},
  {&__pyx_n_StringIO, 1, __pyx_k9, sizeof(__pyx_k9)},
  {&__pyx_n_StringType, 1, __pyx_k70, sizeof(__pyx_k70)},
  {&__pyx_n_StringTypes, 1, __pyx_k6, sizeof(__pyx_k6)},
  {&__pyx_n_TupleType, 1, __pyx_k1, sizeof(__pyx_k1)},
  {&__pyx_n__, 1, __pyx_k75, sizeof(__pyx_k75)},
  {&__pyx_n___class__, 1, __pyx_k31, sizeof(__pyx_k31)},
  {&__pyx_n___name__, 1, __pyx_k63, sizeof(__pyx_k63)},
  {&__pyx_n_append, 1, __pyx_k25, sizeof(__pyx_k25)},
  {&__pyx_n_bind_attribute, 1, __pyx_k73, sizeof(__pyx_k73)},
  {&__pyx_n_bind_callable, 1, __pyx_k72, sizeof(__pyx_k72)},
  {&__pyx_n_bind_class, 1, __pyx_k30, sizeof(__pyx_k30)},
  {&__pyx_n_cStringIO, 1, __pyx_k93, sizeof(__pyx_k93)},
  {&__pyx_n_callable, 1, __pyx_k40, sizeof(__pyx_k40)},
  {&__pyx_n_compat_isinstance, 1, __pyx_k2, sizeof(__pyx_k2)},
  {&__pyx_n_extend, 1, __pyx_k49, sizeof(__pyx_k49)},
  {&__pyx_n_finish_initialization, 1, __pyx_k26, sizeof(__pyx_k26)},
  {&__pyx_n_func_name, 1, __pyx_k69, sizeof(__pyx_k69)},
  {&__pyx_n_getvalue, 1, __pyx_k12, sizeof(__pyx_k12)},
  {&__pyx_n_inspect, 1, __pyx_k42, sizeof(__pyx_k42)},
  {&__pyx_n_isclass, 1, __pyx_k43, sizeof(__pyx_k43)},
  {&__pyx_n_isfloat, 1, __pyx_k78, sizeof(__pyx_k78)},
  {&__pyx_n_isinteger, 1, __pyx_k45, sizeof(__pyx_k45)},
  {&__pyx_n_ismapping, 1, __pyx_k81, sizeof(__pyx_k81)},
  {&__pyx_n_issequence, 1, __pyx_k85, sizeof(__pyx_k85)},
  {&__pyx_n_isstringlike, 1, __pyx_k36, sizeof(__pyx_k36)},
  {&__pyx_n_iteritems, 1, __pyx_k83, sizeof(__pyx_k83)},
  {&__pyx_n_js_classname, 1, __pyx_k32, sizeof(__pyx_k32)},
  {&__pyx_n_js_constructor, 1, __pyx_k68, sizeof(__pyx_k68)},
  {&__pyx_n_js_name, 1, __pyx_k62, sizeof(__pyx_k62)},
  {&__pyx_n_max, 1, __pyx_k17, sizeof(__pyx_k17)},
  {&__pyx_n_min, 1, __pyx_k18, sizeof(__pyx_k18)},
  {&__pyx_n_ok, 1, __pyx_k65, sizeof(__pyx_k65)},
  {&__pyx_n_print_exc, 1, __pyx_k11, sizeof(__pyx_k11)},
  {&__pyx_n_remove, 1, __pyx_k55, sizeof(__pyx_k55)},
  {&__pyx_n_rt, 1, __pyx_k28, sizeof(__pyx_k28)},
  {&__pyx_n_split, 1, __pyx_k50, sizeof(__pyx_k50)},
  {&__pyx_n_startswith, 1, __pyx_k74, sizeof(__pyx_k74)},
  {&__pyx_n_stderr, 1, __pyx_k14, sizeof(__pyx_k14)},
  {&__pyx_n_sys, 1, __pyx_k13, sizeof(__pyx_k13)},
  {&__pyx_n_traceback, 1, __pyx_k10, sizeof(__pyx_k10)},
  {&__pyx_n_types, 1, __pyx_k94, sizeof(__pyx_k94)},
  {&__pyx_n_write, 1, __pyx_k15, sizeof(__pyx_k15)},
  {&__pyx_k16p, 0, __pyx_k16, sizeof(__pyx_k16)},
  {&__pyx_k19p, 0, __pyx_k19, sizeof(__pyx_k19)},
  {&__pyx_k20p, 0, __pyx_k20, sizeof(__pyx_k20)},
  {&__pyx_k21p, 0, __pyx_k21, sizeof(__pyx_k21)},
  {&__pyx_k23p, 0, __pyx_k23, sizeof(__pyx_k23)},
  {&__pyx_k24p, 0, __pyx_k24, sizeof(__pyx_k24)},
  {&__pyx_k27p, 0, __pyx_k27, sizeof(__pyx_k27)},
  {&__pyx_k29p, 0, __pyx_k29, sizeof(__pyx_k29)},
  {&__pyx_k33p, 0, __pyx_k33, sizeof(__pyx_k33)},
  {&__pyx_k34p, 0, __pyx_k34, sizeof(__pyx_k34)},
  {&__pyx_k35p, 0, __pyx_k35, sizeof(__pyx_k35)},
  {&__pyx_k37p, 0, __pyx_k37, sizeof(__pyx_k37)},
  {&__pyx_k38p, 0, __pyx_k38, sizeof(__pyx_k38)},
  {&__pyx_k39p, 0, __pyx_k39, sizeof(__pyx_k39)},
  {&__pyx_k41p, 0, __pyx_k41, sizeof(__pyx_k41)},
  {&__pyx_k44p, 0, __pyx_k44, sizeof(__pyx_k44)},
  {&__pyx_k46p, 0, __pyx_k46, sizeof(__pyx_k46)},
  {&__pyx_k47p, 0, __pyx_k47, sizeof(__pyx_k47)},
  {&__pyx_k48p, 0, __pyx_k48, sizeof(__pyx_k48)},
  {&__pyx_k51p, 0, __pyx_k51, sizeof(__pyx_k51)},
  {&__pyx_k54p, 0, __pyx_k54, sizeof(__pyx_k54)},
  {&__pyx_k56p, 0, __pyx_k56, sizeof(__pyx_k56)},
  {&__pyx_k57p, 0, __pyx_k57, sizeof(__pyx_k57)},
  {&__pyx_k58p, 0, __pyx_k58, sizeof(__pyx_k58)},
  {&__pyx_k59p, 0, __pyx_k59, sizeof(__pyx_k59)},
  {&__pyx_k61p, 0, __pyx_k61, sizeof(__pyx_k61)},
  {&__pyx_k64p, 0, __pyx_k64, sizeof(__pyx_k64)},
  {&__pyx_k66p, 0, __pyx_k66, sizeof(__pyx_k66)},
  {&__pyx_k67p, 0, __pyx_k67, sizeof(__pyx_k67)},
  {&__pyx_k76p, 0, __pyx_k76, sizeof(__pyx_k76)},
  {&__pyx_k77p, 0, __pyx_k77, sizeof(__pyx_k77)},
  {&__pyx_k79p, 0, __pyx_k79, sizeof(__pyx_k79)},
  {&__pyx_k80p, 0, __pyx_k80, sizeof(__pyx_k80)},
  {&__pyx_k82p, 0, __pyx_k82, sizeof(__pyx_k82)},
  {&__pyx_k84p, 0, __pyx_k84, sizeof(__pyx_k84)},
  {&__pyx_k86p, 0, __pyx_k86, sizeof(__pyx_k86)},
  {&__pyx_k87p, 0, __pyx_k87, sizeof(__pyx_k87)},
  {&__pyx_k90p, 0, __pyx_k90, sizeof(__pyx_k90)},
  {&__pyx_k91p, 0, __pyx_k91, sizeof(__pyx_k91)},
  {&__pyx_k92p, 0, __pyx_k92, sizeof(__pyx_k92)},
  {0, 0, 0, 0}
};

static PyObject *__pyx_d1;
static PyObject *__pyx_d2;
static PyObject *__pyx_d3;
static PyObject *__pyx_d4;


/* Implementation of spidermonkey */

static PyObject *__pyx_f_12spidermonkey_compat_isinstance(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_12spidermonkey_compat_isinstance(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_obj = 0;
  PyObject *__pyx_v_tuple_or_obj = 0;
  PyObject *__pyx_v_otherobj;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  int __pyx_3;
  static char *__pyx_argnames[] = {"obj","tuple_or_obj",0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "OO", __pyx_argnames, &__pyx_v_obj, &__pyx_v_tuple_or_obj)) return 0;
  Py_INCREF(__pyx_v_obj);
  Py_INCREF(__pyx_v_tuple_or_obj);
  __pyx_v_otherobj = Py_None; Py_INCREF(Py_None);

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":371 */
  __pyx_1 = PyTuple_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 371; goto __pyx_L1;}
  Py_INCREF(__pyx_v_tuple_or_obj);
  PyTuple_SET_ITEM(__pyx_1, 0, __pyx_v_tuple_or_obj);
  __pyx_2 = PyObject_CallObject(((PyObject *)(&PyType_Type)), __pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 371; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_TupleType); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 371; goto __pyx_L1;}
  if (PyObject_Cmp(__pyx_2, __pyx_1, &__pyx_3) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 371; goto __pyx_L1;}
  __pyx_3 = __pyx_3 == 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  if (__pyx_3) {

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":372 */
    __pyx_2 = PyObject_GetIter(__pyx_v_tuple_or_obj); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 372; goto __pyx_L1;}
    for (;;) {
      __pyx_1 = PyIter_Next(__pyx_2);
      if (!__pyx_1) {
        if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 372; goto __pyx_L1;}
        break;
      }
      Py_DECREF(__pyx_v_otherobj);
      __pyx_v_otherobj = __pyx_1;
      __pyx_1 = 0;
      __pyx_3 = PyObject_IsInstance(__pyx_v_obj,__pyx_v_otherobj); if (__pyx_3 == -1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 373; goto __pyx_L1;}
      if (__pyx_3) {
        Py_INCREF(Py_True);
        __pyx_r = Py_True;
        Py_DECREF(__pyx_2); __pyx_2 = 0;
        goto __pyx_L0;
        goto __pyx_L5;
      }
      __pyx_L5:;
    }
    Py_DECREF(__pyx_2); __pyx_2 = 0;

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":375 */
    Py_INCREF(Py_False);
    __pyx_r = Py_False;
    goto __pyx_L0;
    goto __pyx_L2;
  }
  __pyx_L2:;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":376 */
  __pyx_3 = PyObject_IsInstance(__pyx_v_obj,__pyx_v_tuple_or_obj); if (__pyx_3 == -1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 376; goto __pyx_L1;}
  __pyx_1 = PyInt_FromLong(__pyx_3); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 376; goto __pyx_L1;}
  __pyx_r = __pyx_1;
  __pyx_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  __Pyx_AddTraceback("spidermonkey.compat_isinstance");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_otherobj);
  Py_DECREF(__pyx_v_obj);
  Py_DECREF(__pyx_v_tuple_or_obj);
  return __pyx_r;
}

static PyObject *__pyx_f_12spidermonkey_isinteger(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_12spidermonkey_isinteger(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_x = 0;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  PyObject *__pyx_4 = 0;
  int __pyx_5;
  static char *__pyx_argnames[] = {"x",0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "O", __pyx_argnames, &__pyx_v_x)) return 0;
  Py_INCREF(__pyx_v_x);
  __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_compat_isinstance); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 379; goto __pyx_L1;}
  __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_IntType); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 379; goto __pyx_L1;}
  __pyx_3 = __Pyx_GetName(__pyx_m, __pyx_n_LongType); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 379; goto __pyx_L1;}
  __pyx_4 = PyTuple_New(2); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 379; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_4, 0, __pyx_2);
  PyTuple_SET_ITEM(__pyx_4, 1, __pyx_3);
  __pyx_2 = 0;
  __pyx_3 = 0;
  __pyx_2 = PyTuple_New(2); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 379; goto __pyx_L1;}
  Py_INCREF(__pyx_v_x);
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_v_x);
  PyTuple_SET_ITEM(__pyx_2, 1, __pyx_4);
  __pyx_4 = 0;
  __pyx_3 = PyObject_CallObject(__pyx_1, __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 379; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_5 = PyObject_IsTrue(__pyx_3); if (__pyx_5 == -1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 379; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  __pyx_4 = PyInt_FromLong(__pyx_5); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 379; goto __pyx_L1;}
  __pyx_r = __pyx_4;
  __pyx_4 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  Py_XDECREF(__pyx_4);
  __Pyx_AddTraceback("spidermonkey.isinteger");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_x);
  return __pyx_r;
}

static PyObject *__pyx_f_12spidermonkey_isfloat(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_12spidermonkey_isfloat(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_x = 0;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  int __pyx_4;
  static char *__pyx_argnames[] = {"x",0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "O", __pyx_argnames, &__pyx_v_x)) return 0;
  Py_INCREF(__pyx_v_x);
  __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_compat_isinstance); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 382; goto __pyx_L1;}
  __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_FloatType); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 382; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 382; goto __pyx_L1;}
  Py_INCREF(__pyx_v_x);
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_v_x);
  PyTuple_SET_ITEM(__pyx_3, 1, __pyx_2);
  __pyx_2 = 0;
  __pyx_2 = PyObject_CallObject(__pyx_1, __pyx_3); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 382; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  __pyx_4 = PyObject_IsTrue(__pyx_2); if (__pyx_4 == -1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 382; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_1 = PyInt_FromLong(__pyx_4); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 382; goto __pyx_L1;}
  __pyx_r = __pyx_1;
  __pyx_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  __Pyx_AddTraceback("spidermonkey.isfloat");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_x);
  return __pyx_r;
}

static PyObject *__pyx_f_12spidermonkey_isstringlike(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_12spidermonkey_isstringlike(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_x = 0;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  int __pyx_4;
  static char *__pyx_argnames[] = {"x",0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "O", __pyx_argnames, &__pyx_v_x)) return 0;
  Py_INCREF(__pyx_v_x);
  __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_compat_isinstance); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 385; goto __pyx_L1;}
  __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_StringTypes); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 385; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 385; goto __pyx_L1;}
  Py_INCREF(__pyx_v_x);
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_v_x);
  PyTuple_SET_ITEM(__pyx_3, 1, __pyx_2);
  __pyx_2 = 0;
  __pyx_2 = PyObject_CallObject(__pyx_1, __pyx_3); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 385; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  __pyx_4 = PyObject_IsTrue(__pyx_2); if (__pyx_4 == -1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 385; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_1 = PyInt_FromLong(__pyx_4); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 385; goto __pyx_L1;}
  __pyx_r = __pyx_1;
  __pyx_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  __Pyx_AddTraceback("spidermonkey.isstringlike");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_x);
  return __pyx_r;
}

static PyObject *__pyx_f_12spidermonkey_issequence(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_12spidermonkey_issequence(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_x = 0;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  PyObject *__pyx_4 = 0;
  int __pyx_5;
  static char *__pyx_argnames[] = {"x",0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "O", __pyx_argnames, &__pyx_v_x)) return 0;
  Py_INCREF(__pyx_v_x);
  __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_compat_isinstance); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 388; goto __pyx_L1;}
  __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_ListType); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 388; goto __pyx_L1;}
  __pyx_3 = __Pyx_GetName(__pyx_m, __pyx_n_TupleType); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 388; goto __pyx_L1;}
  __pyx_4 = PyTuple_New(2); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 388; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_4, 0, __pyx_2);
  PyTuple_SET_ITEM(__pyx_4, 1, __pyx_3);
  __pyx_2 = 0;
  __pyx_3 = 0;
  __pyx_2 = PyTuple_New(2); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 388; goto __pyx_L1;}
  Py_INCREF(__pyx_v_x);
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_v_x);
  PyTuple_SET_ITEM(__pyx_2, 1, __pyx_4);
  __pyx_4 = 0;
  __pyx_3 = PyObject_CallObject(__pyx_1, __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 388; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_5 = PyObject_IsTrue(__pyx_3); if (__pyx_5 == -1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 388; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  __pyx_4 = PyInt_FromLong(__pyx_5); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 388; goto __pyx_L1;}
  __pyx_r = __pyx_4;
  __pyx_4 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  Py_XDECREF(__pyx_4);
  __Pyx_AddTraceback("spidermonkey.issequence");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_x);
  return __pyx_r;
}

static PyObject *__pyx_f_12spidermonkey_ismapping(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_12spidermonkey_ismapping(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_x = 0;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  int __pyx_4;
  static char *__pyx_argnames[] = {"x",0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "O", __pyx_argnames, &__pyx_v_x)) return 0;
  Py_INCREF(__pyx_v_x);
  __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_compat_isinstance); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; goto __pyx_L1;}
  __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_DictType); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; goto __pyx_L1;}
  Py_INCREF(__pyx_v_x);
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_v_x);
  PyTuple_SET_ITEM(__pyx_3, 1, __pyx_2);
  __pyx_2 = 0;
  __pyx_2 = PyObject_CallObject(__pyx_1, __pyx_3); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  __pyx_4 = PyObject_IsTrue(__pyx_2); if (__pyx_4 == -1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_1 = PyInt_FromLong(__pyx_4); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 391; goto __pyx_L1;}
  __pyx_r = __pyx_1;
  __pyx_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  __Pyx_AddTraceback("spidermonkey.ismapping");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_x);
  return __pyx_r;
}

static __pyx_t_12spidermonkey_JSBool __pyx_f_12spidermonkey_report(struct JSContext *__pyx_v_cx) {
  PyObject *__pyx_v_f;
  PyObject *__pyx_v_msg;
  __pyx_t_12spidermonkey_JSBool __pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  __pyx_v_f = Py_None; Py_INCREF(Py_None);
  __pyx_v_msg = Py_None; Py_INCREF(Py_None);

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":395 */
  __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_StringIO); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 395; goto __pyx_L1;}
  __pyx_2 = PyObject_CallObject(__pyx_1, 0); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 395; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_v_f);
  __pyx_v_f = __pyx_2;
  __pyx_2 = 0;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":396 */
  __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_traceback); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 396; goto __pyx_L1;}
  __pyx_2 = PyObject_GetAttr(__pyx_1, __pyx_n_print_exc); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 396; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  __pyx_1 = PyTuple_New(2); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 396; goto __pyx_L1;}
  Py_INCREF(Py_None);
  PyTuple_SET_ITEM(__pyx_1, 0, Py_None);
  Py_INCREF(__pyx_v_f);
  PyTuple_SET_ITEM(__pyx_1, 1, __pyx_v_f);
  __pyx_3 = PyObject_CallObject(__pyx_2, __pyx_1); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 396; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":397 */
  __pyx_2 = PyObject_GetAttr(__pyx_v_f, __pyx_n_getvalue); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 397; goto __pyx_L1;}
  __pyx_1 = PyObject_CallObject(__pyx_2, 0); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 397; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_v_msg);
  __pyx_v_msg = __pyx_1;
  __pyx_1 = 0;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":400 */
  __pyx_3 = __Pyx_GetName(__pyx_m, __pyx_n_sys); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 400; goto __pyx_L1;}
  __pyx_2 = PyObject_GetAttr(__pyx_3, __pyx_n_stderr); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 400; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  __pyx_1 = PyObject_GetAttr(__pyx_2, __pyx_n_write); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 400; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 400; goto __pyx_L1;}
  Py_INCREF(__pyx_v_msg);
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_v_msg);
  __pyx_2 = PyObject_CallObject(__pyx_1, __pyx_3); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 400; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":401 */
  __pyx_r = JS_FALSE;
  goto __pyx_L0;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  __Pyx_WriteUnraisable("spidermonkey.report");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_f);
  Py_DECREF(__pyx_v_msg);
  return __pyx_r;
}

static void __pyx_f_12spidermonkey_report_error(struct JSContext *__pyx_v_cx,char *__pyx_v_message,struct JSErrorReport *__pyx_v_report) {
  struct __pyx_obj_12spidermonkey_Context *__pyx_v_context;
  PyObject *__pyx_v_lines;
  PyObject *__pyx_v_msg;
  PyObject *__pyx_v_i;
  PyObject *__pyx_v_n;
  PyObject *__pyx_v_start;
  PyObject *__pyx_v_end;
  PyObject *__pyx_v_nr_pre;
  PyObject *__pyx_v_nr_post;
  PyObject *__pyx_v_data;
  PyObject *__pyx_v_outer_fmt;
  PyObject *__pyx_v_inner_fmt;
  PyObject *__pyx_v_fmt;
  PyObject *__pyx_v_line;
  PyObject *__pyx_1 = 0;
  Py_ssize_t __pyx_2;
  int __pyx_3;
  PyObject *__pyx_4 = 0;
  PyObject *__pyx_5 = 0;
  PyObject *__pyx_6 = 0;
  Py_ssize_t __pyx_7;
  __pyx_v_context = ((struct __pyx_obj_12spidermonkey_Context *)Py_None); Py_INCREF(Py_None);
  __pyx_v_lines = Py_None; Py_INCREF(Py_None);
  __pyx_v_msg = Py_None; Py_INCREF(Py_None);
  __pyx_v_i = Py_None; Py_INCREF(Py_None);
  __pyx_v_n = Py_None; Py_INCREF(Py_None);
  __pyx_v_start = Py_None; Py_INCREF(Py_None);
  __pyx_v_end = Py_None; Py_INCREF(Py_None);
  __pyx_v_nr_pre = Py_None; Py_INCREF(Py_None);
  __pyx_v_nr_post = Py_None; Py_INCREF(Py_None);
  __pyx_v_data = Py_None; Py_INCREF(Py_None);
  __pyx_v_outer_fmt = Py_None; Py_INCREF(Py_None);
  __pyx_v_inner_fmt = Py_None; Py_INCREF(Py_None);
  __pyx_v_fmt = Py_None; Py_INCREF(Py_None);
  __pyx_v_line = Py_None; Py_INCREF(Py_None);

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":407 */
  __pyx_1 = ((PyObject *)__pyx_f_12spidermonkey_get_context(__pyx_v_cx)); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 407; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_context));
  __pyx_v_context = ((struct __pyx_obj_12spidermonkey_Context *)__pyx_1);
  __pyx_1 = 0;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":409 */
  Py_INCREF(__pyx_v_context->_evaled_script);
  Py_DECREF(__pyx_v_lines);
  __pyx_v_lines = __pyx_v_context->_evaled_script;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":411 */
  __pyx_2 = PyObject_Length(__pyx_v_lines); if (__pyx_2 == -1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 411; goto __pyx_L1;}
  __pyx_3 = (__pyx_2 == 0);
  if (__pyx_3) {
    __pyx_1 = PyString_FromString(__pyx_v_message); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 412; goto __pyx_L1;}
    __pyx_4 = PyNumber_Remainder(__pyx_k16p, __pyx_1); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 412; goto __pyx_L1;}
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    Py_DECREF(__pyx_v_msg);
    __pyx_v_msg = __pyx_4;
    __pyx_4 = 0;
    goto __pyx_L2;
  }
  /*else*/ {

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":414 */
    __pyx_1 = PyInt_FromLong(__pyx_v_report->lineno); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 414; goto __pyx_L1;}
    Py_DECREF(__pyx_v_i);
    __pyx_v_i = __pyx_1;
    __pyx_1 = 0;

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":415 */
    __pyx_4 = PyInt_FromLong(2); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 415; goto __pyx_L1;}
    Py_DECREF(__pyx_v_n);
    __pyx_v_n = __pyx_4;
    __pyx_4 = 0;

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":417 */
    __pyx_1 = __Pyx_GetName(__pyx_b, __pyx_n_max); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 417; goto __pyx_L1;}
    __pyx_4 = PyNumber_Subtract(__pyx_v_i, __pyx_v_n); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 417; goto __pyx_L1;}
    __pyx_5 = PyInt_FromLong(0); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 417; goto __pyx_L1;}
    __pyx_6 = PyTuple_New(2); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 417; goto __pyx_L1;}
    PyTuple_SET_ITEM(__pyx_6, 0, __pyx_4);
    PyTuple_SET_ITEM(__pyx_6, 1, __pyx_5);
    __pyx_4 = 0;
    __pyx_5 = 0;
    __pyx_4 = PyObject_CallObject(__pyx_1, __pyx_6); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 417; goto __pyx_L1;}
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    Py_DECREF(__pyx_6); __pyx_6 = 0;
    Py_DECREF(__pyx_v_start);
    __pyx_v_start = __pyx_4;
    __pyx_4 = 0;

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":418 */
    __pyx_5 = __Pyx_GetName(__pyx_b, __pyx_n_min); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 418; goto __pyx_L1;}
    __pyx_1 = PyNumber_Add(__pyx_v_i, __pyx_v_n); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 418; goto __pyx_L1;}
    __pyx_6 = PyInt_FromLong(1); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 418; goto __pyx_L1;}
    __pyx_4 = PyNumber_Add(__pyx_1, __pyx_6); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 418; goto __pyx_L1;}
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    Py_DECREF(__pyx_6); __pyx_6 = 0;
    __pyx_2 = PyObject_Length(__pyx_v_lines); if (__pyx_2 == -1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 418; goto __pyx_L1;}
    __pyx_1 = PyInt_FromSsize_t(__pyx_2); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 418; goto __pyx_L1;}
    __pyx_6 = PyTuple_New(2); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 418; goto __pyx_L1;}
    PyTuple_SET_ITEM(__pyx_6, 0, __pyx_4);
    PyTuple_SET_ITEM(__pyx_6, 1, __pyx_1);
    __pyx_4 = 0;
    __pyx_1 = 0;
    __pyx_4 = PyObject_CallObject(__pyx_5, __pyx_6); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 418; goto __pyx_L1;}
    Py_DECREF(__pyx_5); __pyx_5 = 0;
    Py_DECREF(__pyx_6); __pyx_6 = 0;
    Py_DECREF(__pyx_v_end);
    __pyx_v_end = __pyx_4;
    __pyx_4 = 0;

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":419 */
    __pyx_1 = PyNumber_Subtract(__pyx_v_i, __pyx_v_start); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 419; goto __pyx_L1;}
    Py_DECREF(__pyx_v_nr_pre);
    __pyx_v_nr_pre = __pyx_1;
    __pyx_1 = 0;

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":420 */
    __pyx_5 = PyNumber_Subtract(__pyx_v_end, __pyx_v_i); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 420; goto __pyx_L1;}
    __pyx_6 = PyInt_FromLong(1); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 420; goto __pyx_L1;}
    __pyx_4 = PyNumber_Subtract(__pyx_5, __pyx_6); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 420; goto __pyx_L1;}
    Py_DECREF(__pyx_5); __pyx_5 = 0;
    Py_DECREF(__pyx_6); __pyx_6 = 0;
    Py_DECREF(__pyx_v_nr_post);
    __pyx_v_nr_post = __pyx_4;
    __pyx_4 = 0;

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":422 */
    __pyx_2 = PyInt_AsSsize_t(__pyx_v_start); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 422; goto __pyx_L1;}
    __pyx_7 = PyInt_AsSsize_t(__pyx_v_end); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 422; goto __pyx_L1;}
    __pyx_1 = PySequence_GetSlice(__pyx_v_lines, __pyx_2, __pyx_7); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 422; goto __pyx_L1;}
    __pyx_5 = PyTuple_New(1); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 422; goto __pyx_L1;}
    PyTuple_SET_ITEM(__pyx_5, 0, __pyx_1);
    __pyx_1 = 0;
    __pyx_6 = PyObject_CallObject(((PyObject *)(&PyTuple_Type)), __pyx_5); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 422; goto __pyx_L1;}
    Py_DECREF(__pyx_5); __pyx_5 = 0;
    Py_DECREF(__pyx_v_data);
    __pyx_v_data = __pyx_6;
    __pyx_6 = 0;

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":424 */
    Py_INCREF(__pyx_k19p);
    Py_DECREF(__pyx_v_outer_fmt);
    __pyx_v_outer_fmt = __pyx_k19p;

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":425 */
    Py_INCREF(__pyx_k20p);
    Py_DECREF(__pyx_v_inner_fmt);
    __pyx_v_inner_fmt = __pyx_k20p;

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":426 */
    __pyx_4 = PyNumber_Multiply(__pyx_v_outer_fmt, __pyx_v_nr_pre); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 426; goto __pyx_L1;}
    __pyx_1 = PyNumber_Add(__pyx_4, __pyx_v_inner_fmt); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 426; goto __pyx_L1;}
    Py_DECREF(__pyx_4); __pyx_4 = 0;
    __pyx_5 = PyNumber_Multiply(__pyx_v_outer_fmt, __pyx_v_nr_post); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 426; goto __pyx_L1;}
    __pyx_6 = PyNumber_Add(__pyx_1, __pyx_5); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 426; goto __pyx_L1;}
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    Py_DECREF(__pyx_5); __pyx_5 = 0;
    Py_DECREF(__pyx_v_fmt);
    __pyx_v_fmt = __pyx_6;
    __pyx_6 = 0;

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":427 */
    __pyx_4 = PyNumber_Remainder(__pyx_v_fmt, __pyx_v_data); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 427; goto __pyx_L1;}
    Py_DECREF(__pyx_v_line);
    __pyx_v_line = __pyx_4;
    __pyx_4 = 0;

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":428 */
    __pyx_1 = PyInt_FromLong(__pyx_v_report->lineno); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 428; goto __pyx_L1;}
    __pyx_5 = PyString_FromString(__pyx_v_message); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 428; goto __pyx_L1;}
    __pyx_6 = PyTuple_New(3); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 428; goto __pyx_L1;}
    PyTuple_SET_ITEM(__pyx_6, 0, __pyx_1);
    PyTuple_SET_ITEM(__pyx_6, 1, __pyx_5);
    Py_INCREF(__pyx_v_line);
    PyTuple_SET_ITEM(__pyx_6, 2, __pyx_v_line);
    __pyx_1 = 0;
    __pyx_5 = 0;
    __pyx_4 = PyNumber_Remainder(__pyx_k21p, __pyx_6); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 428; goto __pyx_L1;}
    Py_DECREF(__pyx_6); __pyx_6 = 0;
    Py_DECREF(__pyx_v_msg);
    __pyx_v_msg = __pyx_4;
    __pyx_4 = 0;
  }
  __pyx_L2:;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":429 */
  Py_INCREF(__pyx_v_msg);
  Py_DECREF(__pyx_v_context->_last_error);
  __pyx_v_context->_last_error = __pyx_v_msg;

  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_4);
  Py_XDECREF(__pyx_5);
  Py_XDECREF(__pyx_6);
  __Pyx_WriteUnraisable("spidermonkey.report_error");
  __pyx_L0:;
  Py_DECREF(__pyx_v_context);
  Py_DECREF(__pyx_v_lines);
  Py_DECREF(__pyx_v_msg);
  Py_DECREF(__pyx_v_i);
  Py_DECREF(__pyx_v_n);
  Py_DECREF(__pyx_v_start);
  Py_DECREF(__pyx_v_end);
  Py_DECREF(__pyx_v_nr_pre);
  Py_DECREF(__pyx_v_nr_post);
  Py_DECREF(__pyx_v_data);
  Py_DECREF(__pyx_v_outer_fmt);
  Py_DECREF(__pyx_v_inner_fmt);
  Py_DECREF(__pyx_v_fmt);
  Py_DECREF(__pyx_v_line);
}

static void *__pyx_f_12spidermonkey_xmalloc(__pyx_t_12spidermonkey_size_t __pyx_v_size) {
  void *__pyx_v_mem;
  void *__pyx_r;
  int __pyx_1;
  PyObject *__pyx_2 = 0;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":433 */
  __pyx_v_mem = malloc(__pyx_v_size);

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":434 */
  __pyx_1 = (((int)__pyx_v_mem) == 0);
  if (__pyx_1) {
    __pyx_2 = PyObject_CallObject(PyExc_MemoryError, 0); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 435; goto __pyx_L1;}
    __Pyx_Raise(__pyx_2, 0, 0);
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 435; goto __pyx_L1;}
    goto __pyx_L2;
  }
  __pyx_L2:;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":436 */
  __pyx_r = __pyx_v_mem;
  goto __pyx_L0;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_2);
  __Pyx_AddTraceback("spidermonkey.xmalloc");
  __pyx_r = NULL;
  __pyx_L0:;
  return __pyx_r;
}

static struct __pyx_obj_12spidermonkey_Runtime *__pyx_f_12spidermonkey_get_runtime(struct JSRuntime *__pyx_v_crt) {
  struct __pyx_obj_12spidermonkey_Runtime *__pyx_v_rt;
  struct __pyx_obj_12spidermonkey_Runtime *__pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  int __pyx_3;
  __pyx_v_rt = ((struct __pyx_obj_12spidermonkey_Runtime *)Py_None); Py_INCREF(Py_None);

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":442 */
  __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_RUNTIMES); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 442; goto __pyx_L1;}
  __pyx_2 = PyObject_GetIter(__pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 442; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  for (;;) {
    __pyx_1 = PyIter_Next(__pyx_2);
    if (!__pyx_1) {
      if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 442; goto __pyx_L1;}
      break;
    }
    if (!__Pyx_TypeTest(__pyx_1, __pyx_ptype_12spidermonkey_Runtime)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 442; goto __pyx_L1;}
    Py_DECREF(((PyObject *)__pyx_v_rt));
    __pyx_v_rt = ((struct __pyx_obj_12spidermonkey_Runtime *)__pyx_1);
    __pyx_1 = 0;
    __pyx_3 = (__pyx_v_rt->rt == __pyx_v_crt);
    if (__pyx_3) {
      Py_INCREF(((PyObject *)__pyx_v_rt));
      __pyx_r = __pyx_v_rt;
      Py_DECREF(__pyx_2); __pyx_2 = 0;
      goto __pyx_L0;
      goto __pyx_L4;
    }
    __pyx_L4:;
  }
  Py_DECREF(__pyx_2); __pyx_2 = 0;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":445 */
  __pyx_1 = PyTuple_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 445; goto __pyx_L1;}
  Py_INCREF(__pyx_k23p);
  PyTuple_SET_ITEM(__pyx_1, 0, __pyx_k23p);
  __pyx_2 = PyObject_CallObject(PyExc_ValueError, __pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 445; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  __Pyx_Raise(__pyx_2, 0, 0);
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  {__pyx_filename = __pyx_f[0]; __pyx_lineno = 445; goto __pyx_L1;}

  __pyx_r = ((struct __pyx_obj_12spidermonkey_Runtime *)Py_None); Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  __Pyx_AddTraceback("spidermonkey.get_runtime");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_rt);
  return __pyx_r;
}

static struct __pyx_obj_12spidermonkey_Context *__pyx_f_12spidermonkey_get_context(struct JSContext *__pyx_v_ccx) {
  struct JSRuntime *__pyx_v_crt;
  PyObject *__pyx_v_rt;
  struct __pyx_obj_12spidermonkey_Context *__pyx_r;
  PyObject *__pyx_1 = 0;
  __pyx_v_rt = Py_None; Py_INCREF(Py_None);

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":450 */
  __pyx_v_crt = JS_GetRuntime(__pyx_v_ccx);

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":451 */
  __pyx_1 = ((PyObject *)__pyx_f_12spidermonkey_get_runtime(__pyx_v_crt)); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 451; goto __pyx_L1;}
  Py_DECREF(__pyx_v_rt);
  __pyx_v_rt = __pyx_1;
  __pyx_1 = 0;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":452 */
  if (!__Pyx_TypeTest(__pyx_v_rt, __pyx_ptype_12spidermonkey_Runtime)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 452; goto __pyx_L1;}
  __pyx_1 = ((PyObject *)__pyx_f_12spidermonkey_runtime_get_context(((struct __pyx_obj_12spidermonkey_Runtime *)__pyx_v_rt),__pyx_v_ccx)); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 452; goto __pyx_L1;}
  __pyx_r = ((struct __pyx_obj_12spidermonkey_Context *)__pyx_1);
  __pyx_1 = 0;
  goto __pyx_L0;

  __pyx_r = ((struct __pyx_obj_12spidermonkey_Context *)Py_None); Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  __Pyx_AddTraceback("spidermonkey.get_context");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_rt);
  return __pyx_r;
}

static int __pyx_f_12spidermonkey_7Runtime___cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_f_12spidermonkey_7Runtime___cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_args = 0;
  PyObject *__pyx_v_kwargs = 0;
  int __pyx_r;
  int __pyx_1;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  static char *__pyx_argnames[] = {0};
  if (__Pyx_GetStarArgs(&__pyx_args, &__pyx_kwds, __pyx_argnames, 0, &__pyx_v_args, &__pyx_v_kwargs, 0) < 0) return -1;
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "", __pyx_argnames)) {
    Py_XDECREF(__pyx_args);
    Py_XDECREF(__pyx_kwds);
    Py_XDECREF(__pyx_v_args);
    Py_XDECREF(__pyx_v_kwargs);
    return -1;
  }
  Py_INCREF(__pyx_v_self);

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":462 */
  ((struct __pyx_obj_12spidermonkey_Runtime *)__pyx_v_self)->rt = JS_NewRuntime(1000000);

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":463 */
  __pyx_1 = (((struct __pyx_obj_12spidermonkey_Runtime *)__pyx_v_self)->rt == NULL);
  if (__pyx_1) {
    __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 464; goto __pyx_L1;}
    Py_INCREF(__pyx_k24p);
    PyTuple_SET_ITEM(__pyx_2, 0, __pyx_k24p);
    __pyx_3 = PyObject_CallObject(PyExc_SystemError, __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 464; goto __pyx_L1;}
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    __Pyx_Raise(__pyx_3, 0, 0);
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 464; goto __pyx_L1;}
    goto __pyx_L2;
  }
  __pyx_L2:;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  __Pyx_AddTraceback("spidermonkey.Runtime.__cinit__");
  __pyx_r = -1;
  __pyx_L0:;
  Py_XDECREF(__pyx_v_args);
  Py_XDECREF(__pyx_v_kwargs);
  Py_DECREF(__pyx_v_self);
  Py_XDECREF(__pyx_args);
  Py_XDECREF(__pyx_kwds);
  return __pyx_r;
}

static int __pyx_f_12spidermonkey_7Runtime___init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_f_12spidermonkey_7Runtime___init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  static char *__pyx_argnames[] = {0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "", __pyx_argnames)) return -1;
  Py_INCREF(__pyx_v_self);

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":467 */
  __pyx_1 = PyList_New(0); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 467; goto __pyx_L1;}
  Py_DECREF(((struct __pyx_obj_12spidermonkey_Runtime *)__pyx_v_self)->_cxs);
  ((struct __pyx_obj_12spidermonkey_Runtime *)__pyx_v_self)->_cxs = __pyx_1;
  __pyx_1 = 0;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":468 */
  __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_RUNTIMES); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 468; goto __pyx_L1;}
  __pyx_2 = PyObject_GetAttr(__pyx_1, __pyx_n_append); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 468; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  __pyx_1 = PyTuple_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 468; goto __pyx_L1;}
  Py_INCREF(__pyx_v_self);
  PyTuple_SET_ITEM(__pyx_1, 0, __pyx_v_self);
  __pyx_3 = PyObject_CallObject(__pyx_2, __pyx_1); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 468; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  __Pyx_AddTraceback("spidermonkey.Runtime.__init__");
  __pyx_r = -1;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static PyObject *__pyx_f_12spidermonkey_7Runtime_new_context(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_12spidermonkey_7Runtime_new_context(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_globj = 0;
  PyObject *__pyx_v_cx;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  static char *__pyx_argnames[] = {"globj",0};
  __pyx_v_globj = __pyx_d1;
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "|O", __pyx_argnames, &__pyx_v_globj)) return 0;
  Py_INCREF(__pyx_v_self);
  Py_INCREF(__pyx_v_globj);
  __pyx_v_cx = Py_None; Py_INCREF(Py_None);

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":471 */
  __pyx_1 = PyTuple_New(2); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 471; goto __pyx_L1;}
  Py_INCREF(__pyx_v_self);
  PyTuple_SET_ITEM(__pyx_1, 0, __pyx_v_self);
  Py_INCREF(__pyx_v_globj);
  PyTuple_SET_ITEM(__pyx_1, 1, __pyx_v_globj);
  __pyx_2 = PyObject_CallObject(((PyObject *)__pyx_ptype_12spidermonkey_Context), __pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 471; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_v_cx);
  __pyx_v_cx = __pyx_2;
  __pyx_2 = 0;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":472 */
  __pyx_1 = PyObject_GetAttr(((struct __pyx_obj_12spidermonkey_Runtime *)__pyx_v_self)->_cxs, __pyx_n_append); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 472; goto __pyx_L1;}
  __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 472; goto __pyx_L1;}
  Py_INCREF(__pyx_v_cx);
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_v_cx);
  __pyx_3 = PyObject_CallObject(__pyx_1, __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 472; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":473 */
  __pyx_1 = PyObject_GetAttr(__pyx_v_cx, __pyx_n_finish_initialization); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 473; goto __pyx_L1;}
  __pyx_2 = PyObject_CallObject(__pyx_1, 0); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 473; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":474 */
  Py_INCREF(__pyx_v_cx);
  __pyx_r = __pyx_v_cx;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  __Pyx_AddTraceback("spidermonkey.Runtime.new_context");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_cx);
  Py_DECREF(__pyx_v_self);
  Py_DECREF(__pyx_v_globj);
  return __pyx_r;
}

static PyObject *__pyx_f_12spidermonkey_7Runtime___del__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_12spidermonkey_7Runtime___del__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_r;
  static char *__pyx_argnames[] = {0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "", __pyx_argnames)) return 0;
  Py_INCREF(__pyx_v_self);
  Py_INCREF(Py_None);
  Py_DECREF(((struct __pyx_obj_12spidermonkey_Runtime *)__pyx_v_self)->_cxs);
  ((struct __pyx_obj_12spidermonkey_Runtime *)__pyx_v_self)->_cxs = Py_None;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static void __pyx_f_12spidermonkey_7Runtime___dealloc__(PyObject *__pyx_v_self); /*proto*/
static void __pyx_f_12spidermonkey_7Runtime___dealloc__(PyObject *__pyx_v_self) {
  Py_INCREF(__pyx_v_self);
  JS_DestroyRuntime(((struct __pyx_obj_12spidermonkey_Runtime *)__pyx_v_self)->rt);

  Py_DECREF(__pyx_v_self);
}

static struct __pyx_obj_12spidermonkey_Context *__pyx_f_12spidermonkey_runtime_get_context(struct __pyx_obj_12spidermonkey_Runtime *__pyx_v_self,struct JSContext *__pyx_v_ccx) {
  struct __pyx_obj_12spidermonkey_Context *__pyx_v_cx;
  struct __pyx_obj_12spidermonkey_Context *__pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  int __pyx_3;
  Py_INCREF(__pyx_v_self);
  __pyx_v_cx = ((struct __pyx_obj_12spidermonkey_Context *)Py_None); Py_INCREF(Py_None);

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":486 */
  __pyx_1 = PyObject_GetIter(__pyx_v_self->_cxs); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 486; goto __pyx_L1;}
  for (;;) {
    __pyx_2 = PyIter_Next(__pyx_1);
    if (!__pyx_2) {
      if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 486; goto __pyx_L1;}
      break;
    }
    if (!__Pyx_TypeTest(__pyx_2, __pyx_ptype_12spidermonkey_Context)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 486; goto __pyx_L1;}
    Py_DECREF(((PyObject *)__pyx_v_cx));
    __pyx_v_cx = ((struct __pyx_obj_12spidermonkey_Context *)__pyx_2);
    __pyx_2 = 0;
    __pyx_3 = (__pyx_v_ccx == __pyx_v_cx->cx);
    if (__pyx_3) {
      Py_INCREF(((PyObject *)__pyx_v_cx));
      __pyx_r = __pyx_v_cx;
      Py_DECREF(__pyx_1); __pyx_1 = 0;
      goto __pyx_L0;
      goto __pyx_L4;
    }
    __pyx_L4:;
  }
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":489 */
  __pyx_2 = __Pyx_GetName(__pyx_b, __pyx_n_rt); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 489; goto __pyx_L1;}
  __pyx_1 = PyNumber_Remainder(__pyx_k27p, __pyx_2); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 489; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 489; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_1);
  __pyx_1 = 0;
  __pyx_1 = PyObject_CallObject(PyExc_ValueError, __pyx_2); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 489; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __Pyx_Raise(__pyx_1, 0, 0);
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  {__pyx_filename = __pyx_f[0]; __pyx_lineno = 489; goto __pyx_L1;}

  __pyx_r = ((struct __pyx_obj_12spidermonkey_Context *)Py_None); Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  __Pyx_AddTraceback("spidermonkey.runtime_get_context");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_cx);
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static int __pyx_f_12spidermonkey_7Context___cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_f_12spidermonkey_7Context___cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  struct __pyx_obj_12spidermonkey_Runtime *__pyx_v_rt = 0;
  PyObject *__pyx_v_globj = 0;
  PyObject *__pyx_v_STACK_CHUNK_SIZE;
  int __pyx_r;
  PyObject *__pyx_1 = 0;
  __pyx_t_12spidermonkey_size_t __pyx_2;
  int __pyx_3;
  PyObject *__pyx_4 = 0;
  static char *__pyx_argnames[] = {"rt","globj",0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "OO", __pyx_argnames, &__pyx_v_rt, &__pyx_v_globj)) return -1;
  Py_INCREF(__pyx_v_self);
  Py_INCREF(__pyx_v_rt);
  Py_INCREF(__pyx_v_globj);
  __pyx_v_STACK_CHUNK_SIZE = Py_None; Py_INCREF(Py_None);
  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_rt), __pyx_ptype_12spidermonkey_Runtime, 1, "rt")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 503; goto __pyx_L1;}

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":505 */
  Py_INCREF(((PyObject *)__pyx_v_rt));
  Py_DECREF(((PyObject *)((struct __pyx_obj_12spidermonkey_Context *)__pyx_v_self)->rt));
  ((struct __pyx_obj_12spidermonkey_Context *)__pyx_v_self)->rt = __pyx_v_rt;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":509 */
  __pyx_1 = PyInt_FromLong(8192); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 509; goto __pyx_L1;}
  Py_DECREF(__pyx_v_STACK_CHUNK_SIZE);
  __pyx_v_STACK_CHUNK_SIZE = __pyx_1;
  __pyx_1 = 0;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":511 */
  __pyx_2 = PyInt_AsLong(__pyx_v_STACK_CHUNK_SIZE); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 511; goto __pyx_L1;}
  ((struct __pyx_obj_12spidermonkey_Context *)__pyx_v_self)->cx = JS_NewContext(__pyx_v_rt->rt,__pyx_2);

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":512 */
  __pyx_3 = (((struct __pyx_obj_12spidermonkey_Context *)__pyx_v_self)->cx == NULL);
  if (__pyx_3) {
    __pyx_1 = PyTuple_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 513; goto __pyx_L1;}
    Py_INCREF(__pyx_k29p);
    PyTuple_SET_ITEM(__pyx_1, 0, __pyx_k29p);
    __pyx_4 = PyObject_CallObject(PyExc_SystemError, __pyx_1); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 513; goto __pyx_L1;}
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    __Pyx_Raise(__pyx_4, 0, 0);
    Py_DECREF(__pyx_4); __pyx_4 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 513; goto __pyx_L1;}
    goto __pyx_L2;
  }
  __pyx_L2:;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_4);
  __Pyx_AddTraceback("spidermonkey.Context.__cinit__");
  __pyx_r = -1;
  __pyx_L0:;
  Py_DECREF(__pyx_v_STACK_CHUNK_SIZE);
  Py_DECREF(__pyx_v_self);
  Py_DECREF(__pyx_v_rt);
  Py_DECREF(__pyx_v_globj);
  return __pyx_r;
}

static int __pyx_f_12spidermonkey_7Context___init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_f_12spidermonkey_7Context___init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  struct __pyx_obj_12spidermonkey_Runtime *__pyx_v_rt = 0;
  PyObject *__pyx_v_globj = 0;
  struct __pyx_obj_12spidermonkey_ProxyClass *__pyx_v_proxy_class;
  int __pyx_r;
  PyObject *__pyx_1 = 0;
  int __pyx_2;
  PyObject *__pyx_3 = 0;
  PyObject *__pyx_4 = 0;
  static char *__pyx_argnames[] = {"rt","globj",0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "OO", __pyx_argnames, &__pyx_v_rt, &__pyx_v_globj)) return -1;
  Py_INCREF(__pyx_v_self);
  Py_INCREF(__pyx_v_rt);
  Py_INCREF(__pyx_v_globj);
  __pyx_v_proxy_class = ((struct __pyx_obj_12spidermonkey_ProxyClass *)Py_None); Py_INCREF(Py_None);
  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_rt), __pyx_ptype_12spidermonkey_Runtime, 1, "rt")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 515; goto __pyx_L1;}

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":518 */
  __pyx_1 = PyList_New(0); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 518; goto __pyx_L1;}
  Py_DECREF(((struct __pyx_obj_12spidermonkey_Context *)__pyx_v_self)->_funcs);
  ((struct __pyx_obj_12spidermonkey_Context *)__pyx_v_self)->_funcs = __pyx_1;
  __pyx_1 = 0;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":519 */
  __pyx_1 = PyList_New(0); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 519; goto __pyx_L1;}
  Py_DECREF(((struct __pyx_obj_12spidermonkey_Context *)__pyx_v_self)->_classes);
  ((struct __pyx_obj_12spidermonkey_Context *)__pyx_v_self)->_classes = __pyx_1;
  __pyx_1 = 0;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":520 */
  __pyx_1 = PyList_New(0); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 520; goto __pyx_L1;}
  Py_DECREF(((struct __pyx_obj_12spidermonkey_Context *)__pyx_v_self)->_objs);
  ((struct __pyx_obj_12spidermonkey_Context *)__pyx_v_self)->_objs = __pyx_1;
  __pyx_1 = 0;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":521 */
  __pyx_1 = PyList_New(0); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 521; goto __pyx_L1;}
  Py_DECREF(((struct __pyx_obj_12spidermonkey_Context *)__pyx_v_self)->_evaled_script);
  ((struct __pyx_obj_12spidermonkey_Context *)__pyx_v_self)->_evaled_script = __pyx_1;
  __pyx_1 = 0;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":522 */
  Py_INCREF(Py_None);
  Py_DECREF(((struct __pyx_obj_12spidermonkey_Context *)__pyx_v_self)->_last_error);
  ((struct __pyx_obj_12spidermonkey_Context *)__pyx_v_self)->_last_error = Py_None;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":524 */
  __pyx_2 = PyObject_IsTrue(__pyx_v_globj); if (__pyx_2 < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 524; goto __pyx_L1;}
  if (__pyx_2) {

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":525 */
    __pyx_1 = PyObject_GetAttr(__pyx_v_self, __pyx_n_bind_class); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 525; goto __pyx_L1;}
    __pyx_3 = PyObject_GetAttr(__pyx_v_globj, __pyx_n___class__); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 525; goto __pyx_L1;}
    __pyx_4 = PyTuple_New(3); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 525; goto __pyx_L1;}
    PyTuple_SET_ITEM(__pyx_4, 0, __pyx_3);
    Py_INCREF(Py_False);
    PyTuple_SET_ITEM(__pyx_4, 1, Py_False);
    Py_INCREF(Py_True);
    PyTuple_SET_ITEM(__pyx_4, 2, Py_True);
    __pyx_3 = 0;
    __pyx_3 = PyObject_CallObject(__pyx_1, __pyx_4); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 525; goto __pyx_L1;}
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    Py_DECREF(__pyx_4); __pyx_4 = 0;
    Py_DECREF(__pyx_3); __pyx_3 = 0;

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":526 */
    __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_js_classname); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 526; goto __pyx_L1;}
    __pyx_4 = PyTuple_New(1); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 526; goto __pyx_L1;}
    Py_INCREF(__pyx_v_globj);
    PyTuple_SET_ITEM(__pyx_4, 0, __pyx_v_globj);
    __pyx_3 = PyObject_CallObject(__pyx_1, __pyx_4); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 526; goto __pyx_L1;}
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    Py_DECREF(__pyx_4); __pyx_4 = 0;
    __pyx_1 = ((PyObject *)__pyx_f_12spidermonkey_context_get_class(((struct __pyx_obj_12spidermonkey_Context *)__pyx_v_self),__pyx_3)); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 526; goto __pyx_L1;}
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    Py_DECREF(((PyObject *)__pyx_v_proxy_class));
    __pyx_v_proxy_class = ((struct __pyx_obj_12spidermonkey_ProxyClass *)__pyx_1);
    __pyx_1 = 0;

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":527 */
    ((struct __pyx_obj_12spidermonkey_Context *)__pyx_v_self)->globj = JS_NewObject(((struct __pyx_obj_12spidermonkey_Context *)__pyx_v_self)->cx,__pyx_v_proxy_class->jsc,NULL,NULL);

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":528 */
    __pyx_2 = (((struct __pyx_obj_12spidermonkey_Context *)__pyx_v_self)->globj == NULL);
    if (__pyx_2) {
      __pyx_4 = PyTuple_New(1); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 529; goto __pyx_L1;}
      Py_INCREF(__pyx_k33p);
      PyTuple_SET_ITEM(__pyx_4, 0, __pyx_k33p);
      __pyx_3 = PyObject_CallObject(PyExc_SystemError, __pyx_4); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 529; goto __pyx_L1;}
      Py_DECREF(__pyx_4); __pyx_4 = 0;
      __Pyx_Raise(__pyx_3, 0, 0);
      Py_DECREF(__pyx_3); __pyx_3 = 0;
      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 529; goto __pyx_L1;}
      goto __pyx_L3;
    }
    __pyx_L3:;

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":530 */
    __pyx_f_12spidermonkey_context_register_object(((struct __pyx_obj_12spidermonkey_Context *)__pyx_v_self),__pyx_v_globj,((struct __pyx_obj_12spidermonkey_Context *)__pyx_v_self)->globj);
    goto __pyx_L2;
  }
  /*else*/ {

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":532 */
    ((struct __pyx_obj_12spidermonkey_Context *)__pyx_v_self)->globj = make_global_object(((struct __pyx_obj_12spidermonkey_Context *)__pyx_v_self)->cx);

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":533 */
    __pyx_2 = (((struct __pyx_obj_12spidermonkey_Context *)__pyx_v_self)->globj == NULL);
    if (__pyx_2) {
      __pyx_1 = PyTuple_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 534; goto __pyx_L1;}
      Py_INCREF(__pyx_k33p);
      PyTuple_SET_ITEM(__pyx_1, 0, __pyx_k33p);
      __pyx_4 = PyObject_CallObject(PyExc_SystemError, __pyx_1); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 534; goto __pyx_L1;}
      Py_DECREF(__pyx_1); __pyx_1 = 0;
      __Pyx_Raise(__pyx_4, 0, 0);
      Py_DECREF(__pyx_4); __pyx_4 = 0;
      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 534; goto __pyx_L1;}
      goto __pyx_L4;
    }
    __pyx_L4:;
  }
  __pyx_L2:;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_3);
  Py_XDECREF(__pyx_4);
  __Pyx_AddTraceback("spidermonkey.Context.__init__");
  __pyx_r = -1;
  __pyx_L0:;
  Py_DECREF(__pyx_v_proxy_class);
  Py_DECREF(__pyx_v_self);
  Py_DECREF(__pyx_v_rt);
  Py_DECREF(__pyx_v_globj);
  return __pyx_r;
}

static PyObject *__pyx_f_12spidermonkey_7Context_finish_initialization(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_12spidermonkey_7Context_finish_initialization(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_r;
  int __pyx_1;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  static char *__pyx_argnames[] = {0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "", __pyx_argnames)) return 0;
  Py_INCREF(__pyx_v_self);

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":543 */
  __pyx_1 = (!JS_InitStandardClasses(((struct __pyx_obj_12spidermonkey_Context *)__pyx_v_self)->cx,((struct __pyx_obj_12spidermonkey_Context *)__pyx_v_self)->globj));
  if (__pyx_1) {
    __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 544; goto __pyx_L1;}
    Py_INCREF(__pyx_k34p);
    PyTuple_SET_ITEM(__pyx_2, 0, __pyx_k34p);
    __pyx_3 = PyObject_CallObject(PyExc_SystemError, __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 544; goto __pyx_L1;}
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    __Pyx_Raise(__pyx_3, 0, 0);
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 544; goto __pyx_L1;}
    goto __pyx_L2;
  }
  __pyx_L2:;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":545 */
  JS_SetErrorReporter(((struct __pyx_obj_12spidermonkey_Context *)__pyx_v_self)->cx,__pyx_f_12spidermonkey_report_error);

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":546 */
  __pyx_1 = (!JS_DefineFunctions(((struct __pyx_obj_12spidermonkey_Context *)__pyx_v_self)->cx,((struct __pyx_obj_12spidermonkey_Context *)__pyx_v_self)->globj,functions));
  if (__pyx_1) {
    __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 547; goto __pyx_L1;}
    Py_INCREF(__pyx_k35p);
    PyTuple_SET_ITEM(__pyx_2, 0, __pyx_k35p);
    __pyx_3 = PyObject_CallObject(PyExc_SystemError, __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 547; goto __pyx_L1;}
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    __Pyx_Raise(__pyx_3, 0, 0);
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 547; goto __pyx_L1;}
    goto __pyx_L3;
  }
  __pyx_L3:;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  __Pyx_AddTraceback("spidermonkey.Context.finish_initialization");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static PyObject *__pyx_f_12spidermonkey_7Context_get_global(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_12spidermonkey_7Context_get_global[] = "Only works with undotted names.  Use eval_script for anything\n        else.";
static PyObject *__pyx_f_12spidermonkey_7Context_get_global(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_name = 0;
  __pyx_t_12spidermonkey_jsval __pyx_v_jsv;
  PyObject *__pyx_v_val;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  int __pyx_4;
  int __pyx_5;
  char *__pyx_6;
  static char *__pyx_argnames[] = {"name",0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "O", __pyx_argnames, &__pyx_v_name)) return 0;
  Py_INCREF(__pyx_v_self);
  Py_INCREF(__pyx_v_name);
  __pyx_v_val = Py_None; Py_INCREF(Py_None);

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":554 */
  __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_isstringlike); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 554; goto __pyx_L1;}
  __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 554; goto __pyx_L1;}
  Py_INCREF(__pyx_v_name);
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_v_name);
  __pyx_3 = PyObject_CallObject(__pyx_1, __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 554; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_4 = PyObject_IsTrue(__pyx_3); if (__pyx_4 < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 554; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  __pyx_5 = (!__pyx_4);
  if (__pyx_5) {
    __pyx_1 = PyTuple_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 555; goto __pyx_L1;}
    Py_INCREF(__pyx_k37p);
    PyTuple_SET_ITEM(__pyx_1, 0, __pyx_k37p);
    __pyx_2 = PyObject_CallObject(PyExc_TypeError, __pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 555; goto __pyx_L1;}
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    __Pyx_Raise(__pyx_2, 0, 0);
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 555; goto __pyx_L1;}
    goto __pyx_L2;
  }
  __pyx_L2:;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":557 */
  __pyx_6 = PyString_AsString(__pyx_v_name); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 557; goto __pyx_L1;}
  __pyx_4 = (!JS_GetProperty(((struct __pyx_obj_12spidermonkey_Context *)__pyx_v_self)->cx,((struct __pyx_obj_12spidermonkey_Context *)__pyx_v_self)->globj,__pyx_6,(&__pyx_v_jsv)));
  if (__pyx_4) {
    __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 558; goto __pyx_L1;}
    Py_INCREF(__pyx_k38p);
    PyTuple_SET_ITEM(__pyx_3, 0, __pyx_k38p);
    __pyx_1 = PyObject_CallObject(PyExc_SystemError, __pyx_3); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 558; goto __pyx_L1;}
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    __Pyx_Raise(__pyx_1, 0, 0);
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 558; goto __pyx_L1;}
    goto __pyx_L3;
  }
  __pyx_L3:;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":559 */
  __pyx_2 = __pyx_f_12spidermonkey_Py_from_JS(((struct __pyx_obj_12spidermonkey_Context *)__pyx_v_self)->cx,__pyx_v_jsv); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 559; goto __pyx_L1;}
  Py_DECREF(__pyx_v_val);
  __pyx_v_val = __pyx_2;
  __pyx_2 = 0;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":560 */
  __pyx_5 = __pyx_v_val == Py_None;
  if (__pyx_5) {
    __pyx_3 = PyNumber_Remainder(__pyx_k39p, __pyx_v_name); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 561; goto __pyx_L1;}
    __pyx_1 = PyTuple_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 561; goto __pyx_L1;}
    PyTuple_SET_ITEM(__pyx_1, 0, __pyx_3);
    __pyx_3 = 0;
    __pyx_2 = PyObject_CallObject(PyExc_ValueError, __pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 561; goto __pyx_L1;}
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    __Pyx_Raise(__pyx_2, 0, 0);
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 561; goto __pyx_L1;}
    goto __pyx_L4;
  }
  /*else*/ {
    Py_INCREF(__pyx_v_val);
    __pyx_r = __pyx_v_val;
    goto __pyx_L0;
  }
  __pyx_L4:;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  __Pyx_AddTraceback("spidermonkey.Context.get_global");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_val);
  Py_DECREF(__pyx_v_self);
  Py_DECREF(__pyx_v_name);
  return __pyx_r;
}

static PyObject *__pyx_f_12spidermonkey_7Context_bind_callable(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_12spidermonkey_7Context_bind_callable(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_name = 0;
  PyObject *__pyx_v_function = 0;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  int __pyx_4;
  int __pyx_5;
  char *__pyx_6;
  static char *__pyx_argnames[] = {"name","function",0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "OO", __pyx_argnames, &__pyx_v_name, &__pyx_v_function)) return 0;
  Py_INCREF(__pyx_v_self);
  Py_INCREF(__pyx_v_name);
  Py_INCREF(__pyx_v_function);

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":569 */
  __pyx_1 = __Pyx_GetName(__pyx_b, __pyx_n_callable); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 569; goto __pyx_L1;}
  __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 569; goto __pyx_L1;}
  Py_INCREF(__pyx_v_function);
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_v_function);
  __pyx_3 = PyObject_CallObject(__pyx_1, __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 569; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_4 = PyObject_IsTrue(__pyx_3); if (__pyx_4 < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 569; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  __pyx_5 = (!__pyx_4);
  if (__pyx_5) {
    __pyx_1 = PyTuple_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 570; goto __pyx_L1;}
    Py_INCREF(__pyx_k41p);
    PyTuple_SET_ITEM(__pyx_1, 0, __pyx_k41p);
    __pyx_2 = PyObject_CallObject(PyExc_ValueError, __pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 570; goto __pyx_L1;}
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    __Pyx_Raise(__pyx_2, 0, 0);
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 570; goto __pyx_L1;}
    goto __pyx_L2;
  }
  __pyx_L2:;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":572 */
  __pyx_3 = PyObject_GetAttr(((struct __pyx_obj_12spidermonkey_Context *)__pyx_v_self)->_funcs, __pyx_n_append); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 572; goto __pyx_L1;}
  __pyx_1 = PyTuple_New(2); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 572; goto __pyx_L1;}
  Py_INCREF(__pyx_v_name);
  PyTuple_SET_ITEM(__pyx_1, 0, __pyx_v_name);
  Py_INCREF(__pyx_v_function);
  PyTuple_SET_ITEM(__pyx_1, 1, __pyx_v_function);
  __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 572; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_1);
  __pyx_1 = 0;
  __pyx_1 = PyObject_CallObject(__pyx_3, __pyx_2); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 572; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":573 */
  __pyx_6 = PyString_AsString(__pyx_v_name); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 573; goto __pyx_L1;}
  JS_DefineFunction(((struct __pyx_obj_12spidermonkey_Context *)__pyx_v_self)->cx,((struct __pyx_obj_12spidermonkey_Context *)__pyx_v_self)->globj,__pyx_6,__pyx_f_12spidermonkey_function_cb,0,0);

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  __Pyx_AddTraceback("spidermonkey.Context.bind_callable");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  Py_DECREF(__pyx_v_name);
  Py_DECREF(__pyx_v_function);
  return __pyx_r;
}

static PyObject *__pyx_f_12spidermonkey_7Context_bind_attribute(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_12spidermonkey_7Context_bind_attribute(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_name = 0;
  PyObject *__pyx_v_obj = 0;
  PyObject *__pyx_v_attr_name = 0;
  __pyx_t_12spidermonkey_jsval __pyx_v_initial_value;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  int __pyx_4;
  int __pyx_5;
  __pyx_t_12spidermonkey_jsval __pyx_6;
  char *__pyx_7;
  static char *__pyx_argnames[] = {"name","obj","attr_name",0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "OOO", __pyx_argnames, &__pyx_v_name, &__pyx_v_obj, &__pyx_v_attr_name)) return 0;
  Py_INCREF(__pyx_v_self);
  Py_INCREF(__pyx_v_name);
  Py_INCREF(__pyx_v_obj);
  Py_INCREF(__pyx_v_attr_name);

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":577 */
  __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_isstringlike); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 577; goto __pyx_L1;}
  __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 577; goto __pyx_L1;}
  Py_INCREF(__pyx_v_name);
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_v_name);
  __pyx_3 = PyObject_CallObject(__pyx_1, __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 577; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_4 = PyObject_IsTrue(__pyx_3); if (__pyx_4 < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 577; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  __pyx_5 = (!__pyx_4);
  if (__pyx_5) {
    __pyx_1 = PyTuple_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 578; goto __pyx_L1;}
    Py_INCREF(__pyx_k37p);
    PyTuple_SET_ITEM(__pyx_1, 0, __pyx_k37p);
    __pyx_2 = PyObject_CallObject(PyExc_TypeError, __pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 578; goto __pyx_L1;}
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    __Pyx_Raise(__pyx_2, 0, 0);
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 578; goto __pyx_L1;}
    goto __pyx_L2;
  }
  __pyx_L2:;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":579 */
  __pyx_3 = __Pyx_GetName(__pyx_m, __pyx_n_isstringlike); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 579; goto __pyx_L1;}
  __pyx_1 = PyTuple_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 579; goto __pyx_L1;}
  Py_INCREF(__pyx_v_attr_name);
  PyTuple_SET_ITEM(__pyx_1, 0, __pyx_v_attr_name);
  __pyx_2 = PyObject_CallObject(__pyx_3, __pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 579; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  __pyx_4 = PyObject_IsTrue(__pyx_2); if (__pyx_4 < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 579; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_5 = (!__pyx_4);
  if (__pyx_5) {
    __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 580; goto __pyx_L1;}
    Py_INCREF(__pyx_k37p);
    PyTuple_SET_ITEM(__pyx_3, 0, __pyx_k37p);
    __pyx_1 = PyObject_CallObject(PyExc_TypeError, __pyx_3); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 580; goto __pyx_L1;}
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    __Pyx_Raise(__pyx_1, 0, 0);
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 580; goto __pyx_L1;}
    goto __pyx_L3;
  }
  __pyx_L3:;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":582 */
  __pyx_2 = PyObject_GetAttr(__pyx_v_obj,__pyx_v_name); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 582; goto __pyx_L1;}
  __pyx_6 = __pyx_f_12spidermonkey_JS_from_Py(((struct __pyx_obj_12spidermonkey_Context *)__pyx_v_self)->cx,NULL,__pyx_2); if (__pyx_6 == 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 582; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_v_initial_value = __pyx_6;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":583 */
  __pyx_7 = PyString_AsString(__pyx_v_name); if (!__pyx_7) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 583; goto __pyx_L1;}
  JS_DefineProperty(((struct __pyx_obj_12spidermonkey_Context *)__pyx_v_self)->cx,((struct __pyx_obj_12spidermonkey_Context *)__pyx_v_self)->globj,__pyx_7,__pyx_v_initial_value,__pyx_f_12spidermonkey_get_property,__pyx_f_12spidermonkey_set_property,0);

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  __Pyx_AddTraceback("spidermonkey.Context.bind_attribute");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  Py_DECREF(__pyx_v_name);
  Py_DECREF(__pyx_v_obj);
  Py_DECREF(__pyx_v_attr_name);
  return __pyx_r;
}

static PyObject *__pyx_f_12spidermonkey_7Context_bind_class(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_12spidermonkey_7Context_bind_class(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_klass = 0;
  PyObject *__pyx_v_bind_constructor = 0;
  PyObject *__pyx_v_is_global = 0;
  PyObject *__pyx_v_flags = 0;
  PyObject *__pyx_v_c;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  int __pyx_4;
  int __pyx_5;
  static char *__pyx_argnames[] = {"klass","bind_constructor","is_global","flags",0};
  __pyx_v_bind_constructor = __pyx_d2;
  __pyx_v_is_global = __pyx_d3;
  __pyx_v_flags = __pyx_d4;
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "O|OOO", __pyx_argnames, &__pyx_v_klass, &__pyx_v_bind_constructor, &__pyx_v_is_global, &__pyx_v_flags)) return 0;
  Py_INCREF(__pyx_v_self);
  Py_INCREF(__pyx_v_klass);
  Py_INCREF(__pyx_v_bind_constructor);
  Py_INCREF(__pyx_v_is_global);
  Py_INCREF(__pyx_v_flags);
  __pyx_v_c = Py_None; Py_INCREF(Py_None);

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":588 */
  __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_inspect); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 588; goto __pyx_L1;}
  __pyx_2 = PyObject_GetAttr(__pyx_1, __pyx_n_isclass); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 588; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  __pyx_1 = PyTuple_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 588; goto __pyx_L1;}
  Py_INCREF(__pyx_v_klass);
  PyTuple_SET_ITEM(__pyx_1, 0, __pyx_v_klass);
  __pyx_3 = PyObject_CallObject(__pyx_2, __pyx_1); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 588; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  __pyx_4 = PyObject_IsTrue(__pyx_3); if (__pyx_4 < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 588; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  __pyx_5 = (!__pyx_4);
  if (__pyx_5) {
    __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 588; goto __pyx_L1;}
    Py_INCREF(__pyx_k44p);
    PyTuple_SET_ITEM(__pyx_2, 0, __pyx_k44p);
    __pyx_1 = PyObject_CallObject(PyExc_TypeError, __pyx_2); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 588; goto __pyx_L1;}
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    __Pyx_Raise(__pyx_1, 0, 0);
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 588; goto __pyx_L1;}
    goto __pyx_L2;
  }
  __pyx_L2:;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":589 */
  __pyx_3 = __Pyx_GetName(__pyx_m, __pyx_n_isinteger); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 589; goto __pyx_L1;}
  __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 589; goto __pyx_L1;}
  Py_INCREF(__pyx_v_flags);
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_v_flags);
  __pyx_1 = PyObject_CallObject(__pyx_3, __pyx_2); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 589; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_4 = PyObject_IsTrue(__pyx_1); if (__pyx_4 < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 589; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  __pyx_5 = (!__pyx_4);
  if (__pyx_5) {
    __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 589; goto __pyx_L1;}
    Py_INCREF(__pyx_k46p);
    PyTuple_SET_ITEM(__pyx_3, 0, __pyx_k46p);
    __pyx_2 = PyObject_CallObject(PyExc_TypeError, __pyx_3); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 589; goto __pyx_L1;}
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    __Pyx_Raise(__pyx_2, 0, 0);
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 589; goto __pyx_L1;}
    goto __pyx_L3;
  }
  __pyx_L3:;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":591 */
  __pyx_1 = PyTuple_New(5); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 591; goto __pyx_L1;}
  Py_INCREF(__pyx_v_self);
  PyTuple_SET_ITEM(__pyx_1, 0, __pyx_v_self);
  Py_INCREF(__pyx_v_klass);
  PyTuple_SET_ITEM(__pyx_1, 1, __pyx_v_klass);
  Py_INCREF(__pyx_v_bind_constructor);
  PyTuple_SET_ITEM(__pyx_1, 2, __pyx_v_bind_constructor);
  Py_INCREF(__pyx_v_is_global);
  PyTuple_SET_ITEM(__pyx_1, 3, __pyx_v_is_global);
  Py_INCREF(__pyx_v_flags);
  PyTuple_SET_ITEM(__pyx_1, 4, __pyx_v_flags);
  __pyx_3 = PyObject_CallObject(((PyObject *)__pyx_ptype_12spidermonkey_ProxyClass), __pyx_1); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 591; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_v_c);
  __pyx_v_c = __pyx_3;
  __pyx_3 = 0;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":592 */
  __pyx_2 = PyObject_GetAttr(((struct __pyx_obj_12spidermonkey_Context *)__pyx_v_self)->_classes, __pyx_n_append); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 592; goto __pyx_L1;}
  __pyx_1 = PyTuple_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 592; goto __pyx_L1;}
  Py_INCREF(__pyx_v_c);
  PyTuple_SET_ITEM(__pyx_1, 0, __pyx_v_c);
  __pyx_3 = PyObject_CallObject(__pyx_2, __pyx_1); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 592; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  __Pyx_AddTraceback("spidermonkey.Context.bind_class");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_c);
  Py_DECREF(__pyx_v_self);
  Py_DECREF(__pyx_v_klass);
  Py_DECREF(__pyx_v_bind_constructor);
  Py_DECREF(__pyx_v_is_global);
  Py_DECREF(__pyx_v_flags);
  return __pyx_r;
}

static PyObject *__pyx_f_12spidermonkey_7Context_bind_object(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_12spidermonkey_7Context_bind_object(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_name = 0;
  PyObject *__pyx_v_obj = 0;
  struct JSObject *__pyx_v_jsobj;
  struct __pyx_obj_12spidermonkey_ProxyClass *__pyx_v_proxy_class;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  int __pyx_4;
  int __pyx_5;
  char *__pyx_6;
  static char *__pyx_argnames[] = {"name","obj",0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "OO", __pyx_argnames, &__pyx_v_name, &__pyx_v_obj)) return 0;
  Py_INCREF(__pyx_v_self);
  Py_INCREF(__pyx_v_name);
  Py_INCREF(__pyx_v_obj);
  __pyx_v_proxy_class = ((struct __pyx_obj_12spidermonkey_ProxyClass *)Py_None); Py_INCREF(Py_None);

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":598 */
  __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_isstringlike); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 598; goto __pyx_L1;}
  __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 598; goto __pyx_L1;}
  Py_INCREF(__pyx_v_name);
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_v_name);
  __pyx_3 = PyObject_CallObject(__pyx_1, __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 598; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_4 = PyObject_IsTrue(__pyx_3); if (__pyx_4 < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 598; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  __pyx_5 = (!__pyx_4);
  if (__pyx_5) {
    __pyx_1 = PyTuple_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 599; goto __pyx_L1;}
    Py_INCREF(__pyx_k37p);
    PyTuple_SET_ITEM(__pyx_1, 0, __pyx_k37p);
    __pyx_2 = PyObject_CallObject(PyExc_TypeError, __pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 599; goto __pyx_L1;}
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    __Pyx_Raise(__pyx_2, 0, 0);
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 599; goto __pyx_L1;}
    goto __pyx_L2;
  }
  __pyx_L2:;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":601 */
  __pyx_3 = __Pyx_GetName(__pyx_m, __pyx_n_js_classname); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 601; goto __pyx_L1;}
  __pyx_1 = PyTuple_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 601; goto __pyx_L1;}
  Py_INCREF(__pyx_v_obj);
  PyTuple_SET_ITEM(__pyx_1, 0, __pyx_v_obj);
  __pyx_2 = PyObject_CallObject(__pyx_3, __pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 601; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  __pyx_3 = ((PyObject *)__pyx_f_12spidermonkey_context_get_class(((struct __pyx_obj_12spidermonkey_Context *)__pyx_v_self),__pyx_2)); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 601; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(((PyObject *)__pyx_v_proxy_class));
  __pyx_v_proxy_class = ((struct __pyx_obj_12spidermonkey_ProxyClass *)__pyx_3);
  __pyx_3 = 0;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":602 */
  __pyx_v_jsobj = NULL;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":603 */
  __pyx_6 = PyString_AsString(__pyx_v_name); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 603; goto __pyx_L1;}
  __pyx_v_jsobj = JS_DefineObject(((struct __pyx_obj_12spidermonkey_Context *)__pyx_v_self)->cx,((struct __pyx_obj_12spidermonkey_Context *)__pyx_v_self)->globj,__pyx_6,__pyx_v_proxy_class->jsc,NULL,JSPROP_READONLY);

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":605 */
  __pyx_4 = (__pyx_v_jsobj != NULL);
  if (__pyx_4) {
    __pyx_f_12spidermonkey_context_register_object(((struct __pyx_obj_12spidermonkey_Context *)__pyx_v_self),__pyx_v_obj,__pyx_v_jsobj);
    goto __pyx_L3;
  }
  /*else*/ {
    __pyx_1 = PyNumber_Remainder(__pyx_k47p, __pyx_v_obj); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 608; goto __pyx_L1;}
    __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 608; goto __pyx_L1;}
    PyTuple_SET_ITEM(__pyx_2, 0, __pyx_1);
    __pyx_1 = 0;
    __pyx_3 = PyObject_CallObject(PyExc_ValueError, __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 608; goto __pyx_L1;}
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    __Pyx_Raise(__pyx_3, 0, 0);
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 608; goto __pyx_L1;}
  }
  __pyx_L3:;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  __Pyx_AddTraceback("spidermonkey.Context.bind_object");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_proxy_class);
  Py_DECREF(__pyx_v_self);
  Py_DECREF(__pyx_v_name);
  Py_DECREF(__pyx_v_obj);
  return __pyx_r;
}

static PyObject *__pyx_f_12spidermonkey_7Context_call_fn(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_12spidermonkey_7Context_call_fn(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_name = 0;
  PyObject *__pyx_v_args = 0;
  __pyx_t_12spidermonkey_jsval *__pyx_v_argv;
  __pyx_t_12spidermonkey_jsval __pyx_v_rval;
  __pyx_t_12spidermonkey_jsval __pyx_v_jsarg;
  PyObject *__pyx_v_nr_args;
  PyObject *__pyx_v_i;
  PyObject *__pyx_v_arg;
  PyObject *__pyx_v_ok;
  PyObject *__pyx_v_retval;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  int __pyx_4;
  int __pyx_5;
  Py_ssize_t __pyx_6;
  __pyx_t_12spidermonkey_size_t __pyx_7;
  void *__pyx_8;
  long __pyx_9;
  long __pyx_10;
  __pyx_t_12spidermonkey_jsval __pyx_11;
  char *__pyx_12;
  __pyx_t_12spidermonkey_uintN __pyx_13;
  __pyx_t_12spidermonkey_JSBool __pyx_14;
  static char *__pyx_argnames[] = {"name",0};
  if (__Pyx_GetStarArgs(&__pyx_args, &__pyx_kwds, __pyx_argnames, 1, &__pyx_v_args, 0, 0) < 0) return 0;
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "O", __pyx_argnames, &__pyx_v_name)) {
    Py_XDECREF(__pyx_args);
    Py_XDECREF(__pyx_kwds);
    Py_XDECREF(__pyx_v_args);
    return 0;
  }
  Py_INCREF(__pyx_v_self);
  Py_INCREF(__pyx_v_name);
  __pyx_v_nr_args = Py_None; Py_INCREF(Py_None);
  __pyx_v_i = Py_None; Py_INCREF(Py_None);
  __pyx_v_arg = Py_None; Py_INCREF(Py_None);
  __pyx_v_ok = Py_None; Py_INCREF(Py_None);
  __pyx_v_retval = Py_None; Py_INCREF(Py_None);

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":615 */
  __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_isstringlike); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 615; goto __pyx_L1;}
  __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 615; goto __pyx_L1;}
  Py_INCREF(__pyx_v_name);
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_v_name);
  __pyx_3 = PyObject_CallObject(__pyx_1, __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 615; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_4 = PyObject_IsTrue(__pyx_3); if (__pyx_4 < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 615; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  __pyx_5 = (!__pyx_4);
  if (__pyx_5) {
    __pyx_1 = PyTuple_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 616; goto __pyx_L1;}
    Py_INCREF(__pyx_k37p);
    PyTuple_SET_ITEM(__pyx_1, 0, __pyx_k37p);
    __pyx_2 = PyObject_CallObject(PyExc_TypeError, __pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 616; goto __pyx_L1;}
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    __Pyx_Raise(__pyx_2, 0, 0);
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 616; goto __pyx_L1;}
    goto __pyx_L2;
  }
  __pyx_L2:;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":618 */
  __pyx_6 = PyObject_Length(__pyx_v_args); if (__pyx_6 == -1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 618; goto __pyx_L1;}
  __pyx_3 = PyInt_FromSsize_t(__pyx_6); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 618; goto __pyx_L1;}
  Py_DECREF(__pyx_v_nr_args);
  __pyx_v_nr_args = __pyx_3;
  __pyx_3 = 0;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":619 */
  __pyx_1 = PyInt_FromLong((sizeof(__pyx_t_12spidermonkey_jsval))); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 619; goto __pyx_L1;}
  __pyx_2 = PyNumber_Multiply(__pyx_1, __pyx_v_nr_args); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 619; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  __pyx_7 = PyInt_AsLong(__pyx_2); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 619; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_8 = __pyx_f_12spidermonkey_xmalloc(__pyx_7); if (__pyx_8 == NULL) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 619; goto __pyx_L1;}
  __pyx_v_argv = ((__pyx_t_12spidermonkey_jsval *)__pyx_8);

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":620 */
  /*try:*/ {

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":621 */
    __pyx_10 = PyInt_AsLong(__pyx_v_nr_args); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 621; goto __pyx_L4;}
    for (__pyx_9 = 0; __pyx_9 < __pyx_10; ++__pyx_9) {
      __pyx_3 = PyInt_FromLong(__pyx_9); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 621; goto __pyx_L4;}
      Py_DECREF(__pyx_v_i);
      __pyx_v_i = __pyx_3;
      __pyx_3 = 0;

      /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":622 */
      __pyx_1 = PyObject_GetItem(__pyx_v_args, __pyx_v_i); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 622; goto __pyx_L4;}
      Py_DECREF(__pyx_v_arg);
      __pyx_v_arg = __pyx_1;
      __pyx_1 = 0;

      /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":625 */
      __pyx_11 = __pyx_f_12spidermonkey_JS_from_Py(((struct __pyx_obj_12spidermonkey_Context *)__pyx_v_self)->cx,NULL,__pyx_v_arg); if (__pyx_11 == 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 625; goto __pyx_L4;}
      __pyx_v_jsarg = __pyx_11;

      /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":626 */
      __pyx_6 = PyInt_AsSsize_t(__pyx_v_i); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 626; goto __pyx_L4;}
      (__pyx_v_argv[__pyx_6]) = __pyx_v_jsarg;
    }

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":628 */
    __pyx_12 = PyString_AsString(__pyx_v_name); if (!__pyx_12) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 629; goto __pyx_L4;}
    __pyx_13 = PyInt_AsLong(__pyx_v_nr_args); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 629; goto __pyx_L4;}
    __pyx_14 = JS_CallFunctionName(((struct __pyx_obj_12spidermonkey_Context *)__pyx_v_self)->cx,((struct __pyx_obj_12spidermonkey_Context *)__pyx_v_self)->globj,__pyx_12,__pyx_13,__pyx_v_argv,(&__pyx_v_rval)); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 628; goto __pyx_L4;}
    __pyx_2 = PyInt_FromLong(__pyx_14); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 628; goto __pyx_L4;}
    Py_DECREF(__pyx_v_ok);
    __pyx_v_ok = __pyx_2;
    __pyx_2 = 0;
  }
  /*finally:*/ {
    int __pyx_why;
    PyObject *__pyx_exc_type, *__pyx_exc_value, *__pyx_exc_tb;
    int __pyx_exc_lineno;
    __pyx_why = 0; goto __pyx_L5;
    __pyx_L4: {
      __pyx_why = 4;
      Py_XDECREF(__pyx_3); __pyx_3 = 0;
      Py_XDECREF(__pyx_1); __pyx_1 = 0;
      Py_XDECREF(__pyx_2); __pyx_2 = 0;
      PyErr_Fetch(&__pyx_exc_type, &__pyx_exc_value, &__pyx_exc_tb);
      __pyx_exc_lineno = __pyx_lineno;
      goto __pyx_L5;
    }
    __pyx_L5:;
    free(__pyx_v_argv);
    switch (__pyx_why) {
      case 4: {
        PyErr_Restore(__pyx_exc_type, __pyx_exc_value, __pyx_exc_tb);
        __pyx_lineno = __pyx_exc_lineno;
        __pyx_exc_type = 0;
        __pyx_exc_value = 0;
        __pyx_exc_tb = 0;
        goto __pyx_L1;
      }
    }
  }

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":633 */
  __pyx_4 = PyObject_IsTrue(__pyx_v_ok); if (__pyx_4 < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 633; goto __pyx_L1;}
  __pyx_5 = (!__pyx_4);
  if (__pyx_5) {
    __pyx_3 = PyNumber_Remainder(__pyx_k48p, __pyx_v_name); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 634; goto __pyx_L1;}
    __pyx_1 = PyTuple_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 634; goto __pyx_L1;}
    PyTuple_SET_ITEM(__pyx_1, 0, __pyx_3);
    __pyx_3 = 0;
    __pyx_2 = PyObject_CallObject(PyExc_ValueError, __pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 634; goto __pyx_L1;}
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    __Pyx_Raise(__pyx_2, 0, 0);
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 634; goto __pyx_L1;}
    goto __pyx_L9;
  }
  __pyx_L9:;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":635 */
  __pyx_3 = __pyx_f_12spidermonkey_Py_from_JS(((struct __pyx_obj_12spidermonkey_Context *)__pyx_v_self)->cx,__pyx_v_rval); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 635; goto __pyx_L1;}
  Py_DECREF(__pyx_v_retval);
  __pyx_v_retval = __pyx_3;
  __pyx_3 = 0;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":636 */
  JS_MaybeGC(((struct __pyx_obj_12spidermonkey_Context *)__pyx_v_self)->cx);

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":637 */
  Py_INCREF(__pyx_v_retval);
  __pyx_r = __pyx_v_retval;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  __Pyx_AddTraceback("spidermonkey.Context.call_fn");
  __pyx_r = 0;
  __pyx_L0:;
  Py_XDECREF(__pyx_v_args);
  Py_DECREF(__pyx_v_nr_args);
  Py_DECREF(__pyx_v_i);
  Py_DECREF(__pyx_v_arg);
  Py_DECREF(__pyx_v_ok);
  Py_DECREF(__pyx_v_retval);
  Py_DECREF(__pyx_v_self);
  Py_DECREF(__pyx_v_name);
  Py_XDECREF(__pyx_args);
  Py_XDECREF(__pyx_kwds);
  return __pyx_r;
}

static PyObject *__pyx_f_12spidermonkey_7Context_eval_script(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_12spidermonkey_7Context_eval_script(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_script = 0;
  __pyx_t_12spidermonkey_jsval __pyx_v_rval;
  PyObject *__pyx_v_retval;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  int __pyx_4;
  int __pyx_5;
  PyObject *__pyx_6 = 0;
  char *__pyx_7;
  Py_ssize_t __pyx_8;
  static char *__pyx_argnames[] = {"script",0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "O", __pyx_argnames, &__pyx_v_script)) return 0;
  Py_INCREF(__pyx_v_self);
  Py_INCREF(__pyx_v_script);
  __pyx_v_retval = Py_None; Py_INCREF(Py_None);

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":642 */
  __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_isstringlike); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 642; goto __pyx_L1;}
  __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 642; goto __pyx_L1;}
  Py_INCREF(__pyx_v_script);
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_v_script);
  __pyx_3 = PyObject_CallObject(__pyx_1, __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 642; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_4 = PyObject_IsTrue(__pyx_3); if (__pyx_4 < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 642; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  __pyx_5 = (!__pyx_4);
  if (__pyx_5) {
    __pyx_1 = PyTuple_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 643; goto __pyx_L1;}
    Py_INCREF(__pyx_k37p);
    PyTuple_SET_ITEM(__pyx_1, 0, __pyx_k37p);
    __pyx_2 = PyObject_CallObject(PyExc_TypeError, __pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 643; goto __pyx_L1;}
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    __Pyx_Raise(__pyx_2, 0, 0);
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 643; goto __pyx_L1;}
    goto __pyx_L2;
  }
  __pyx_L2:;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":645 */
  Py_INCREF(__pyx_v_script);
  Py_DECREF(((struct __pyx_obj_12spidermonkey_Context *)__pyx_v_self)->_script);
  ((struct __pyx_obj_12spidermonkey_Context *)__pyx_v_self)->_script = __pyx_v_script;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":646 */
  __pyx_3 = PyObject_GetAttr(((struct __pyx_obj_12spidermonkey_Context *)__pyx_v_self)->_evaled_script, __pyx_n_extend); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 646; goto __pyx_L1;}
  __pyx_1 = PyObject_GetAttr(__pyx_v_script, __pyx_n_split); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 646; goto __pyx_L1;}
  __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 646; goto __pyx_L1;}
  Py_INCREF(__pyx_k51p);
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_k51p);
  __pyx_6 = PyObject_CallObject(__pyx_1, __pyx_2); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 646; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_1 = PyTuple_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 646; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_1, 0, __pyx_6);
  __pyx_6 = 0;
  __pyx_2 = PyObject_CallObject(__pyx_3, __pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 646; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":649 */
  __pyx_7 = PyString_AsString(__pyx_v_script); if (!__pyx_7) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 650; goto __pyx_L1;}
  __pyx_8 = PyObject_Length(__pyx_v_script); if (__pyx_8 == -1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 650; goto __pyx_L1;}
  __pyx_4 = (!JS_EvaluateScript(((struct __pyx_obj_12spidermonkey_Context *)__pyx_v_self)->cx,((struct __pyx_obj_12spidermonkey_Context *)__pyx_v_self)->globj,__pyx_7,__pyx_8,__pyx_k52,0,(&__pyx_v_rval)));
  if (__pyx_4) {
    __pyx_6 = __Pyx_GetName(__pyx_m, __pyx_n_JSError); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 651; goto __pyx_L1;}
    __pyx_3 = PyNumber_Remainder(__pyx_k54p, ((struct __pyx_obj_12spidermonkey_Context *)__pyx_v_self)->_last_error); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 651; goto __pyx_L1;}
    __pyx_1 = PyTuple_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 651; goto __pyx_L1;}
    PyTuple_SET_ITEM(__pyx_1, 0, __pyx_3);
    __pyx_3 = 0;
    __pyx_2 = PyObject_CallObject(__pyx_6, __pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 651; goto __pyx_L1;}
    Py_DECREF(__pyx_6); __pyx_6 = 0;
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    __Pyx_Raise(__pyx_2, 0, 0);
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 651; goto __pyx_L1;}
    goto __pyx_L3;
  }
  __pyx_L3:;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":653 */
  __pyx_3 = __pyx_f_12spidermonkey_Py_from_JS(((struct __pyx_obj_12spidermonkey_Context *)__pyx_v_self)->cx,__pyx_v_rval); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 653; goto __pyx_L1;}
  Py_DECREF(__pyx_v_retval);
  __pyx_v_retval = __pyx_3;
  __pyx_3 = 0;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":654 */
  JS_MaybeGC(((struct __pyx_obj_12spidermonkey_Context *)__pyx_v_self)->cx);

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":655 */
  Py_INCREF(__pyx_v_retval);
  __pyx_r = __pyx_v_retval;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  Py_XDECREF(__pyx_6);
  __Pyx_AddTraceback("spidermonkey.Context.eval_script");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_retval);
  Py_DECREF(__pyx_v_self);
  Py_DECREF(__pyx_v_script);
  return __pyx_r;
}

static void __pyx_f_12spidermonkey_7Context___dealloc__(PyObject *__pyx_v_self); /*proto*/
static void __pyx_f_12spidermonkey_7Context___dealloc__(PyObject *__pyx_v_self) {
  Py_INCREF(__pyx_v_self);
  JS_DestroyContext(((struct __pyx_obj_12spidermonkey_Context *)__pyx_v_self)->cx);

  Py_DECREF(__pyx_v_self);
}

static void __pyx_f_12spidermonkey_context_register_object(struct __pyx_obj_12spidermonkey_Context *__pyx_v_self,PyObject *__pyx_v_obj,struct JSObject *__pyx_v_jsobj) {
  struct __pyx_obj_12spidermonkey_ProxyObject *__pyx_v_proxy_obj;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  Py_INCREF(__pyx_v_self);
  Py_INCREF(__pyx_v_obj);
  __pyx_v_proxy_obj = ((struct __pyx_obj_12spidermonkey_ProxyObject *)Py_None); Py_INCREF(Py_None);

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":663 */
  __pyx_1 = PyTuple_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 663; goto __pyx_L1;}
  Py_INCREF(__pyx_v_obj);
  PyTuple_SET_ITEM(__pyx_1, 0, __pyx_v_obj);
  __pyx_2 = PyObject_CallObject(((PyObject *)__pyx_ptype_12spidermonkey_ProxyObject), __pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 663; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(((PyObject *)__pyx_v_proxy_obj));
  __pyx_v_proxy_obj = ((struct __pyx_obj_12spidermonkey_ProxyObject *)__pyx_2);
  __pyx_2 = 0;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":664 */
  __pyx_v_proxy_obj->jsobj = __pyx_v_jsobj;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":665 */
  __pyx_f_12spidermonkey_context_add_object(__pyx_v_self,__pyx_v_proxy_obj);

  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  __Pyx_WriteUnraisable("spidermonkey.context_register_object");
  __pyx_L0:;
  Py_DECREF(__pyx_v_proxy_obj);
  Py_DECREF(__pyx_v_self);
  Py_DECREF(__pyx_v_obj);
}

static void __pyx_f_12spidermonkey_context_add_object(struct __pyx_obj_12spidermonkey_Context *__pyx_v_self,struct __pyx_obj_12spidermonkey_ProxyObject *__pyx_v_obj) {
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  Py_INCREF(__pyx_v_self);
  Py_INCREF(__pyx_v_obj);
  __pyx_1 = PyObject_GetAttr(__pyx_v_self->_objs, __pyx_n_append); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 668; goto __pyx_L1;}
  __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 668; goto __pyx_L1;}
  Py_INCREF(((PyObject *)__pyx_v_obj));
  PyTuple_SET_ITEM(__pyx_2, 0, ((PyObject *)__pyx_v_obj));
  __pyx_3 = PyObject_CallObject(__pyx_1, __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 668; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;

  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  __Pyx_WriteUnraisable("spidermonkey.context_add_object");
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  Py_DECREF(__pyx_v_obj);
}

static void __pyx_f_12spidermonkey_context_remove_object(struct __pyx_obj_12spidermonkey_Context *__pyx_v_self,struct __pyx_obj_12spidermonkey_ProxyObject *__pyx_v_obj) {
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  Py_INCREF(__pyx_v_self);
  Py_INCREF(__pyx_v_obj);
  __pyx_1 = PyObject_GetAttr(__pyx_v_self->_objs, __pyx_n_remove); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 671; goto __pyx_L1;}
  __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 671; goto __pyx_L1;}
  Py_INCREF(((PyObject *)__pyx_v_obj));
  PyTuple_SET_ITEM(__pyx_2, 0, ((PyObject *)__pyx_v_obj));
  __pyx_3 = PyObject_CallObject(__pyx_1, __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 671; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;

  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  __Pyx_WriteUnraisable("spidermonkey.context_remove_object");
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  Py_DECREF(__pyx_v_obj);
}

static PyObject *__pyx_f_12spidermonkey_context_get_object(struct __pyx_obj_12spidermonkey_Context *__pyx_v_self,struct JSObject *__pyx_v_cobj) {
  struct __pyx_obj_12spidermonkey_ProxyObject *__pyx_v_obj;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  int __pyx_3;
  Py_INCREF(__pyx_v_self);
  __pyx_v_obj = ((struct __pyx_obj_12spidermonkey_ProxyObject *)Py_None); Py_INCREF(Py_None);

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":675 */
  __pyx_1 = PyObject_GetIter(__pyx_v_self->_objs); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 675; goto __pyx_L1;}
  for (;;) {
    __pyx_2 = PyIter_Next(__pyx_1);
    if (!__pyx_2) {
      if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 675; goto __pyx_L1;}
      break;
    }
    if (!__Pyx_TypeTest(__pyx_2, __pyx_ptype_12spidermonkey_ProxyObject)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 675; goto __pyx_L1;}
    Py_DECREF(((PyObject *)__pyx_v_obj));
    __pyx_v_obj = ((struct __pyx_obj_12spidermonkey_ProxyObject *)__pyx_2);
    __pyx_2 = 0;
    __pyx_3 = (__pyx_v_cobj == __pyx_v_obj->jsobj);
    if (__pyx_3) {
      Py_INCREF(((PyObject *)__pyx_v_obj));
      __pyx_r = ((PyObject *)__pyx_v_obj);
      Py_DECREF(__pyx_1); __pyx_1 = 0;
      goto __pyx_L0;
      goto __pyx_L4;
    }
    __pyx_L4:;
  }
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":678 */
  __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 678; goto __pyx_L1;}
  Py_INCREF(__pyx_k56p);
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_k56p);
  __pyx_1 = PyObject_CallObject(PyExc_ValueError, __pyx_2); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 678; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __Pyx_Raise(__pyx_1, 0, 0);
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  {__pyx_filename = __pyx_f[0]; __pyx_lineno = 678; goto __pyx_L1;}

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  __Pyx_AddTraceback("spidermonkey.context_get_object");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_obj);
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static PyObject *__pyx_f_12spidermonkey_context_get_object_from_obj(struct __pyx_obj_12spidermonkey_Context *__pyx_v_self,PyObject *__pyx_v_pyobj) {
  struct __pyx_obj_12spidermonkey_ProxyObject *__pyx_v_obj;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  int __pyx_3;
  Py_INCREF(__pyx_v_self);
  Py_INCREF(__pyx_v_pyobj);
  __pyx_v_obj = ((struct __pyx_obj_12spidermonkey_ProxyObject *)Py_None); Py_INCREF(Py_None);

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":682 */
  __pyx_1 = PyObject_GetIter(__pyx_v_self->_objs); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 682; goto __pyx_L1;}
  for (;;) {
    __pyx_2 = PyIter_Next(__pyx_1);
    if (!__pyx_2) {
      if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 682; goto __pyx_L1;}
      break;
    }
    if (!__Pyx_TypeTest(__pyx_2, __pyx_ptype_12spidermonkey_ProxyObject)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 682; goto __pyx_L1;}
    Py_DECREF(((PyObject *)__pyx_v_obj));
    __pyx_v_obj = ((struct __pyx_obj_12spidermonkey_ProxyObject *)__pyx_2);
    __pyx_2 = 0;
    if (PyObject_Cmp(__pyx_v_pyobj, __pyx_v_obj->obj, &__pyx_3) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 683; goto __pyx_L1;}
    __pyx_3 = __pyx_3 == 0;
    if (__pyx_3) {
      Py_INCREF(((PyObject *)__pyx_v_obj));
      __pyx_r = ((PyObject *)__pyx_v_obj);
      Py_DECREF(__pyx_1); __pyx_1 = 0;
      goto __pyx_L0;
      goto __pyx_L4;
    }
    __pyx_L4:;
  }
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":685 */
  __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 685; goto __pyx_L1;}
  Py_INCREF(__pyx_k56p);
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_k56p);
  __pyx_1 = PyObject_CallObject(PyExc_ValueError, __pyx_2); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 685; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __Pyx_Raise(__pyx_1, 0, 0);
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  {__pyx_filename = __pyx_f[0]; __pyx_lineno = 685; goto __pyx_L1;}

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  __Pyx_AddTraceback("spidermonkey.context_get_object_from_obj");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_obj);
  Py_DECREF(__pyx_v_self);
  Py_DECREF(__pyx_v_pyobj);
  return __pyx_r;
}

static PyObject *__pyx_f_12spidermonkey_context_get_callback_fn(struct __pyx_obj_12spidermonkey_Context *__pyx_v_self,PyObject *__pyx_v_name) {
  PyObject *__pyx_v_cbname;
  PyObject *__pyx_v_fn;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  int __pyx_4;
  Py_INCREF(__pyx_v_self);
  Py_INCREF(__pyx_v_name);
  __pyx_v_cbname = Py_None; Py_INCREF(Py_None);
  __pyx_v_fn = Py_None; Py_INCREF(Py_None);

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":688 */
  __pyx_1 = PyObject_GetIter(__pyx_v_self->_funcs); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 688; goto __pyx_L1;}
  for (;;) {
    __pyx_2 = PyIter_Next(__pyx_1);
    if (!__pyx_2) {
      if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 688; goto __pyx_L1;}
      break;
    }
    __pyx_3 = PyObject_GetIter(__pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 688; goto __pyx_L1;}
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    __pyx_2 = __Pyx_UnpackItem(__pyx_3); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 688; goto __pyx_L1;}
    Py_DECREF(__pyx_v_cbname);
    __pyx_v_cbname = __pyx_2;
    __pyx_2 = 0;
    __pyx_2 = __Pyx_UnpackItem(__pyx_3); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 688; goto __pyx_L1;}
    Py_DECREF(__pyx_v_fn);
    __pyx_v_fn = __pyx_2;
    __pyx_2 = 0;
    if (__Pyx_EndUnpack(__pyx_3) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 688; goto __pyx_L1;}
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    if (PyObject_Cmp(__pyx_v_cbname, __pyx_v_name, &__pyx_4) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 689; goto __pyx_L1;}
    __pyx_4 = __pyx_4 == 0;
    if (__pyx_4) {
      Py_INCREF(__pyx_v_fn);
      __pyx_r = __pyx_v_fn;
      Py_DECREF(__pyx_1); __pyx_1 = 0;
      goto __pyx_L0;
      goto __pyx_L4;
    }
    __pyx_L4:;
  }
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":691 */
  __pyx_2 = PyNumber_Remainder(__pyx_k57p, __pyx_v_name); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 691; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 691; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_2);
  __pyx_2 = 0;
  __pyx_1 = PyObject_CallObject(PyExc_ValueError, __pyx_3); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 691; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  __Pyx_Raise(__pyx_1, 0, 0);
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  {__pyx_filename = __pyx_f[0]; __pyx_lineno = 691; goto __pyx_L1;}

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  __Pyx_AddTraceback("spidermonkey.context_get_callback_fn");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_cbname);
  Py_DECREF(__pyx_v_fn);
  Py_DECREF(__pyx_v_self);
  Py_DECREF(__pyx_v_name);
  return __pyx_r;
}

static struct __pyx_obj_12spidermonkey_ProxyClass *__pyx_f_12spidermonkey_context_get_class(struct __pyx_obj_12spidermonkey_Context *__pyx_v_self,PyObject *__pyx_v_name) {
  struct __pyx_obj_12spidermonkey_ProxyClass *__pyx_v_cl;
  struct __pyx_obj_12spidermonkey_ProxyClass *__pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  int __pyx_3;
  Py_INCREF(__pyx_v_self);
  Py_INCREF(__pyx_v_name);
  __pyx_v_cl = ((struct __pyx_obj_12spidermonkey_ProxyClass *)Py_None); Py_INCREF(Py_None);

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":695 */
  __pyx_1 = PyObject_GetIter(__pyx_v_self->_classes); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 695; goto __pyx_L1;}
  for (;;) {
    __pyx_2 = PyIter_Next(__pyx_1);
    if (!__pyx_2) {
      if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 695; goto __pyx_L1;}
      break;
    }
    if (!__Pyx_TypeTest(__pyx_2, __pyx_ptype_12spidermonkey_ProxyClass)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 695; goto __pyx_L1;}
    Py_DECREF(((PyObject *)__pyx_v_cl));
    __pyx_v_cl = ((struct __pyx_obj_12spidermonkey_ProxyClass *)__pyx_2);
    __pyx_2 = 0;
    __pyx_2 = PyString_FromString(__pyx_v_cl->jsc->name); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 696; goto __pyx_L1;}
    if (PyObject_Cmp(__pyx_2, __pyx_v_name, &__pyx_3) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 696; goto __pyx_L1;}
    __pyx_3 = __pyx_3 == 0;
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    if (__pyx_3) {
      Py_INCREF(((PyObject *)__pyx_v_cl));
      __pyx_r = __pyx_v_cl;
      Py_DECREF(__pyx_1); __pyx_1 = 0;
      goto __pyx_L0;
      goto __pyx_L4;
    }
    __pyx_L4:;
  }
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":698 */
  __pyx_2 = PyNumber_Remainder(__pyx_k58p, __pyx_v_name); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 698; goto __pyx_L1;}
  __pyx_1 = PyTuple_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 698; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_1, 0, __pyx_2);
  __pyx_2 = 0;
  __pyx_2 = PyObject_CallObject(PyExc_ValueError, __pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 698; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  __Pyx_Raise(__pyx_2, 0, 0);
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  {__pyx_filename = __pyx_f[0]; __pyx_lineno = 698; goto __pyx_L1;}

  __pyx_r = ((struct __pyx_obj_12spidermonkey_ProxyClass *)Py_None); Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  __Pyx_AddTraceback("spidermonkey.context_get_class");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_cl);
  Py_DECREF(__pyx_v_self);
  Py_DECREF(__pyx_v_name);
  return __pyx_r;
}

static int __pyx_f_12spidermonkey_10ProxyClass___cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_f_12spidermonkey_10ProxyClass___cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  struct __pyx_obj_12spidermonkey_Context *__pyx_v_context = 0;
  PyObject *__pyx_v_klass = 0;
  PyObject *__pyx_v_bind_constructor = 0;
  PyObject *__pyx_v_is_global = 0;
  PyObject *__pyx_v_flags = 0;
  PyObject *__pyx_v_name;
  int __pyx_r;
  void *__pyx_1;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  PyObject *__pyx_4 = 0;
  Py_ssize_t __pyx_5;
  char *__pyx_6;
  __pyx_t_12spidermonkey_uint32 __pyx_7;
  int __pyx_8;
  static char *__pyx_argnames[] = {"context","klass","bind_constructor","is_global","flags",0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "OOOOO", __pyx_argnames, &__pyx_v_context, &__pyx_v_klass, &__pyx_v_bind_constructor, &__pyx_v_is_global, &__pyx_v_flags)) return -1;
  Py_INCREF(__pyx_v_self);
  Py_INCREF(__pyx_v_context);
  Py_INCREF(__pyx_v_klass);
  Py_INCREF(__pyx_v_bind_constructor);
  Py_INCREF(__pyx_v_is_global);
  Py_INCREF(__pyx_v_flags);
  __pyx_v_name = Py_None; Py_INCREF(Py_None);
  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_context), __pyx_ptype_12spidermonkey_Context, 1, "context")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 705; goto __pyx_L1;}

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":709 */
  __pyx_1 = __pyx_f_12spidermonkey_xmalloc((sizeof(struct JSClass))); if (__pyx_1 == NULL) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 709; goto __pyx_L1;}
  ((struct __pyx_obj_12spidermonkey_ProxyClass *)__pyx_v_self)->jsc = ((struct JSClass *)__pyx_1);

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":710 */
  __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_js_classname); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 710; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 710; goto __pyx_L1;}
  Py_INCREF(__pyx_v_klass);
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_v_klass);
  __pyx_4 = PyObject_CallObject(__pyx_2, __pyx_3); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 710; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  Py_DECREF(__pyx_v_name);
  __pyx_v_name = __pyx_4;
  __pyx_4 = 0;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":711 */
  __pyx_5 = PyObject_Length(__pyx_v_name); if (__pyx_5 == -1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 711; goto __pyx_L1;}
  __pyx_1 = __pyx_f_12spidermonkey_xmalloc(((__pyx_5 + 1) * (sizeof(char)))); if (__pyx_1 == NULL) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 711; goto __pyx_L1;}
  ((struct __pyx_obj_12spidermonkey_ProxyClass *)__pyx_v_self)->jsc->name = ((char *)__pyx_1);

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":712 */
  __pyx_6 = PyString_AsString(__pyx_v_name); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 712; goto __pyx_L1;}
  strcpy(((struct __pyx_obj_12spidermonkey_ProxyClass *)__pyx_v_self)->jsc->name,__pyx_6);

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":716 */
  __pyx_7 = PyInt_AsLong(__pyx_v_flags); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 716; goto __pyx_L1;}
  ((struct __pyx_obj_12spidermonkey_ProxyClass *)__pyx_v_self)->jsc->flags = __pyx_7;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":717 */
  ((struct __pyx_obj_12spidermonkey_ProxyClass *)__pyx_v_self)->jsc->addProperty = JS_PropertyStub;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":718 */
  ((struct __pyx_obj_12spidermonkey_ProxyClass *)__pyx_v_self)->jsc->delProperty = JS_PropertyStub;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":719 */
  ((struct __pyx_obj_12spidermonkey_ProxyClass *)__pyx_v_self)->jsc->getProperty = __pyx_f_12spidermonkey_get_property;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":720 */
  ((struct __pyx_obj_12spidermonkey_ProxyClass *)__pyx_v_self)->jsc->setProperty = __pyx_f_12spidermonkey_set_property;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":721 */
  ((struct __pyx_obj_12spidermonkey_ProxyClass *)__pyx_v_self)->jsc->enumerate = JS_EnumerateStub;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":722 */
  __pyx_8 = PyObject_IsTrue(__pyx_v_is_global); if (__pyx_8 < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 722; goto __pyx_L1;}
  if (__pyx_8) {
    ((struct __pyx_obj_12spidermonkey_ProxyClass *)__pyx_v_self)->jsc->resolve = __pyx_f_12spidermonkey_resolve_global;
    goto __pyx_L2;
  }
  /*else*/ {
    ((struct __pyx_obj_12spidermonkey_ProxyClass *)__pyx_v_self)->jsc->resolve = JS_ResolveStub;
  }
  __pyx_L2:;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":726 */
  ((struct __pyx_obj_12spidermonkey_ProxyClass *)__pyx_v_self)->jsc->convert = JS_ConvertStub;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":727 */
  ((struct __pyx_obj_12spidermonkey_ProxyClass *)__pyx_v_self)->jsc->finalize = __pyx_f_12spidermonkey_finalize;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":729 */
  ((struct __pyx_obj_12spidermonkey_ProxyClass *)__pyx_v_self)->jsc->getObjectOps = NULL;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":730 */
  ((struct __pyx_obj_12spidermonkey_ProxyClass *)__pyx_v_self)->jsc->checkAccess = NULL;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":731 */
  ((struct __pyx_obj_12spidermonkey_ProxyClass *)__pyx_v_self)->jsc->call = NULL;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":732 */
  ((struct __pyx_obj_12spidermonkey_ProxyClass *)__pyx_v_self)->jsc->construct = NULL;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":733 */
  ((struct __pyx_obj_12spidermonkey_ProxyClass *)__pyx_v_self)->jsc->xdrObject = NULL;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":734 */
  ((struct __pyx_obj_12spidermonkey_ProxyClass *)__pyx_v_self)->jsc->hasInstance = NULL;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":735 */
  ((struct __pyx_obj_12spidermonkey_ProxyClass *)__pyx_v_self)->jsc->mark = NULL;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":736 */
  ((struct __pyx_obj_12spidermonkey_ProxyClass *)__pyx_v_self)->jsc->reserveSlots = NULL;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":738 */
  __pyx_8 = PyObject_IsTrue(__pyx_v_bind_constructor); if (__pyx_8 < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 738; goto __pyx_L1;}
  if (__pyx_8) {
    __pyx_8 = (JS_InitClass(__pyx_v_context->cx,__pyx_v_context->globj,NULL,((struct __pyx_obj_12spidermonkey_ProxyClass *)__pyx_v_self)->jsc,__pyx_f_12spidermonkey_constructor_cb,0,NULL,NULL,NULL,NULL) == NULL);
    if (__pyx_8) {
      __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 742; goto __pyx_L1;}
      Py_INCREF(__pyx_k59p);
      PyTuple_SET_ITEM(__pyx_2, 0, __pyx_k59p);
      __pyx_3 = PyObject_CallObject(PyExc_SystemError, __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 742; goto __pyx_L1;}
      Py_DECREF(__pyx_2); __pyx_2 = 0;
      __Pyx_Raise(__pyx_3, 0, 0);
      Py_DECREF(__pyx_3); __pyx_3 = 0;
      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 742; goto __pyx_L1;}
      goto __pyx_L4;
    }
    __pyx_L4:;
    goto __pyx_L3;
  }
  __pyx_L3:;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  Py_XDECREF(__pyx_4);
  __Pyx_AddTraceback("spidermonkey.ProxyClass.__cinit__");
  __pyx_r = -1;
  __pyx_L0:;
  Py_DECREF(__pyx_v_name);
  Py_DECREF(__pyx_v_self);
  Py_DECREF(__pyx_v_context);
  Py_DECREF(__pyx_v_klass);
  Py_DECREF(__pyx_v_bind_constructor);
  Py_DECREF(__pyx_v_is_global);
  Py_DECREF(__pyx_v_flags);
  return __pyx_r;
}

static int __pyx_f_12spidermonkey_10ProxyClass___init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_f_12spidermonkey_10ProxyClass___init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  struct __pyx_obj_12spidermonkey_Context *__pyx_v_context = 0;
  PyObject *__pyx_v_klass = 0;
  PyObject *__pyx_v_bind_constructor = 0;
  PyObject *__pyx_v_is_global = 0;
  PyObject *__pyx_v_flags = 0;
  int __pyx_r;
  static char *__pyx_argnames[] = {"context","klass","bind_constructor","is_global","flags",0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "OOOOO", __pyx_argnames, &__pyx_v_context, &__pyx_v_klass, &__pyx_v_bind_constructor, &__pyx_v_is_global, &__pyx_v_flags)) return -1;
  Py_INCREF(__pyx_v_self);
  Py_INCREF(__pyx_v_context);
  Py_INCREF(__pyx_v_klass);
  Py_INCREF(__pyx_v_bind_constructor);
  Py_INCREF(__pyx_v_is_global);
  Py_INCREF(__pyx_v_flags);
  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_context), __pyx_ptype_12spidermonkey_Context, 1, "context")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 744; goto __pyx_L1;}
  Py_INCREF(__pyx_v_klass);
  Py_DECREF(((struct __pyx_obj_12spidermonkey_ProxyClass *)__pyx_v_self)->klass);
  ((struct __pyx_obj_12spidermonkey_ProxyClass *)__pyx_v_self)->klass = __pyx_v_klass;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1:;
  __Pyx_AddTraceback("spidermonkey.ProxyClass.__init__");
  __pyx_r = -1;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  Py_DECREF(__pyx_v_context);
  Py_DECREF(__pyx_v_klass);
  Py_DECREF(__pyx_v_bind_constructor);
  Py_DECREF(__pyx_v_is_global);
  Py_DECREF(__pyx_v_flags);
  return __pyx_r;
}

static void __pyx_f_12spidermonkey_10ProxyClass___dealloc__(PyObject *__pyx_v_self); /*proto*/
static void __pyx_f_12spidermonkey_10ProxyClass___dealloc__(PyObject *__pyx_v_self) {
  Py_INCREF(__pyx_v_self);

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":749 */
  free(((struct __pyx_obj_12spidermonkey_ProxyClass *)__pyx_v_self)->jsc->name);

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":750 */
  free(((struct __pyx_obj_12spidermonkey_ProxyClass *)__pyx_v_self)->jsc);

  Py_DECREF(__pyx_v_self);
}

static PyObject *__pyx_f_12spidermonkey_trap(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_12spidermonkey_trap(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_r;
  static char *__pyx_argnames[] = {0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "", __pyx_argnames)) return 0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  return __pyx_r;
}

static PyObject *__pyx_f_12spidermonkey_js_classname(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_12spidermonkey_js_classname(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_pobj = 0;
  PyObject *__pyx_v_klass;
  PyObject *__pyx_v_name;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  int __pyx_4;
  PyObject *__pyx_5 = 0;
  int __pyx_6;
  static char *__pyx_argnames[] = {"pobj",0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "O", __pyx_argnames, &__pyx_v_pobj)) return 0;
  Py_INCREF(__pyx_v_pobj);
  __pyx_v_klass = Py_None; Py_INCREF(Py_None);
  __pyx_v_name = Py_None; Py_INCREF(Py_None);

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":758 */
  __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_inspect); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 758; goto __pyx_L1;}
  __pyx_2 = PyObject_GetAttr(__pyx_1, __pyx_n_isclass); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 758; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  __pyx_1 = PyTuple_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 758; goto __pyx_L1;}
  Py_INCREF(__pyx_v_pobj);
  PyTuple_SET_ITEM(__pyx_1, 0, __pyx_v_pobj);
  __pyx_3 = PyObject_CallObject(__pyx_2, __pyx_1); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 758; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  __pyx_4 = PyObject_IsTrue(__pyx_3); if (__pyx_4 < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 758; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  if (__pyx_4) {
    Py_INCREF(__pyx_v_pobj);
    Py_DECREF(__pyx_v_klass);
    __pyx_v_klass = __pyx_v_pobj;
    goto __pyx_L2;
  }
  __pyx_4 = PyObject_HasAttr(__pyx_v_pobj,__pyx_n___class__); if (__pyx_4 == -1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 760; goto __pyx_L1;}
  if (__pyx_4) {
    __pyx_2 = PyObject_GetAttr(__pyx_v_pobj, __pyx_n___class__); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 761; goto __pyx_L1;}
    Py_DECREF(__pyx_v_klass);
    __pyx_v_klass = __pyx_2;
    __pyx_2 = 0;
    goto __pyx_L2;
  }
  /*else*/ {
    __pyx_1 = __Pyx_GetName(__pyx_b, __pyx_n_AttributeError); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 763; goto __pyx_L1;}
    __pyx_3 = PyNumber_Remainder(__pyx_k61p, __pyx_v_pobj); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 763; goto __pyx_L1;}
    __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 763; goto __pyx_L1;}
    PyTuple_SET_ITEM(__pyx_2, 0, __pyx_3);
    __pyx_3 = 0;
    __pyx_3 = PyObject_CallObject(__pyx_1, __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 763; goto __pyx_L1;}
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    __Pyx_Raise(__pyx_3, 0, 0);
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 763; goto __pyx_L1;}
  }
  __pyx_L2:;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":765 */
  /*try:*/ {
    __pyx_1 = PyObject_GetAttr(__pyx_v_klass, __pyx_n_js_name); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 766; goto __pyx_L3;}
    Py_DECREF(__pyx_v_name);
    __pyx_v_name = __pyx_1;
    __pyx_1 = 0;
  }
  goto __pyx_L4;
  __pyx_L3:;
  Py_XDECREF(__pyx_2); __pyx_2 = 0;
  Py_XDECREF(__pyx_3); __pyx_3 = 0;
  Py_XDECREF(__pyx_1); __pyx_1 = 0;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":767 */
  __pyx_2 = __Pyx_GetName(__pyx_b, __pyx_n_AttributeError); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 767; goto __pyx_L1;}
  __pyx_4 = PyErr_ExceptionMatches(__pyx_2);
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  if (__pyx_4) {
    __Pyx_AddTraceback("spidermonkey.js_classname");
    if (__Pyx_GetException(&__pyx_3, &__pyx_1, &__pyx_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 767; goto __pyx_L1;}
    __pyx_5 = PyObject_GetAttr(__pyx_v_klass, __pyx_n___name__); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 768; goto __pyx_L1;}
    Py_DECREF(__pyx_v_name);
    __pyx_v_name = __pyx_5;
    __pyx_5 = 0;
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    goto __pyx_L4;
  }
  goto __pyx_L1;
  __pyx_L4:;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":770 */
  __pyx_5 = __Pyx_GetName(__pyx_m, __pyx_n_isstringlike); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 770; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 770; goto __pyx_L1;}
  Py_INCREF(__pyx_v_name);
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_v_name);
  __pyx_1 = PyObject_CallObject(__pyx_5, __pyx_3); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 770; goto __pyx_L1;}
  Py_DECREF(__pyx_5); __pyx_5 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  __pyx_4 = PyObject_IsTrue(__pyx_1); if (__pyx_4 < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 770; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  __pyx_6 = (!__pyx_4);
  if (__pyx_6) {
    __pyx_2 = __Pyx_GetName(__pyx_b, __pyx_n_AttributeError); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 771; goto __pyx_L1;}
    __pyx_5 = PyNumber_Remainder(__pyx_k64p, __pyx_v_klass); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 771; goto __pyx_L1;}
    __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 771; goto __pyx_L1;}
    PyTuple_SET_ITEM(__pyx_3, 0, __pyx_5);
    __pyx_5 = 0;
    __pyx_1 = PyObject_CallObject(__pyx_2, __pyx_3); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 771; goto __pyx_L1;}
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    __Pyx_Raise(__pyx_1, 0, 0);
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 771; goto __pyx_L1;}
    goto __pyx_L5;
  }
  __pyx_L5:;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":772 */
  Py_INCREF(__pyx_v_name);
  __pyx_r = __pyx_v_name;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  Py_XDECREF(__pyx_5);
  __Pyx_AddTraceback("spidermonkey.js_classname");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_klass);
  Py_DECREF(__pyx_v_name);
  Py_DECREF(__pyx_v_pobj);
  return __pyx_r;
}

static int __pyx_f_12spidermonkey_11ProxyObject___init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_f_12spidermonkey_11ProxyObject___init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_obj = 0;
  int __pyx_r;
  static char *__pyx_argnames[] = {"obj",0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "O", __pyx_argnames, &__pyx_v_obj)) return -1;
  Py_INCREF(__pyx_v_self);
  Py_INCREF(__pyx_v_obj);
  Py_INCREF(__pyx_v_obj);
  Py_DECREF(((struct __pyx_obj_12spidermonkey_ProxyObject *)__pyx_v_self)->obj);
  ((struct __pyx_obj_12spidermonkey_ProxyObject *)__pyx_v_self)->obj = __pyx_v_obj;

  __pyx_r = 0;
  Py_DECREF(__pyx_v_self);
  Py_DECREF(__pyx_v_obj);
  return __pyx_r;
}

static int __pyx_f_12spidermonkey_13ProxyFunction___init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_f_12spidermonkey_13ProxyFunction___init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  struct __pyx_obj_12spidermonkey_Context *__pyx_v_cx = 0;
  int __pyx_r;
  static char *__pyx_argnames[] = {"cx",0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "O", __pyx_argnames, &__pyx_v_cx)) return -1;
  Py_INCREF(__pyx_v_self);
  Py_INCREF(__pyx_v_cx);
  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_cx), __pyx_ptype_12spidermonkey_Context, 1, "cx")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 786; goto __pyx_L1;}
  Py_INCREF(((PyObject *)__pyx_v_cx));
  Py_DECREF(((PyObject *)((struct __pyx_obj_12spidermonkey_ProxyFunction *)__pyx_v_self)->cx));
  ((struct __pyx_obj_12spidermonkey_ProxyFunction *)__pyx_v_self)->cx = __pyx_v_cx;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1:;
  __Pyx_AddTraceback("spidermonkey.ProxyFunction.__init__");
  __pyx_r = -1;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  Py_DECREF(__pyx_v_cx);
  return __pyx_r;
}

static PyObject *__pyx_f_12spidermonkey_13ProxyFunction___call__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_12spidermonkey_13ProxyFunction___call__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_args = 0;
  __pyx_t_12spidermonkey_jsval *__pyx_v_argv;
  __pyx_t_12spidermonkey_jsval __pyx_v_rval;
  __pyx_t_12spidermonkey_jsval __pyx_v_jsarg;
  PyObject *__pyx_v_nr_args;
  PyObject *__pyx_v_i;
  PyObject *__pyx_v_arg;
  PyObject *__pyx_v_retval;
  PyObject *__pyx_r;
  Py_ssize_t __pyx_1;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  __pyx_t_12spidermonkey_size_t __pyx_4;
  void *__pyx_5;
  long __pyx_6;
  long __pyx_7;
  __pyx_t_12spidermonkey_jsval __pyx_8;
  __pyx_t_12spidermonkey_uintN __pyx_9;
  __pyx_t_12spidermonkey_JSBool __pyx_10;
  int __pyx_11;
  int __pyx_12;
  static char *__pyx_argnames[] = {0};
  if (__Pyx_GetStarArgs(&__pyx_args, &__pyx_kwds, __pyx_argnames, 0, &__pyx_v_args, 0, 0) < 0) return 0;
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "", __pyx_argnames)) {
    Py_XDECREF(__pyx_args);
    Py_XDECREF(__pyx_kwds);
    Py_XDECREF(__pyx_v_args);
    return 0;
  }
  Py_INCREF(__pyx_v_self);
  __pyx_v_nr_args = Py_None; Py_INCREF(Py_None);
  __pyx_v_i = Py_None; Py_INCREF(Py_None);
  __pyx_v_arg = Py_None; Py_INCREF(Py_None);
  __pyx_v_retval = Py_None; Py_INCREF(Py_None);

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":794 */
  __pyx_1 = PyObject_Length(__pyx_v_args); if (__pyx_1 == -1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 794; goto __pyx_L1;}
  __pyx_2 = PyInt_FromSsize_t(__pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 794; goto __pyx_L1;}
  Py_DECREF(__pyx_v_nr_args);
  __pyx_v_nr_args = __pyx_2;
  __pyx_2 = 0;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":795 */
  __pyx_2 = PyInt_FromLong((sizeof(__pyx_t_12spidermonkey_jsval))); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 795; goto __pyx_L1;}
  __pyx_3 = PyNumber_Multiply(__pyx_2, __pyx_v_nr_args); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 795; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_4 = PyInt_AsLong(__pyx_3); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 795; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  __pyx_5 = __pyx_f_12spidermonkey_xmalloc(__pyx_4); if (__pyx_5 == NULL) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 795; goto __pyx_L1;}
  __pyx_v_argv = ((__pyx_t_12spidermonkey_jsval *)__pyx_5);

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":796 */
  /*try:*/ {

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":797 */
    __pyx_7 = PyInt_AsLong(__pyx_v_nr_args); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 797; goto __pyx_L3;}
    for (__pyx_6 = 0; __pyx_6 < __pyx_7; ++__pyx_6) {
      __pyx_2 = PyInt_FromLong(__pyx_6); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 797; goto __pyx_L3;}
      Py_DECREF(__pyx_v_i);
      __pyx_v_i = __pyx_2;
      __pyx_2 = 0;

      /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":798 */
      __pyx_3 = PyObject_GetItem(__pyx_v_args, __pyx_v_i); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 798; goto __pyx_L3;}
      Py_DECREF(__pyx_v_arg);
      __pyx_v_arg = __pyx_3;
      __pyx_3 = 0;

      /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":801 */
      __pyx_8 = __pyx_f_12spidermonkey_JS_from_Py(((struct __pyx_obj_12spidermonkey_ProxyFunction *)__pyx_v_self)->cx->cx,NULL,__pyx_v_arg); if (__pyx_8 == 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 801; goto __pyx_L3;}
      __pyx_v_jsarg = __pyx_8;

      /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":802 */
      __pyx_1 = PyInt_AsSsize_t(__pyx_v_i); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 802; goto __pyx_L3;}
      (__pyx_v_argv[__pyx_1]) = __pyx_v_jsarg;
    }

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":804 */
    __pyx_9 = PyInt_AsLong(__pyx_v_nr_args); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 804; goto __pyx_L3;}
    __pyx_10 = JS_CallFunctionValue(((struct __pyx_obj_12spidermonkey_ProxyFunction *)__pyx_v_self)->cx->cx,((struct __pyx_obj_12spidermonkey_ProxyFunction *)__pyx_v_self)->cx->globj,((struct __pyx_obj_12spidermonkey_ProxyFunction *)__pyx_v_self)->fun,__pyx_9,__pyx_v_argv,(&__pyx_v_rval)); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 804; goto __pyx_L3;}
  }
  /*finally:*/ {
    int __pyx_why;
    PyObject *__pyx_exc_type, *__pyx_exc_value, *__pyx_exc_tb;
    int __pyx_exc_lineno;
    __pyx_why = 0; goto __pyx_L4;
    __pyx_L3: {
      __pyx_why = 4;
      Py_XDECREF(__pyx_2); __pyx_2 = 0;
      Py_XDECREF(__pyx_3); __pyx_3 = 0;
      PyErr_Fetch(&__pyx_exc_type, &__pyx_exc_value, &__pyx_exc_tb);
      __pyx_exc_lineno = __pyx_lineno;
      goto __pyx_L4;
    }
    __pyx_L4:;
    free(__pyx_v_argv);
    switch (__pyx_why) {
      case 4: {
        PyErr_Restore(__pyx_exc_type, __pyx_exc_value, __pyx_exc_tb);
        __pyx_lineno = __pyx_exc_lineno;
        __pyx_exc_type = 0;
        __pyx_exc_value = 0;
        __pyx_exc_tb = 0;
        goto __pyx_L1;
      }
    }
  }

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":808 */
  __pyx_2 = __Pyx_GetName(__pyx_b, __pyx_n_ok); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 808; goto __pyx_L1;}
  __pyx_11 = PyObject_IsTrue(__pyx_2); if (__pyx_11 < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 808; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_12 = (!__pyx_11);
  if (__pyx_12) {
    __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 809; goto __pyx_L1;}
    Py_INCREF(((struct __pyx_obj_12spidermonkey_ProxyFunction *)__pyx_v_self)->cx->_last_error);
    PyTuple_SET_ITEM(__pyx_3, 0, ((struct __pyx_obj_12spidermonkey_ProxyFunction *)__pyx_v_self)->cx->_last_error);
    __pyx_2 = PyObject_CallObject(PyExc_RuntimeError, __pyx_3); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 809; goto __pyx_L1;}
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    __Pyx_Raise(__pyx_2, 0, 0);
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 809; goto __pyx_L1;}
    goto __pyx_L8;
  }
  __pyx_L8:;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":810 */
  __pyx_3 = __pyx_f_12spidermonkey_Py_from_JS(((struct __pyx_obj_12spidermonkey_ProxyFunction *)__pyx_v_self)->cx->cx,__pyx_v_rval); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 810; goto __pyx_L1;}
  Py_DECREF(__pyx_v_retval);
  __pyx_v_retval = __pyx_3;
  __pyx_3 = 0;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":811 */
  JS_MaybeGC(((struct __pyx_obj_12spidermonkey_ProxyFunction *)__pyx_v_self)->cx->cx);

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":812 */
  Py_INCREF(__pyx_v_retval);
  __pyx_r = __pyx_v_retval;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  __Pyx_AddTraceback("spidermonkey.ProxyFunction.__call__");
  __pyx_r = 0;
  __pyx_L0:;
  Py_XDECREF(__pyx_v_args);
  Py_DECREF(__pyx_v_nr_args);
  Py_DECREF(__pyx_v_i);
  Py_DECREF(__pyx_v_arg);
  Py_DECREF(__pyx_v_retval);
  Py_DECREF(__pyx_v_self);
  Py_XDECREF(__pyx_args);
  Py_XDECREF(__pyx_kwds);
  return __pyx_r;
}

static struct __pyx_obj_12spidermonkey_ProxyFunction *__pyx_f_12spidermonkey_create_proxy_function(struct __pyx_obj_12spidermonkey_Context *__pyx_v_cx,__pyx_t_12spidermonkey_jsval __pyx_v_fun) {
  struct __pyx_obj_12spidermonkey_ProxyFunction *__pyx_v_ret;
  struct __pyx_obj_12spidermonkey_ProxyFunction *__pyx_r;
  int __pyx_1;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  PyObject *__pyx_4 = 0;
  Py_INCREF(__pyx_v_cx);
  __pyx_v_ret = ((struct __pyx_obj_12spidermonkey_ProxyFunction *)Py_None); Py_INCREF(Py_None);

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":815 */
  __pyx_1 = (JS_TypeOfValue(__pyx_v_cx->cx,__pyx_v_fun) != JSTYPE_FUNCTION);
  if (__pyx_1) {
    __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_JSError); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 816; goto __pyx_L1;}
    __pyx_3 = PyInt_FromLong(JS_TypeOfValue(__pyx_v_cx->cx,__pyx_v_fun)); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 816; goto __pyx_L1;}
    __pyx_4 = PyNumber_Remainder(__pyx_k66p, __pyx_3); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 816; goto __pyx_L1;}
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 816; goto __pyx_L1;}
    PyTuple_SET_ITEM(__pyx_3, 0, __pyx_4);
    __pyx_4 = 0;
    __pyx_4 = PyObject_CallObject(__pyx_2, __pyx_3); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 816; goto __pyx_L1;}
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    __Pyx_Raise(__pyx_4, 0, 0);
    Py_DECREF(__pyx_4); __pyx_4 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 816; goto __pyx_L1;}
    goto __pyx_L2;
  }
  __pyx_L2:;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":818 */
  __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 818; goto __pyx_L1;}
  Py_INCREF(((PyObject *)__pyx_v_cx));
  PyTuple_SET_ITEM(__pyx_2, 0, ((PyObject *)__pyx_v_cx));
  __pyx_3 = PyObject_CallObject(((PyObject *)__pyx_ptype_12spidermonkey_ProxyFunction), __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 818; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(((PyObject *)__pyx_v_ret));
  __pyx_v_ret = ((struct __pyx_obj_12spidermonkey_ProxyFunction *)__pyx_3);
  __pyx_3 = 0;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":819 */
  __pyx_v_ret->fun = __pyx_v_fun;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":820 */
  Py_INCREF(((PyObject *)__pyx_v_ret));
  __pyx_r = __pyx_v_ret;
  goto __pyx_L0;

  __pyx_r = ((struct __pyx_obj_12spidermonkey_ProxyFunction *)Py_None); Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  Py_XDECREF(__pyx_4);
  __Pyx_AddTraceback("spidermonkey.create_proxy_function");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_ret);
  Py_DECREF(__pyx_v_cx);
  return __pyx_r;
}

static __pyx_t_12spidermonkey_JSBool __pyx_f_12spidermonkey_constructor_cb(struct JSContext *__pyx_v_cx,struct JSObject *__pyx_v_obj,__pyx_t_12spidermonkey_uintN __pyx_v_argc,__pyx_t_12spidermonkey_jsval *__pyx_v_argv,__pyx_t_12spidermonkey_jsval *__pyx_v_rval) {
  struct __pyx_obj_12spidermonkey_ProxyClass *__pyx_v_proxy_class;
  struct __pyx_obj_12spidermonkey_Context *__pyx_v_context;
  char *__pyx_v_fname;
  struct JSFunction *__pyx_v_func;
  int __pyx_v_arg;
  PyObject *__pyx_v_msg;
  PyObject *__pyx_v_args;
  PyObject *__pyx_v_py_rval;
  __pyx_t_12spidermonkey_JSBool __pyx_r;
  int __pyx_1;
  char *__pyx_2;
  PyObject *__pyx_3 = 0;
  PyObject *__pyx_4 = 0;
  PyObject *__pyx_5 = 0;
  int __pyx_6;
  PyObject *__pyx_7 = 0;
  __pyx_v_proxy_class = ((struct __pyx_obj_12spidermonkey_ProxyClass *)Py_None); Py_INCREF(Py_None);
  __pyx_v_context = ((struct __pyx_obj_12spidermonkey_Context *)Py_None); Py_INCREF(Py_None);
  __pyx_v_msg = Py_None; Py_INCREF(Py_None);
  __pyx_v_args = Py_None; Py_INCREF(Py_None);
  __pyx_v_py_rval = Py_None; Py_INCREF(Py_None);

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":831 */
  __pyx_v_func = JS_ValueToFunction(__pyx_v_cx,(__pyx_v_argv[(-2)]));

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":832 */
  __pyx_1 = (__pyx_v_func == NULL);
  if (__pyx_1) {

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":833 */
    Py_INCREF(__pyx_k67p);
    Py_DECREF(__pyx_v_msg);
    __pyx_v_msg = __pyx_k67p;

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":834 */
    __pyx_2 = PyString_AsString(__pyx_v_msg); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 834; goto __pyx_L1;}
    JS_ReportError(__pyx_v_cx,__pyx_2);

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":835 */
    __pyx_r = JS_FALSE;
    goto __pyx_L0;
    goto __pyx_L2;
  }
  __pyx_L2:;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":836 */
  __pyx_v_fname = JS_GetFunctionName(__pyx_v_func);

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":838 */
  /*try:*/ {

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":839 */
    __pyx_3 = ((PyObject *)__pyx_f_12spidermonkey_get_context(__pyx_v_cx)); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 839; goto __pyx_L3;}
    Py_DECREF(((PyObject *)__pyx_v_context));
    __pyx_v_context = ((struct __pyx_obj_12spidermonkey_Context *)__pyx_3);
    __pyx_3 = 0;

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":840 */
    __pyx_3 = PyString_FromString(__pyx_v_fname); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 840; goto __pyx_L3;}
    __pyx_4 = ((PyObject *)__pyx_f_12spidermonkey_context_get_class(__pyx_v_context,__pyx_3)); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 840; goto __pyx_L3;}
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    Py_DECREF(((PyObject *)__pyx_v_proxy_class));
    __pyx_v_proxy_class = ((struct __pyx_obj_12spidermonkey_ProxyClass *)__pyx_4);
    __pyx_4 = 0;

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":842 */
    __pyx_3 = PyList_New(0); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 842; goto __pyx_L3;}
    Py_DECREF(__pyx_v_args);
    __pyx_v_args = __pyx_3;
    __pyx_3 = 0;

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":843 */
    for (__pyx_v_arg = 0; __pyx_v_arg < __pyx_v_argc; ++__pyx_v_arg) {
      __pyx_4 = PyObject_GetAttr(__pyx_v_args, __pyx_n_append); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 844; goto __pyx_L3;}
      __pyx_3 = __pyx_f_12spidermonkey_Py_from_JS(__pyx_v_cx,(__pyx_v_argv[__pyx_v_arg])); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 844; goto __pyx_L3;}
      __pyx_5 = PyTuple_New(1); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 844; goto __pyx_L3;}
      PyTuple_SET_ITEM(__pyx_5, 0, __pyx_3);
      __pyx_3 = 0;
      __pyx_3 = PyObject_CallObject(__pyx_4, __pyx_5); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 844; goto __pyx_L3;}
      Py_DECREF(__pyx_4); __pyx_4 = 0;
      Py_DECREF(__pyx_5); __pyx_5 = 0;
      Py_DECREF(__pyx_3); __pyx_3 = 0;
    }

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":845 */
    __pyx_1 = PyObject_HasAttr(__pyx_v_proxy_class->klass,__pyx_n_js_constructor); if (__pyx_1 == -1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 845; goto __pyx_L3;}
    __pyx_6 = (!__pyx_1);
    if (__pyx_6) {
      __pyx_4 = PySequence_Tuple(__pyx_v_args); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 846; goto __pyx_L3;}
      __pyx_5 = PyObject_CallObject(__pyx_v_proxy_class->klass, __pyx_4); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 846; goto __pyx_L3;}
      Py_DECREF(__pyx_4); __pyx_4 = 0;
      Py_DECREF(__pyx_v_py_rval);
      __pyx_v_py_rval = __pyx_5;
      __pyx_5 = 0;
      goto __pyx_L7;
    }
    /*else*/ {
      __pyx_3 = PyObject_GetAttr(__pyx_v_proxy_class->klass, __pyx_n_js_constructor); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 848; goto __pyx_L3;}
      __pyx_4 = __Pyx_GetItemInt(__pyx_3, 0); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 848; goto __pyx_L3;}
      Py_DECREF(__pyx_3); __pyx_3 = 0;
      __pyx_5 = PyTuple_New(1); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 848; goto __pyx_L3;}
      Py_INCREF(((PyObject *)__pyx_v_context));
      PyTuple_SET_ITEM(__pyx_5, 0, ((PyObject *)__pyx_v_context));
      __pyx_3 = PySequence_Tuple(__pyx_v_args); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 848; goto __pyx_L3;}
      __pyx_7 = PyNumber_Add(__pyx_5, __pyx_3); if (!__pyx_7) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 848; goto __pyx_L3;}
      Py_DECREF(__pyx_5); __pyx_5 = 0;
      Py_DECREF(__pyx_3); __pyx_3 = 0;
      __pyx_5 = PyObject_CallObject(__pyx_4, __pyx_7); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 848; goto __pyx_L3;}
      Py_DECREF(__pyx_4); __pyx_4 = 0;
      Py_DECREF(__pyx_7); __pyx_7 = 0;
      Py_DECREF(__pyx_v_py_rval);
      __pyx_v_py_rval = __pyx_5;
      __pyx_5 = 0;
    }
    __pyx_L7:;

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":849 */
    __pyx_f_12spidermonkey_context_register_object(__pyx_v_context,__pyx_v_py_rval,__pyx_v_obj);
  }
  goto __pyx_L4;
  __pyx_L3:;
  Py_XDECREF(__pyx_3); __pyx_3 = 0;
  Py_XDECREF(__pyx_4); __pyx_4 = 0;
  Py_XDECREF(__pyx_7); __pyx_7 = 0;
  Py_XDECREF(__pyx_5); __pyx_5 = 0;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":850 */
  /*except:*/ {
    __Pyx_AddTraceback("spidermonkey.constructor_cb");
    if (__Pyx_GetException(&__pyx_3, &__pyx_4, &__pyx_7) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 850; goto __pyx_L1;}
    __pyx_r = __pyx_f_12spidermonkey_report(__pyx_v_cx);
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    Py_DECREF(__pyx_4); __pyx_4 = 0;
    Py_DECREF(__pyx_7); __pyx_7 = 0;
    goto __pyx_L0;
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    Py_DECREF(__pyx_4); __pyx_4 = 0;
    Py_DECREF(__pyx_7); __pyx_7 = 0;
    goto __pyx_L4;
  }
  __pyx_L4:;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":853 */
  __pyx_r = JS_TRUE;
  goto __pyx_L0;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_3);
  Py_XDECREF(__pyx_4);
  Py_XDECREF(__pyx_5);
  Py_XDECREF(__pyx_7);
  __Pyx_WriteUnraisable("spidermonkey.constructor_cb");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_proxy_class);
  Py_DECREF(__pyx_v_context);
  Py_DECREF(__pyx_v_msg);
  Py_DECREF(__pyx_v_args);
  Py_DECREF(__pyx_v_py_rval);
  return __pyx_r;
}

static __pyx_t_12spidermonkey_JSBool __pyx_f_12spidermonkey_bound_method_cb(struct JSContext *__pyx_v_cx,struct JSObject *__pyx_v_obj,__pyx_t_12spidermonkey_uintN __pyx_v_argc,__pyx_t_12spidermonkey_jsval *__pyx_v_argv,__pyx_t_12spidermonkey_jsval *__pyx_v_rval) {
  struct __pyx_obj_12spidermonkey_Context *__pyx_v_context;
  struct JSFunction *__pyx_v_func;
  int __pyx_v_arg;
  struct JSClass *__pyx_v_jsclass;
  struct __pyx_obj_12spidermonkey_ProxyObject *__pyx_v_proxy_obj;
  PyObject *__pyx_v_method_name;
  PyObject *__pyx_v_py_args;
  PyObject *__pyx_v_meth;
  PyObject *__pyx_v_py_rval;
  __pyx_t_12spidermonkey_JSBool __pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  __pyx_t_12spidermonkey_jsval __pyx_4;
  __pyx_v_context = ((struct __pyx_obj_12spidermonkey_Context *)Py_None); Py_INCREF(Py_None);
  __pyx_v_proxy_obj = ((struct __pyx_obj_12spidermonkey_ProxyObject *)Py_None); Py_INCREF(Py_None);
  __pyx_v_method_name = Py_None; Py_INCREF(Py_None);
  __pyx_v_py_args = Py_None; Py_INCREF(Py_None);
  __pyx_v_meth = Py_None; Py_INCREF(Py_None);
  __pyx_v_py_rval = Py_None; Py_INCREF(Py_None);

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":864 */
  __pyx_v_func = JS_ValueToFunction(__pyx_v_cx,(__pyx_v_argv[(-2)]));

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":865 */
  __pyx_v_jsclass = JS_GetClass(__pyx_v_cx,__pyx_v_obj);

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":867 */
  /*try:*/ {

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":868 */
    __pyx_1 = ((PyObject *)__pyx_f_12spidermonkey_get_context(__pyx_v_cx)); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 868; goto __pyx_L2;}
    Py_DECREF(((PyObject *)__pyx_v_context));
    __pyx_v_context = ((struct __pyx_obj_12spidermonkey_Context *)__pyx_1);
    __pyx_1 = 0;

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":869 */
    __pyx_1 = __pyx_f_12spidermonkey_context_get_object(__pyx_v_context,__pyx_v_obj); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 869; goto __pyx_L2;}
    if (!__Pyx_TypeTest(__pyx_1, __pyx_ptype_12spidermonkey_ProxyObject)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 869; goto __pyx_L2;}
    Py_DECREF(((PyObject *)__pyx_v_proxy_obj));
    __pyx_v_proxy_obj = ((struct __pyx_obj_12spidermonkey_ProxyObject *)__pyx_1);
    __pyx_1 = 0;

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":870 */
    __pyx_1 = PyString_FromString(JS_GetFunctionName(__pyx_v_func)); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 870; goto __pyx_L2;}
    Py_DECREF(__pyx_v_method_name);
    __pyx_v_method_name = __pyx_1;
    __pyx_1 = 0;

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":872 */
    __pyx_1 = PyList_New(0); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 872; goto __pyx_L2;}
    Py_DECREF(__pyx_v_py_args);
    __pyx_v_py_args = __pyx_1;
    __pyx_1 = 0;

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":873 */
    for (__pyx_v_arg = 0; __pyx_v_arg < __pyx_v_argc; ++__pyx_v_arg) {
      __pyx_1 = PyObject_GetAttr(__pyx_v_py_args, __pyx_n_append); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 874; goto __pyx_L2;}
      __pyx_2 = __pyx_f_12spidermonkey_Py_from_JS(__pyx_v_cx,(__pyx_v_argv[__pyx_v_arg])); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 874; goto __pyx_L2;}
      __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 874; goto __pyx_L2;}
      PyTuple_SET_ITEM(__pyx_3, 0, __pyx_2);
      __pyx_2 = 0;
      __pyx_2 = PyObject_CallObject(__pyx_1, __pyx_3); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 874; goto __pyx_L2;}
      Py_DECREF(__pyx_1); __pyx_1 = 0;
      Py_DECREF(__pyx_3); __pyx_3 = 0;
      Py_DECREF(__pyx_2); __pyx_2 = 0;
    }

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":875 */
    __pyx_1 = PyObject_GetAttr(__pyx_v_proxy_obj->obj,__pyx_v_method_name); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 875; goto __pyx_L2;}
    Py_DECREF(__pyx_v_meth);
    __pyx_v_meth = __pyx_1;
    __pyx_1 = 0;

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":876 */
    __pyx_3 = PySequence_Tuple(__pyx_v_py_args); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 876; goto __pyx_L2;}
    __pyx_2 = PyObject_CallObject(__pyx_v_meth, __pyx_3); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 876; goto __pyx_L2;}
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    Py_DECREF(__pyx_v_py_rval);
    __pyx_v_py_rval = __pyx_2;
    __pyx_2 = 0;

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":878 */
    __pyx_4 = __pyx_f_12spidermonkey_JS_from_Py(__pyx_v_cx,__pyx_v_obj,__pyx_v_py_rval); if (__pyx_4 == 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 878; goto __pyx_L2;}
    (__pyx_v_rval[0]) = __pyx_4;
  }
  goto __pyx_L3;
  __pyx_L2:;
  Py_XDECREF(__pyx_1); __pyx_1 = 0;
  Py_XDECREF(__pyx_3); __pyx_3 = 0;
  Py_XDECREF(__pyx_2); __pyx_2 = 0;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":879 */
  /*except:*/ {
    __Pyx_AddTraceback("spidermonkey.bound_method_cb");
    if (__Pyx_GetException(&__pyx_1, &__pyx_3, &__pyx_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 879; goto __pyx_L1;}
    __pyx_r = __pyx_f_12spidermonkey_report(__pyx_v_cx);
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    goto __pyx_L0;
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    goto __pyx_L3;
  }
  __pyx_L3:;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":882 */
  __pyx_r = JS_TRUE;
  goto __pyx_L0;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  __Pyx_WriteUnraisable("spidermonkey.bound_method_cb");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_context);
  Py_DECREF(__pyx_v_proxy_obj);
  Py_DECREF(__pyx_v_method_name);
  Py_DECREF(__pyx_v_py_args);
  Py_DECREF(__pyx_v_meth);
  Py_DECREF(__pyx_v_py_rval);
  return __pyx_r;
}

static __pyx_t_12spidermonkey_jsval __pyx_f_12spidermonkey_new_method(struct JSContext *__pyx_v_cx,PyObject *__pyx_v_py_method) {
  struct JSFunction *__pyx_v_method;
  struct JSObject *__pyx_v_method_obj;
  PyObject *__pyx_v_py_method_name;
  __pyx_t_12spidermonkey_jsval __pyx_r;
  PyObject *__pyx_1 = 0;
  char *__pyx_2;
  Py_INCREF(__pyx_v_py_method);
  __pyx_v_py_method_name = Py_None; Py_INCREF(Py_None);

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":895 */
  __pyx_1 = PyObject_GetAttr(__pyx_v_py_method, __pyx_n_func_name); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 895; goto __pyx_L1;}
  Py_DECREF(__pyx_v_py_method_name);
  __pyx_v_py_method_name = __pyx_1;
  __pyx_1 = 0;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":896 */
  __pyx_2 = PyString_AsString(__pyx_v_py_method_name); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 896; goto __pyx_L1;}
  __pyx_v_method = JS_NewFunction(__pyx_v_cx,__pyx_f_12spidermonkey_bound_method_cb,0,0,NULL,__pyx_2);

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":897 */
  __pyx_v_method_obj = JS_GetFunctionObject(__pyx_v_method);

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":898 */
  __pyx_r = OBJECT_TO_JSVAL(__pyx_v_method_obj);
  goto __pyx_L0;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  __Pyx_WriteUnraisable("spidermonkey.new_method");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_py_method_name);
  Py_DECREF(__pyx_v_py_method);
  return __pyx_r;
}

static __pyx_t_12spidermonkey_JSBool __pyx_f_12spidermonkey_resolve_global(struct JSContext *__pyx_v_cx,struct JSObject *__pyx_v_obj,__pyx_t_12spidermonkey_jsval __pyx_v_id) {
  struct __pyx_obj_12spidermonkey_Context *__pyx_v_context;
  struct __pyx_obj_12spidermonkey_ProxyObject *__pyx_v_proxy_obj;
  PyObject *__pyx_v_thing;
  PyObject *__pyx_v_key;
  PyObject *__pyx_v_attr;
  __pyx_t_12spidermonkey_JSBool __pyx_r;
  PyObject *__pyx_1 = 0;
  int __pyx_2;
  PyObject *__pyx_3 = 0;
  PyObject *__pyx_4 = 0;
  __pyx_v_context = ((struct __pyx_obj_12spidermonkey_Context *)Py_None); Py_INCREF(Py_None);
  __pyx_v_proxy_obj = ((struct __pyx_obj_12spidermonkey_ProxyObject *)Py_None); Py_INCREF(Py_None);
  __pyx_v_thing = Py_None; Py_INCREF(Py_None);
  __pyx_v_key = Py_None; Py_INCREF(Py_None);
  __pyx_v_attr = Py_None; Py_INCREF(Py_None);

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":907 */
  /*try:*/ {

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":908 */
    __pyx_1 = ((PyObject *)__pyx_f_12spidermonkey_get_context(__pyx_v_cx)); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 908; goto __pyx_L2;}
    Py_DECREF(((PyObject *)__pyx_v_context));
    __pyx_v_context = ((struct __pyx_obj_12spidermonkey_Context *)__pyx_1);
    __pyx_1 = 0;

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":910 */
    __pyx_1 = __pyx_f_12spidermonkey_context_get_object(__pyx_v_context,__pyx_v_obj); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 910; goto __pyx_L2;}
    if (!__Pyx_TypeTest(__pyx_1, __pyx_ptype_12spidermonkey_ProxyObject)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 910; goto __pyx_L2;}
    Py_DECREF(((PyObject *)__pyx_v_proxy_obj));
    __pyx_v_proxy_obj = ((struct __pyx_obj_12spidermonkey_ProxyObject *)__pyx_1);
    __pyx_1 = 0;

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":912 */
    Py_INCREF(__pyx_v_proxy_obj->obj);
    Py_DECREF(__pyx_v_thing);
    __pyx_v_thing = __pyx_v_proxy_obj->obj;

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":913 */
    __pyx_1 = __pyx_f_12spidermonkey_Py_from_JS(__pyx_v_cx,__pyx_v_id); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 913; goto __pyx_L2;}
    Py_DECREF(__pyx_v_key);
    __pyx_v_key = __pyx_1;
    __pyx_1 = 0;

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":914 */
    __pyx_1 = PyTuple_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 914; goto __pyx_L2;}
    Py_INCREF(__pyx_v_key);
    PyTuple_SET_ITEM(__pyx_1, 0, __pyx_v_key);
    __pyx_3 = PyObject_CallObject(((PyObject *)(&PyType_Type)), __pyx_1); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 914; goto __pyx_L2;}
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_StringType); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 914; goto __pyx_L2;}
    if (PyObject_Cmp(__pyx_3, __pyx_1, &__pyx_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 914; goto __pyx_L2;}
    __pyx_2 = __pyx_2 == 0;
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    if (__pyx_2) {
      __pyx_2 = PyObject_HasAttr(__pyx_v_thing,__pyx_v_key); if (__pyx_2 == -1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 914; goto __pyx_L2;}
    }
    if (__pyx_2) {

      /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":915 */
      __pyx_3 = PyObject_GetAttr(__pyx_v_thing,__pyx_v_key); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 915; goto __pyx_L2;}
      Py_DECREF(__pyx_v_attr);
      __pyx_v_attr = __pyx_3;
      __pyx_3 = 0;

      /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":916 */
      __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_compat_isinstance); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 916; goto __pyx_L2;}
      __pyx_3 = __Pyx_GetName(__pyx_m, __pyx_n_MethodType); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 916; goto __pyx_L2;}
      __pyx_4 = PyTuple_New(2); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 916; goto __pyx_L2;}
      Py_INCREF(__pyx_v_attr);
      PyTuple_SET_ITEM(__pyx_4, 0, __pyx_v_attr);
      PyTuple_SET_ITEM(__pyx_4, 1, __pyx_3);
      __pyx_3 = 0;
      __pyx_3 = PyObject_CallObject(__pyx_1, __pyx_4); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 916; goto __pyx_L2;}
      Py_DECREF(__pyx_1); __pyx_1 = 0;
      Py_DECREF(__pyx_4); __pyx_4 = 0;
      __pyx_2 = PyObject_IsTrue(__pyx_3); if (__pyx_2 < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 916; goto __pyx_L2;}
      Py_DECREF(__pyx_3); __pyx_3 = 0;
      if (__pyx_2) {
        __pyx_1 = PyObject_GetAttr(((PyObject *)__pyx_v_context), __pyx_n_bind_callable); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 917; goto __pyx_L2;}
        __pyx_4 = PyTuple_New(2); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 917; goto __pyx_L2;}
        Py_INCREF(__pyx_v_key);
        PyTuple_SET_ITEM(__pyx_4, 0, __pyx_v_key);
        Py_INCREF(__pyx_v_attr);
        PyTuple_SET_ITEM(__pyx_4, 1, __pyx_v_attr);
        __pyx_3 = PyObject_CallObject(__pyx_1, __pyx_4); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 917; goto __pyx_L2;}
        Py_DECREF(__pyx_1); __pyx_1 = 0;
        Py_DECREF(__pyx_4); __pyx_4 = 0;
        Py_DECREF(__pyx_3); __pyx_3 = 0;
        goto __pyx_L5;
      }
      /*else*/ {
        __pyx_1 = PyObject_GetAttr(((PyObject *)__pyx_v_context), __pyx_n_bind_attribute); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 919; goto __pyx_L2;}
        __pyx_4 = PyTuple_New(3); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 919; goto __pyx_L2;}
        Py_INCREF(__pyx_v_key);
        PyTuple_SET_ITEM(__pyx_4, 0, __pyx_v_key);
        Py_INCREF(__pyx_v_thing);
        PyTuple_SET_ITEM(__pyx_4, 1, __pyx_v_thing);
        Py_INCREF(__pyx_v_key);
        PyTuple_SET_ITEM(__pyx_4, 2, __pyx_v_key);
        __pyx_3 = PyObject_CallObject(__pyx_1, __pyx_4); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 919; goto __pyx_L2;}
        Py_DECREF(__pyx_1); __pyx_1 = 0;
        Py_DECREF(__pyx_4); __pyx_4 = 0;
        Py_DECREF(__pyx_3); __pyx_3 = 0;
      }
      __pyx_L5:;
      goto __pyx_L4;
    }
    __pyx_L4:;

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":920 */
    __pyx_r = JS_TRUE;
    goto __pyx_L0;
  }
  goto __pyx_L3;
  __pyx_L2:;
  Py_XDECREF(__pyx_1); __pyx_1 = 0;
  Py_XDECREF(__pyx_4); __pyx_4 = 0;
  Py_XDECREF(__pyx_3); __pyx_3 = 0;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":921 */
  /*except:*/ {
    __Pyx_AddTraceback("spidermonkey.resolve_global");
    if (__Pyx_GetException(&__pyx_1, &__pyx_4, &__pyx_3) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 921; goto __pyx_L1;}
    __pyx_r = __pyx_f_12spidermonkey_report(__pyx_v_cx);
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    Py_DECREF(__pyx_4); __pyx_4 = 0;
    goto __pyx_L0;
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    Py_DECREF(__pyx_4); __pyx_4 = 0;
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    goto __pyx_L3;
  }
  __pyx_L3:;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":923 */
  __pyx_r = JS_FALSE;
  goto __pyx_L0;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_3);
  Py_XDECREF(__pyx_4);
  __Pyx_WriteUnraisable("spidermonkey.resolve_global");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_context);
  Py_DECREF(__pyx_v_proxy_obj);
  Py_DECREF(__pyx_v_thing);
  Py_DECREF(__pyx_v_key);
  Py_DECREF(__pyx_v_attr);
  return __pyx_r;
}

static void __pyx_f_12spidermonkey_finalize(struct JSContext *__pyx_v_cx,struct JSObject *__pyx_v_obj) {
  struct __pyx_obj_12spidermonkey_Context *__pyx_v_context;
  struct __pyx_obj_12spidermonkey_ProxyObject *__pyx_v_proxy_obj;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  __pyx_v_context = ((struct __pyx_obj_12spidermonkey_Context *)Py_None); Py_INCREF(Py_None);
  __pyx_v_proxy_obj = ((struct __pyx_obj_12spidermonkey_ProxyObject *)Py_None); Py_INCREF(Py_None);

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":930 */
  /*try:*/ {

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":931 */
    __pyx_1 = ((PyObject *)__pyx_f_12spidermonkey_get_context(__pyx_v_cx)); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 931; goto __pyx_L2;}
    Py_DECREF(((PyObject *)__pyx_v_context));
    __pyx_v_context = ((struct __pyx_obj_12spidermonkey_Context *)__pyx_1);
    __pyx_1 = 0;

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":932 */
    __pyx_1 = __pyx_f_12spidermonkey_context_get_object(__pyx_v_context,__pyx_v_obj); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 932; goto __pyx_L2;}
    if (!__Pyx_TypeTest(__pyx_1, __pyx_ptype_12spidermonkey_ProxyObject)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 932; goto __pyx_L2;}
    Py_DECREF(((PyObject *)__pyx_v_proxy_obj));
    __pyx_v_proxy_obj = ((struct __pyx_obj_12spidermonkey_ProxyObject *)__pyx_1);
    __pyx_1 = 0;

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":933 */
    __pyx_f_12spidermonkey_context_remove_object(__pyx_v_context,__pyx_v_proxy_obj);
  }
  goto __pyx_L3;
  __pyx_L2:;
  Py_XDECREF(__pyx_1); __pyx_1 = 0;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":934 */
  /*except:*/ {
    __Pyx_AddTraceback("spidermonkey.finalize");
    if (__Pyx_GetException(&__pyx_1, &__pyx_2, &__pyx_3) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 934; goto __pyx_L1;}
    __pyx_f_12spidermonkey_report(__pyx_v_cx);
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    goto __pyx_L3;
  }
  __pyx_L3:;

  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  __Pyx_WriteUnraisable("spidermonkey.finalize");
  __pyx_L0:;
  Py_DECREF(__pyx_v_context);
  Py_DECREF(__pyx_v_proxy_obj);
}

static __pyx_t_12spidermonkey_JSBool __pyx_f_12spidermonkey_get_property(struct JSContext *__pyx_v_cx,struct JSObject *__pyx_v_obj,__pyx_t_12spidermonkey_jsval __pyx_v_id,__pyx_t_12spidermonkey_jsval *__pyx_v_vp) {
  struct __pyx_obj_12spidermonkey_Context *__pyx_v_context;
  struct __pyx_obj_12spidermonkey_ProxyObject *__pyx_v_proxy_obj;
  PyObject *__pyx_v_thing;
  PyObject *__pyx_v_key;
  PyObject *__pyx_v_attr;
  __pyx_t_12spidermonkey_JSBool __pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  int __pyx_3;
  PyObject *__pyx_4 = 0;
  __pyx_t_12spidermonkey_jsval __pyx_5;
  int __pyx_6;
  __pyx_v_context = ((struct __pyx_obj_12spidermonkey_Context *)Py_None); Py_INCREF(Py_None);
  __pyx_v_proxy_obj = ((struct __pyx_obj_12spidermonkey_ProxyObject *)Py_None); Py_INCREF(Py_None);
  __pyx_v_thing = Py_None; Py_INCREF(Py_None);
  __pyx_v_key = Py_None; Py_INCREF(Py_None);
  __pyx_v_attr = Py_None; Py_INCREF(Py_None);

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":944 */
  /*try:*/ {

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":945 */
    __pyx_1 = ((PyObject *)__pyx_f_12spidermonkey_get_context(__pyx_v_cx)); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 945; goto __pyx_L2;}
    Py_DECREF(((PyObject *)__pyx_v_context));
    __pyx_v_context = ((struct __pyx_obj_12spidermonkey_Context *)__pyx_1);
    __pyx_1 = 0;

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":946 */
    __pyx_1 = __pyx_f_12spidermonkey_context_get_object(__pyx_v_context,__pyx_v_obj); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 946; goto __pyx_L2;}
    if (!__Pyx_TypeTest(__pyx_1, __pyx_ptype_12spidermonkey_ProxyObject)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 946; goto __pyx_L2;}
    Py_DECREF(((PyObject *)__pyx_v_proxy_obj));
    __pyx_v_proxy_obj = ((struct __pyx_obj_12spidermonkey_ProxyObject *)__pyx_1);
    __pyx_1 = 0;

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":948 */
    Py_INCREF(__pyx_v_proxy_obj->obj);
    Py_DECREF(__pyx_v_thing);
    __pyx_v_thing = __pyx_v_proxy_obj->obj;

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":949 */
    __pyx_1 = __pyx_f_12spidermonkey_Py_from_JS(__pyx_v_cx,__pyx_v_id); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 949; goto __pyx_L2;}
    Py_DECREF(__pyx_v_key);
    __pyx_v_key = __pyx_1;
    __pyx_1 = 0;

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":951 */
    __pyx_1 = PyTuple_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 951; goto __pyx_L2;}
    Py_INCREF(__pyx_v_key);
    PyTuple_SET_ITEM(__pyx_1, 0, __pyx_v_key);
    __pyx_2 = PyObject_CallObject(((PyObject *)(&PyType_Type)), __pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 951; goto __pyx_L2;}
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_IntType); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 951; goto __pyx_L2;}
    if (PyObject_Cmp(__pyx_2, __pyx_1, &__pyx_3) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 951; goto __pyx_L2;}
    __pyx_3 = __pyx_3 == 0;
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    if (__pyx_3) {
      /*try:*/ {
        __pyx_2 = PyObject_GetItem(__pyx_v_thing, __pyx_v_key); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 953; goto __pyx_L5;}
        Py_DECREF(__pyx_v_attr);
        __pyx_v_attr = __pyx_2;
        __pyx_2 = 0;
      }
      /*else:*/ {
        __pyx_5 = __pyx_f_12spidermonkey_JS_from_Py(__pyx_v_cx,__pyx_v_obj,__pyx_v_attr); if (__pyx_5 == 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 957; goto __pyx_L2;}
        (__pyx_v_vp[0]) = __pyx_5;
      }
      goto __pyx_L6;
      __pyx_L5:;
      Py_XDECREF(__pyx_1); __pyx_1 = 0;
      Py_XDECREF(__pyx_2); __pyx_2 = 0;

      /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":954 */
      /*except:*/ {
        __Pyx_AddTraceback("spidermonkey.get_property");
        if (__Pyx_GetException(&__pyx_1, &__pyx_2, &__pyx_4) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 954; goto __pyx_L2;}
        Py_DECREF(__pyx_1); __pyx_1 = 0;
        Py_DECREF(__pyx_2); __pyx_2 = 0;
        Py_DECREF(__pyx_4); __pyx_4 = 0;
        goto __pyx_L6;
      }
      __pyx_L6:;
      goto __pyx_L4;
    }
    __pyx_1 = PyTuple_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 958; goto __pyx_L2;}
    Py_INCREF(__pyx_v_key);
    PyTuple_SET_ITEM(__pyx_1, 0, __pyx_v_key);
    __pyx_2 = PyObject_CallObject(((PyObject *)(&PyType_Type)), __pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 958; goto __pyx_L2;}
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    __pyx_4 = __Pyx_GetName(__pyx_m, __pyx_n_StringType); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 958; goto __pyx_L2;}
    if (PyObject_Cmp(__pyx_2, __pyx_4, &__pyx_3) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 958; goto __pyx_L2;}
    __pyx_3 = __pyx_3 == 0;
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    Py_DECREF(__pyx_4); __pyx_4 = 0;
    if (__pyx_3) {
      __pyx_1 = PyObject_GetAttr(__pyx_v_key, __pyx_n_startswith); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 959; goto __pyx_L2;}
      __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 959; goto __pyx_L2;}
      Py_INCREF(__pyx_n__);
      PyTuple_SET_ITEM(__pyx_2, 0, __pyx_n__);
      __pyx_4 = PyObject_CallObject(__pyx_1, __pyx_2); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 959; goto __pyx_L2;}
      Py_DECREF(__pyx_1); __pyx_1 = 0;
      Py_DECREF(__pyx_2); __pyx_2 = 0;
      __pyx_3 = PyObject_IsTrue(__pyx_4); if (__pyx_3 < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 959; goto __pyx_L2;}
      Py_DECREF(__pyx_4); __pyx_4 = 0;
      __pyx_6 = (!__pyx_3);
      if (__pyx_6) {
        /*try:*/ {
          __pyx_1 = PyObject_GetAttr(__pyx_v_thing,__pyx_v_key); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 961; goto __pyx_L8;}
          Py_DECREF(__pyx_v_attr);
          __pyx_v_attr = __pyx_1;
          __pyx_1 = 0;
        }
        /*else:*/ {
          __pyx_5 = __pyx_f_12spidermonkey_JS_from_Py(__pyx_v_cx,__pyx_v_obj,__pyx_v_attr); if (__pyx_5 == 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 965; goto __pyx_L2;}
          (__pyx_v_vp[0]) = __pyx_5;
        }
        goto __pyx_L9;
        __pyx_L8:;
        Py_XDECREF(__pyx_2); __pyx_2 = 0;
        Py_XDECREF(__pyx_4); __pyx_4 = 0;
        Py_XDECREF(__pyx_1); __pyx_1 = 0;

        /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":962 */
        /*except:*/ {
          __Pyx_AddTraceback("spidermonkey.get_property");
          if (__Pyx_GetException(&__pyx_2, &__pyx_4, &__pyx_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 962; goto __pyx_L2;}
          Py_DECREF(__pyx_2); __pyx_2 = 0;
          Py_DECREF(__pyx_4); __pyx_4 = 0;
          Py_DECREF(__pyx_1); __pyx_1 = 0;
          goto __pyx_L9;
        }
        __pyx_L9:;
        goto __pyx_L7;
      }
      __pyx_L7:;
      goto __pyx_L4;
    }
    __pyx_3 = __pyx_v_key == Py_None;
    if (__pyx_3) {
      (__pyx_v_vp[0]) = JSVAL_VOID;
      goto __pyx_L4;
    }
    /*else*/ {
      __pyx_2 = PyNumber_Remainder(__pyx_k76p, __pyx_v_key); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 971; goto __pyx_L2;}
      __pyx_4 = PyTuple_New(1); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 971; goto __pyx_L2;}
      PyTuple_SET_ITEM(__pyx_4, 0, __pyx_2);
      __pyx_2 = 0;
      __pyx_1 = PyObject_CallObject(PyExc_AssertionError, __pyx_4); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 971; goto __pyx_L2;}
      Py_DECREF(__pyx_4); __pyx_4 = 0;
      __Pyx_Raise(__pyx_1, 0, 0);
      Py_DECREF(__pyx_1); __pyx_1 = 0;
      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 971; goto __pyx_L2;}
    }
    __pyx_L4:;

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":972 */
    __pyx_r = JS_TRUE;
    goto __pyx_L0;
  }
  goto __pyx_L3;
  __pyx_L2:;
  Py_XDECREF(__pyx_2); __pyx_2 = 0;
  Py_XDECREF(__pyx_4); __pyx_4 = 0;
  Py_XDECREF(__pyx_1); __pyx_1 = 0;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":973 */
  /*except:*/ {
    __Pyx_AddTraceback("spidermonkey.get_property");
    if (__Pyx_GetException(&__pyx_2, &__pyx_4, &__pyx_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 973; goto __pyx_L1;}
    __pyx_r = __pyx_f_12spidermonkey_report(__pyx_v_cx);
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    Py_DECREF(__pyx_4); __pyx_4 = 0;
    goto __pyx_L0;
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    Py_DECREF(__pyx_4); __pyx_4 = 0;
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    goto __pyx_L3;
  }
  __pyx_L3:;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":975 */
  __pyx_r = JS_FALSE;
  goto __pyx_L0;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_4);
  __Pyx_WriteUnraisable("spidermonkey.get_property");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_context);
  Py_DECREF(__pyx_v_proxy_obj);
  Py_DECREF(__pyx_v_thing);
  Py_DECREF(__pyx_v_key);
  Py_DECREF(__pyx_v_attr);
  return __pyx_r;
}

static __pyx_t_12spidermonkey_JSBool __pyx_f_12spidermonkey_set_property(struct JSContext *__pyx_v_cx,struct JSObject *__pyx_v_obj,__pyx_t_12spidermonkey_jsval __pyx_v_id,__pyx_t_12spidermonkey_jsval *__pyx_v_vp) {
  struct __pyx_obj_12spidermonkey_Context *__pyx_v_context;
  struct __pyx_obj_12spidermonkey_ProxyObject *__pyx_v_proxy_obj;
  PyObject *__pyx_v_thing;
  PyObject *__pyx_v_key;
  PyObject *__pyx_v_value;
  PyObject *__pyx_v_attr;
  __pyx_t_12spidermonkey_JSBool __pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  int __pyx_3;
  PyObject *__pyx_4 = 0;
  int __pyx_5;
  int __pyx_6;
  __pyx_v_context = ((struct __pyx_obj_12spidermonkey_Context *)Py_None); Py_INCREF(Py_None);
  __pyx_v_proxy_obj = ((struct __pyx_obj_12spidermonkey_ProxyObject *)Py_None); Py_INCREF(Py_None);
  __pyx_v_thing = Py_None; Py_INCREF(Py_None);
  __pyx_v_key = Py_None; Py_INCREF(Py_None);
  __pyx_v_value = Py_None; Py_INCREF(Py_None);
  __pyx_v_attr = Py_None; Py_INCREF(Py_None);

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":985 */
  /*try:*/ {

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":986 */
    __pyx_1 = ((PyObject *)__pyx_f_12spidermonkey_get_context(__pyx_v_cx)); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 986; goto __pyx_L2;}
    Py_DECREF(((PyObject *)__pyx_v_context));
    __pyx_v_context = ((struct __pyx_obj_12spidermonkey_Context *)__pyx_1);
    __pyx_1 = 0;

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":987 */
    __pyx_1 = __pyx_f_12spidermonkey_context_get_object(__pyx_v_context,__pyx_v_obj); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 987; goto __pyx_L2;}
    if (!__Pyx_TypeTest(__pyx_1, __pyx_ptype_12spidermonkey_ProxyObject)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 987; goto __pyx_L2;}
    Py_DECREF(((PyObject *)__pyx_v_proxy_obj));
    __pyx_v_proxy_obj = ((struct __pyx_obj_12spidermonkey_ProxyObject *)__pyx_1);
    __pyx_1 = 0;

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":989 */
    Py_INCREF(__pyx_v_proxy_obj->obj);
    Py_DECREF(__pyx_v_thing);
    __pyx_v_thing = __pyx_v_proxy_obj->obj;

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":990 */
    __pyx_1 = __pyx_f_12spidermonkey_Py_from_JS(__pyx_v_cx,__pyx_v_id); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 990; goto __pyx_L2;}
    Py_DECREF(__pyx_v_key);
    __pyx_v_key = __pyx_1;
    __pyx_1 = 0;

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":991 */
    __pyx_1 = __pyx_f_12spidermonkey_Py_from_JS(__pyx_v_cx,(__pyx_v_vp[0])); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 991; goto __pyx_L2;}
    Py_DECREF(__pyx_v_value);
    __pyx_v_value = __pyx_1;
    __pyx_1 = 0;

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":992 */
    __pyx_1 = PyTuple_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 992; goto __pyx_L2;}
    Py_INCREF(__pyx_v_key);
    PyTuple_SET_ITEM(__pyx_1, 0, __pyx_v_key);
    __pyx_2 = PyObject_CallObject(((PyObject *)(&PyType_Type)), __pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 992; goto __pyx_L2;}
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_IntType); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 992; goto __pyx_L2;}
    if (PyObject_Cmp(__pyx_2, __pyx_1, &__pyx_3) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 992; goto __pyx_L2;}
    __pyx_3 = __pyx_3 == 0;
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    if (__pyx_3) {
      /*try:*/ {
        if (PyObject_SetItem(__pyx_v_thing, __pyx_v_key, __pyx_v_value) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 994; goto __pyx_L5;}
      }
      goto __pyx_L6;
      __pyx_L5:;
      Py_XDECREF(__pyx_2); __pyx_2 = 0;
      Py_XDECREF(__pyx_1); __pyx_1 = 0;

      /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":995 */
      /*except:*/ {
        __Pyx_AddTraceback("spidermonkey.set_property");
        if (__Pyx_GetException(&__pyx_2, &__pyx_1, &__pyx_4) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 995; goto __pyx_L2;}
        Py_DECREF(__pyx_2); __pyx_2 = 0;
        Py_DECREF(__pyx_1); __pyx_1 = 0;
        Py_DECREF(__pyx_4); __pyx_4 = 0;
        goto __pyx_L6;
      }
      __pyx_L6:;
      goto __pyx_L4;
    }
    __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 997; goto __pyx_L2;}
    Py_INCREF(__pyx_v_key);
    PyTuple_SET_ITEM(__pyx_2, 0, __pyx_v_key);
    __pyx_1 = PyObject_CallObject(((PyObject *)(&PyType_Type)), __pyx_2); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 997; goto __pyx_L2;}
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    __pyx_4 = __Pyx_GetName(__pyx_m, __pyx_n_StringType); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 997; goto __pyx_L2;}
    if (PyObject_Cmp(__pyx_1, __pyx_4, &__pyx_3) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 997; goto __pyx_L2;}
    __pyx_3 = __pyx_3 == 0;
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    Py_DECREF(__pyx_4); __pyx_4 = 0;
    if (__pyx_3) {
      __pyx_3 = PyObject_HasAttr(__pyx_v_thing,__pyx_v_key); if (__pyx_3 == -1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 998; goto __pyx_L2;}
      if (__pyx_3) {
        __pyx_2 = PyObject_GetAttr(__pyx_v_key, __pyx_n_startswith); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 998; goto __pyx_L2;}
        __pyx_1 = PyTuple_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 998; goto __pyx_L2;}
        Py_INCREF(__pyx_n__);
        PyTuple_SET_ITEM(__pyx_1, 0, __pyx_n__);
        __pyx_4 = PyObject_CallObject(__pyx_2, __pyx_1); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 998; goto __pyx_L2;}
        Py_DECREF(__pyx_2); __pyx_2 = 0;
        Py_DECREF(__pyx_1); __pyx_1 = 0;
        __pyx_5 = PyObject_IsTrue(__pyx_4); if (__pyx_5 < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 998; goto __pyx_L2;}
        Py_DECREF(__pyx_4); __pyx_4 = 0;
        __pyx_3 = (!__pyx_5);
      }
      if (__pyx_3) {

        /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":999 */
        __pyx_2 = PyObject_GetAttr(__pyx_v_thing,__pyx_v_key); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 999; goto __pyx_L2;}
        Py_DECREF(__pyx_v_attr);
        __pyx_v_attr = __pyx_2;
        __pyx_2 = 0;

        /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":1000 */
        __pyx_1 = __Pyx_GetName(__pyx_b, __pyx_n_callable); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1000; goto __pyx_L2;}
        __pyx_4 = PyTuple_New(1); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1000; goto __pyx_L2;}
        Py_INCREF(__pyx_v_attr);
        PyTuple_SET_ITEM(__pyx_4, 0, __pyx_v_attr);
        __pyx_2 = PyObject_CallObject(__pyx_1, __pyx_4); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1000; goto __pyx_L2;}
        Py_DECREF(__pyx_1); __pyx_1 = 0;
        Py_DECREF(__pyx_4); __pyx_4 = 0;
        __pyx_5 = PyObject_IsTrue(__pyx_2); if (__pyx_5 < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1000; goto __pyx_L2;}
        Py_DECREF(__pyx_2); __pyx_2 = 0;
        __pyx_3 = (!__pyx_5);
        if (__pyx_3) {
          /*try:*/ {
            __pyx_6 = PyObject_SetAttr(__pyx_v_thing,__pyx_v_key,__pyx_v_value); if (__pyx_6 == -1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1002; goto __pyx_L9;}
          }
          goto __pyx_L10;
          __pyx_L9:;
          Py_XDECREF(__pyx_1); __pyx_1 = 0;
          Py_XDECREF(__pyx_4); __pyx_4 = 0;
          Py_XDECREF(__pyx_2); __pyx_2 = 0;

          /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":1003 */
          /*except:*/ {
            __Pyx_AddTraceback("spidermonkey.set_property");
            if (__Pyx_GetException(&__pyx_1, &__pyx_4, &__pyx_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1003; goto __pyx_L2;}
            Py_DECREF(__pyx_1); __pyx_1 = 0;
            Py_DECREF(__pyx_4); __pyx_4 = 0;
            Py_DECREF(__pyx_2); __pyx_2 = 0;
            goto __pyx_L10;
          }
          __pyx_L10:;
          goto __pyx_L8;
        }
        __pyx_L8:;
        goto __pyx_L7;
      }
      __pyx_L7:;
      goto __pyx_L4;
    }
    /*else*/ {
      __pyx_1 = PyNumber_Remainder(__pyx_k77p, __pyx_v_key); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1006; goto __pyx_L2;}
      __pyx_4 = PyTuple_New(1); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1006; goto __pyx_L2;}
      PyTuple_SET_ITEM(__pyx_4, 0, __pyx_1);
      __pyx_1 = 0;
      __pyx_2 = PyObject_CallObject(PyExc_AssertionError, __pyx_4); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1006; goto __pyx_L2;}
      Py_DECREF(__pyx_4); __pyx_4 = 0;
      __Pyx_Raise(__pyx_2, 0, 0);
      Py_DECREF(__pyx_2); __pyx_2 = 0;
      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1006; goto __pyx_L2;}
    }
    __pyx_L4:;

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":1007 */
    __pyx_r = JS_TRUE;
    goto __pyx_L0;
  }
  goto __pyx_L3;
  __pyx_L2:;
  Py_XDECREF(__pyx_1); __pyx_1 = 0;
  Py_XDECREF(__pyx_4); __pyx_4 = 0;
  Py_XDECREF(__pyx_2); __pyx_2 = 0;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":1008 */
  /*except:*/ {
    __Pyx_AddTraceback("spidermonkey.set_property");
    if (__Pyx_GetException(&__pyx_1, &__pyx_4, &__pyx_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1008; goto __pyx_L1;}
    __pyx_r = __pyx_f_12spidermonkey_report(__pyx_v_cx);
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    Py_DECREF(__pyx_4); __pyx_4 = 0;
    goto __pyx_L0;
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    Py_DECREF(__pyx_4); __pyx_4 = 0;
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    goto __pyx_L3;
  }
  __pyx_L3:;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":1011 */
  __pyx_r = JS_FALSE;
  goto __pyx_L0;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_4);
  __Pyx_WriteUnraisable("spidermonkey.set_property");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_context);
  Py_DECREF(__pyx_v_proxy_obj);
  Py_DECREF(__pyx_v_thing);
  Py_DECREF(__pyx_v_key);
  Py_DECREF(__pyx_v_value);
  Py_DECREF(__pyx_v_attr);
  return __pyx_r;
}

static __pyx_t_12spidermonkey_JSBool __pyx_f_12spidermonkey_function_cb(struct JSContext *__pyx_v_cx,struct JSObject *__pyx_v_obj,__pyx_t_12spidermonkey_uintN __pyx_v_argc,__pyx_t_12spidermonkey_jsval *__pyx_v_argv,__pyx_t_12spidermonkey_jsval *__pyx_v_rval) {
  struct JSFunction *__pyx_v_jsfunc;
  int __pyx_v_i;
  char *__pyx_v_name;
  PyObject *__pyx_v_context;
  PyObject *__pyx_v_callback;
  PyObject *__pyx_v_args;
  PyObject *__pyx_v_pyrval;
  __pyx_t_12spidermonkey_JSBool __pyx_r;
  int __pyx_1;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  PyObject *__pyx_4 = 0;
  __pyx_t_12spidermonkey_jsval __pyx_5;
  __pyx_v_context = Py_None; Py_INCREF(Py_None);
  __pyx_v_callback = Py_None; Py_INCREF(Py_None);
  __pyx_v_args = Py_None; Py_INCREF(Py_None);
  __pyx_v_pyrval = Py_None; Py_INCREF(Py_None);

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":1020 */
  __pyx_v_jsfunc = JS_ValueToFunction(__pyx_v_cx,(__pyx_v_argv[(-2)]));

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":1021 */
  __pyx_1 = (__pyx_v_jsfunc == NULL);
  if (__pyx_1) {
    __pyx_r = JS_FALSE;
    goto __pyx_L0;
    goto __pyx_L2;
  }
  __pyx_L2:;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":1023 */
  __pyx_v_name = JS_GetFunctionName(__pyx_v_jsfunc);

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":1024 */
  __pyx_1 = (__pyx_v_name == NULL);
  if (__pyx_1) {
    __pyx_r = JS_FALSE;
    goto __pyx_L0;
    goto __pyx_L3;
  }
  __pyx_L3:;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":1027 */
  /*try:*/ {

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":1028 */
    __pyx_2 = ((PyObject *)__pyx_f_12spidermonkey_get_context(__pyx_v_cx)); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1028; goto __pyx_L4;}
    Py_DECREF(__pyx_v_context);
    __pyx_v_context = __pyx_2;
    __pyx_2 = 0;

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":1029 */
    if (!__Pyx_TypeTest(__pyx_v_context, __pyx_ptype_12spidermonkey_Context)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1029; goto __pyx_L4;}
    __pyx_2 = PyString_FromString(__pyx_v_name); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1029; goto __pyx_L4;}
    __pyx_3 = __pyx_f_12spidermonkey_context_get_callback_fn(((struct __pyx_obj_12spidermonkey_Context *)__pyx_v_context),__pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1029; goto __pyx_L4;}
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    Py_DECREF(__pyx_v_callback);
    __pyx_v_callback = __pyx_3;
    __pyx_3 = 0;

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":1031 */
    __pyx_2 = PyList_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1031; goto __pyx_L4;}
    Py_INCREF(Py_None);
    PyList_SET_ITEM(__pyx_2, 0, Py_None);
    __pyx_3 = PyInt_FromLong(__pyx_v_argc); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1031; goto __pyx_L4;}
    __pyx_4 = PyNumber_Multiply(__pyx_2, __pyx_3); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1031; goto __pyx_L4;}
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    Py_DECREF(__pyx_v_args);
    __pyx_v_args = __pyx_4;
    __pyx_4 = 0;

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":1032 */
    for (__pyx_v_i = 0; __pyx_v_i < __pyx_v_argc; ++__pyx_v_i) {
      __pyx_2 = __pyx_f_12spidermonkey_Py_from_JS(__pyx_v_cx,(__pyx_v_argv[__pyx_v_i])); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1033; goto __pyx_L4;}
      if (__Pyx_SetItemInt(__pyx_v_args, __pyx_v_i, __pyx_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1033; goto __pyx_L4;}
      Py_DECREF(__pyx_2); __pyx_2 = 0;
    }

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":1034 */
    __pyx_3 = PySequence_Tuple(__pyx_v_args); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1034; goto __pyx_L4;}
    __pyx_4 = PyObject_CallObject(__pyx_v_callback, __pyx_3); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1034; goto __pyx_L4;}
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    Py_DECREF(__pyx_v_pyrval);
    __pyx_v_pyrval = __pyx_4;
    __pyx_4 = 0;

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":1037 */
    __pyx_5 = __pyx_f_12spidermonkey_JS_from_Py(__pyx_v_cx,NULL,__pyx_v_pyrval); if (__pyx_5 == 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1037; goto __pyx_L4;}
    (__pyx_v_rval[0]) = __pyx_5;
  }
  goto __pyx_L5;
  __pyx_L4:;
  Py_XDECREF(__pyx_2); __pyx_2 = 0;
  Py_XDECREF(__pyx_3); __pyx_3 = 0;
  Py_XDECREF(__pyx_4); __pyx_4 = 0;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":1038 */
  /*except:*/ {
    __Pyx_AddTraceback("spidermonkey.function_cb");
    if (__Pyx_GetException(&__pyx_2, &__pyx_3, &__pyx_4) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1038; goto __pyx_L1;}
    __pyx_r = __pyx_f_12spidermonkey_report(__pyx_v_cx);
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    Py_DECREF(__pyx_4); __pyx_4 = 0;
    goto __pyx_L0;
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    Py_DECREF(__pyx_4); __pyx_4 = 0;
    goto __pyx_L5;
  }
  __pyx_L5:;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":1041 */
  __pyx_r = JS_TRUE;
  goto __pyx_L0;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  Py_XDECREF(__pyx_4);
  __Pyx_WriteUnraisable("spidermonkey.function_cb");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_context);
  Py_DECREF(__pyx_v_callback);
  Py_DECREF(__pyx_v_args);
  Py_DECREF(__pyx_v_pyrval);
  return __pyx_r;
}

static __pyx_t_12spidermonkey_jsval __pyx_f_12spidermonkey_JS_from_Py(struct JSContext *__pyx_v_cx,struct JSObject *__pyx_v_parent,PyObject *__pyx_v_py_obj) {
  struct JSObject *__pyx_v_jsobj;
  struct JSString *__pyx_v_s;
  __pyx_t_12spidermonkey_jsval __pyx_v_elem;
  __pyx_t_12spidermonkey_jsval __pyx_v_rval;
  int __pyx_v_i;
  struct JSObject *__pyx_v_arr_obj;
  struct __pyx_obj_12spidermonkey_Context *__pyx_v_context;
  struct __pyx_obj_12spidermonkey_ProxyClass *__pyx_v_proxy_class;
  struct __pyx_obj_12spidermonkey_ProxyObject *__pyx_v_proxy_obj;
  PyObject *__pyx_v_key;
  PyObject *__pyx_v_value;
  PyObject *__pyx_v_ok;
  __pyx_t_12spidermonkey_jsval __pyx_r;
  int __pyx_1;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  PyObject *__pyx_4 = 0;
  __pyx_t_12spidermonkey_jsdouble __pyx_5;
  char *__pyx_6;
  Py_ssize_t __pyx_7;
  __pyx_t_12spidermonkey_jsval __pyx_8;
  int __pyx_9;
  PyObject *__pyx_10 = 0;
  PyObject *__pyx_11 = 0;
  PyObject *__pyx_12 = 0;
  Py_INCREF(__pyx_v_py_obj);
  __pyx_v_context = ((struct __pyx_obj_12spidermonkey_Context *)Py_None); Py_INCREF(Py_None);
  __pyx_v_proxy_class = ((struct __pyx_obj_12spidermonkey_ProxyClass *)Py_None); Py_INCREF(Py_None);
  __pyx_v_proxy_obj = ((struct __pyx_obj_12spidermonkey_ProxyObject *)Py_None); Py_INCREF(Py_None);
  __pyx_v_key = Py_None; Py_INCREF(Py_None);
  __pyx_v_value = Py_None; Py_INCREF(Py_None);
  __pyx_v_ok = Py_None; Py_INCREF(Py_None);

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":1061 */
  __pyx_1 = __pyx_v_py_obj == Py_None;
  if (__pyx_1) {
    __pyx_r = JSVAL_VOID;
    goto __pyx_L0;
    goto __pyx_L2;
  }
  __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_isinteger); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1063; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1063; goto __pyx_L1;}
  Py_INCREF(__pyx_v_py_obj);
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_v_py_obj);
  __pyx_4 = PyObject_CallObject(__pyx_2, __pyx_3); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1063; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  __pyx_1 = PyObject_IsTrue(__pyx_4); if (__pyx_1 < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1063; goto __pyx_L1;}
  Py_DECREF(__pyx_4); __pyx_4 = 0;
  if (__pyx_1) {
    __pyx_1 = PyInt_AsLong(__pyx_v_py_obj); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1064; goto __pyx_L1;}
    __pyx_r = INT_TO_JSVAL(__pyx_1);
    goto __pyx_L0;
    goto __pyx_L2;
  }
  __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_isfloat); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1065; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1065; goto __pyx_L1;}
  Py_INCREF(__pyx_v_py_obj);
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_v_py_obj);
  __pyx_4 = PyObject_CallObject(__pyx_2, __pyx_3); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1065; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  __pyx_1 = PyObject_IsTrue(__pyx_4); if (__pyx_1 < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1065; goto __pyx_L1;}
  Py_DECREF(__pyx_4); __pyx_4 = 0;
  if (__pyx_1) {

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":1066 */
    __pyx_5 = PyFloat_AsDouble(__pyx_v_py_obj); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1066; goto __pyx_L1;}
    __pyx_1 = (!JS_NewDoubleValue(__pyx_v_cx,__pyx_5,(&__pyx_v_rval)));
    if (__pyx_1) {
      __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1067; goto __pyx_L1;}
      Py_INCREF(__pyx_k79p);
      PyTuple_SET_ITEM(__pyx_2, 0, __pyx_k79p);
      __pyx_3 = PyObject_CallObject(PyExc_SystemError, __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1067; goto __pyx_L1;}
      Py_DECREF(__pyx_2); __pyx_2 = 0;
      __Pyx_Raise(__pyx_3, 0, 0);
      Py_DECREF(__pyx_3); __pyx_3 = 0;
      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1067; goto __pyx_L1;}
      goto __pyx_L3;
    }
    __pyx_L3:;

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":1068 */
    __pyx_r = __pyx_v_rval;
    goto __pyx_L0;
    goto __pyx_L2;
  }
  __pyx_4 = __Pyx_GetName(__pyx_m, __pyx_n_isstringlike); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1069; goto __pyx_L1;}
  __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1069; goto __pyx_L1;}
  Py_INCREF(__pyx_v_py_obj);
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_v_py_obj);
  __pyx_3 = PyObject_CallObject(__pyx_4, __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1069; goto __pyx_L1;}
  Py_DECREF(__pyx_4); __pyx_4 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_1 = PyObject_IsTrue(__pyx_3); if (__pyx_1 < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1069; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  if (__pyx_1) {

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":1070 */
    __pyx_6 = PyString_AsString(__pyx_v_py_obj); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1070; goto __pyx_L1;}
    __pyx_7 = PyObject_Length(__pyx_v_py_obj); if (__pyx_7 == -1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1070; goto __pyx_L1;}
    __pyx_v_s = JS_NewStringCopyN(__pyx_v_cx,__pyx_6,__pyx_7);

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":1071 */
    __pyx_1 = (__pyx_v_s == NULL);
    if (__pyx_1) {
      __pyx_4 = PyTuple_New(1); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1072; goto __pyx_L1;}
      Py_INCREF(__pyx_k80p);
      PyTuple_SET_ITEM(__pyx_4, 0, __pyx_k80p);
      __pyx_2 = PyObject_CallObject(PyExc_SystemError, __pyx_4); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1072; goto __pyx_L1;}
      Py_DECREF(__pyx_4); __pyx_4 = 0;
      __Pyx_Raise(__pyx_2, 0, 0);
      Py_DECREF(__pyx_2); __pyx_2 = 0;
      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1072; goto __pyx_L1;}
      goto __pyx_L4;
    }
    __pyx_L4:;

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":1073 */
    __pyx_r = STRING_TO_JSVAL(__pyx_v_s);
    goto __pyx_L0;
    goto __pyx_L2;
  }
  __pyx_3 = __Pyx_GetName(__pyx_m, __pyx_n_ismapping); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1074; goto __pyx_L1;}
  __pyx_4 = PyTuple_New(1); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1074; goto __pyx_L1;}
  Py_INCREF(__pyx_v_py_obj);
  PyTuple_SET_ITEM(__pyx_4, 0, __pyx_v_py_obj);
  __pyx_2 = PyObject_CallObject(__pyx_3, __pyx_4); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1074; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  Py_DECREF(__pyx_4); __pyx_4 = 0;
  __pyx_1 = PyObject_IsTrue(__pyx_2); if (__pyx_1 < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1074; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  if (__pyx_1) {

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":1075 */
    __pyx_v_jsobj = JS_NewObject(__pyx_v_cx,NULL,NULL,NULL);

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":1077 */
    __pyx_1 = (__pyx_v_jsobj == NULL);
    if (__pyx_1) {
      __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1078; goto __pyx_L1;}
      Py_INCREF(__pyx_k82p);
      PyTuple_SET_ITEM(__pyx_3, 0, __pyx_k82p);
      __pyx_4 = PyObject_CallObject(PyExc_SystemError, __pyx_3); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1078; goto __pyx_L1;}
      Py_DECREF(__pyx_3); __pyx_3 = 0;
      __Pyx_Raise(__pyx_4, 0, 0);
      Py_DECREF(__pyx_4); __pyx_4 = 0;
      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1078; goto __pyx_L1;}
      goto __pyx_L5;
    }
    /*else*/ {

      /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":1081 */
      __pyx_2 = PyObject_GetAttr(__pyx_v_py_obj, __pyx_n_iteritems); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1081; goto __pyx_L1;}
      __pyx_3 = PyObject_CallObject(__pyx_2, 0); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1081; goto __pyx_L1;}
      Py_DECREF(__pyx_2); __pyx_2 = 0;
      __pyx_4 = PyObject_GetIter(__pyx_3); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1081; goto __pyx_L1;}
      Py_DECREF(__pyx_3); __pyx_3 = 0;
      for (;;) {
        __pyx_2 = PyIter_Next(__pyx_4);
        if (!__pyx_2) {
          if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1081; goto __pyx_L1;}
          break;
        }
        __pyx_3 = PyObject_GetIter(__pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1081; goto __pyx_L1;}
        Py_DECREF(__pyx_2); __pyx_2 = 0;
        __pyx_2 = __Pyx_UnpackItem(__pyx_3); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1081; goto __pyx_L1;}
        Py_DECREF(__pyx_v_key);
        __pyx_v_key = __pyx_2;
        __pyx_2 = 0;
        __pyx_2 = __Pyx_UnpackItem(__pyx_3); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1081; goto __pyx_L1;}
        Py_DECREF(__pyx_v_value);
        __pyx_v_value = __pyx_2;
        __pyx_2 = 0;
        if (__Pyx_EndUnpack(__pyx_3) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1081; goto __pyx_L1;}
        Py_DECREF(__pyx_3); __pyx_3 = 0;

        /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":1082 */
        __pyx_8 = __pyx_f_12spidermonkey_JS_from_Py(__pyx_v_cx,__pyx_v_parent,__pyx_v_value); if (__pyx_8 == 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1082; goto __pyx_L1;}
        __pyx_v_elem = __pyx_8;

        /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":1083 */
        __pyx_6 = PyString_AsString(__pyx_v_key); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1083; goto __pyx_L1;}
        __pyx_2 = PyInt_FromLong(JS_DefineProperty(__pyx_v_cx,__pyx_v_jsobj,__pyx_6,__pyx_v_elem,NULL,NULL,JSPROP_ENUMERATE)); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1083; goto __pyx_L1;}
        Py_DECREF(__pyx_v_ok);
        __pyx_v_ok = __pyx_2;
        __pyx_2 = 0;

        /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":1085 */
        __pyx_1 = PyObject_IsTrue(__pyx_v_ok); if (__pyx_1 < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1085; goto __pyx_L1;}
        __pyx_9 = (!__pyx_1);
        if (__pyx_9) {
          __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1086; goto __pyx_L1;}
          Py_INCREF(__pyx_k84p);
          PyTuple_SET_ITEM(__pyx_3, 0, __pyx_k84p);
          __pyx_2 = PyObject_CallObject(PyExc_SystemError, __pyx_3); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1086; goto __pyx_L1;}
          Py_DECREF(__pyx_3); __pyx_3 = 0;
          __Pyx_Raise(__pyx_2, 0, 0);
          Py_DECREF(__pyx_2); __pyx_2 = 0;
          {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1086; goto __pyx_L1;}
          goto __pyx_L8;
        }
        __pyx_L8:;
      }
      Py_DECREF(__pyx_4); __pyx_4 = 0;

      /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":1088 */
      __pyx_r = OBJECT_TO_JSVAL(__pyx_v_jsobj);
      goto __pyx_L0;
    }
    __pyx_L5:;
    goto __pyx_L2;
  }
  __pyx_3 = __Pyx_GetName(__pyx_m, __pyx_n_issequence); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1090; goto __pyx_L1;}
  __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1090; goto __pyx_L1;}
  Py_INCREF(__pyx_v_py_obj);
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_v_py_obj);
  __pyx_4 = PyObject_CallObject(__pyx_3, __pyx_2); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1090; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_1 = PyObject_IsTrue(__pyx_4); if (__pyx_1 < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1090; goto __pyx_L1;}
  Py_DECREF(__pyx_4); __pyx_4 = 0;
  if (__pyx_1) {

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":1091 */
    __pyx_v_arr_obj = JS_NewArrayObject(__pyx_v_cx,0,NULL);

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":1093 */
    __pyx_9 = (__pyx_v_arr_obj == NULL);
    if (__pyx_9) {
      __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1094; goto __pyx_L1;}
      Py_INCREF(__pyx_k86p);
      PyTuple_SET_ITEM(__pyx_3, 0, __pyx_k86p);
      __pyx_2 = PyObject_CallObject(PyExc_SystemError, __pyx_3); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1094; goto __pyx_L1;}
      Py_DECREF(__pyx_3); __pyx_3 = 0;
      __Pyx_Raise(__pyx_2, 0, 0);
      Py_DECREF(__pyx_2); __pyx_2 = 0;
      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1094; goto __pyx_L1;}
      goto __pyx_L9;
    }
    /*else*/ {
      __pyx_7 = PyObject_Length(__pyx_v_py_obj); if (__pyx_7 == -1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1096; goto __pyx_L1;}
      for (__pyx_v_i = 0; __pyx_v_i < __pyx_7; ++__pyx_v_i) {

        /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":1097 */
        __pyx_4 = __Pyx_GetItemInt(__pyx_v_py_obj, __pyx_v_i); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1097; goto __pyx_L1;}
        __pyx_8 = __pyx_f_12spidermonkey_JS_from_Py(__pyx_v_cx,__pyx_v_parent,__pyx_4); if (__pyx_8 == 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1097; goto __pyx_L1;}
        Py_DECREF(__pyx_4); __pyx_4 = 0;
        __pyx_v_elem = __pyx_8;

        /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":1098 */
        __pyx_3 = PyInt_FromLong(JS_DefineElement(__pyx_v_cx,__pyx_v_arr_obj,__pyx_v_i,__pyx_v_elem,NULL,NULL,JSPROP_ENUMERATE)); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1098; goto __pyx_L1;}
        Py_DECREF(__pyx_v_ok);
        __pyx_v_ok = __pyx_3;
        __pyx_3 = 0;

        /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":1100 */
        __pyx_1 = PyObject_IsTrue(__pyx_v_ok); if (__pyx_1 < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1100; goto __pyx_L1;}
        __pyx_9 = (!__pyx_1);
        if (__pyx_9) {
          __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1101; goto __pyx_L1;}
          Py_INCREF(__pyx_k87p);
          PyTuple_SET_ITEM(__pyx_2, 0, __pyx_k87p);
          __pyx_4 = PyObject_CallObject(PyExc_SystemError, __pyx_2); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1101; goto __pyx_L1;}
          Py_DECREF(__pyx_2); __pyx_2 = 0;
          __Pyx_Raise(__pyx_4, 0, 0);
          Py_DECREF(__pyx_4); __pyx_4 = 0;
          {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1101; goto __pyx_L1;}
          goto __pyx_L12;
        }
        __pyx_L12:;
      }
    }
    __pyx_L9:;

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":1103 */
    __pyx_r = OBJECT_TO_JSVAL(__pyx_v_arr_obj);
    goto __pyx_L0;
    goto __pyx_L2;
  }
  __pyx_3 = __Pyx_GetName(__pyx_m, __pyx_n_compat_isinstance); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1104; goto __pyx_L1;}
  __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_MethodType); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1104; goto __pyx_L1;}
  __pyx_4 = PyTuple_New(2); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1104; goto __pyx_L1;}
  Py_INCREF(__pyx_v_py_obj);
  PyTuple_SET_ITEM(__pyx_4, 0, __pyx_v_py_obj);
  PyTuple_SET_ITEM(__pyx_4, 1, __pyx_2);
  __pyx_2 = 0;
  __pyx_2 = PyObject_CallObject(__pyx_3, __pyx_4); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1104; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  Py_DECREF(__pyx_4); __pyx_4 = 0;
  __pyx_1 = PyObject_IsTrue(__pyx_2); if (__pyx_1 < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1104; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  if (__pyx_1) {
    __pyx_r = __pyx_f_12spidermonkey_new_method(__pyx_v_cx,__pyx_v_py_obj);
    goto __pyx_L0;
    goto __pyx_L2;
  }
  __pyx_3 = __Pyx_GetName(__pyx_m, __pyx_n_compat_isinstance); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1108; goto __pyx_L1;}
  __pyx_4 = __Pyx_GetName(__pyx_m, __pyx_n_FunctionType); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1108; goto __pyx_L1;}
  __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_LambdaType); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1108; goto __pyx_L1;}
  __pyx_10 = PyTuple_New(2); if (!__pyx_10) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1108; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_10, 0, __pyx_4);
  PyTuple_SET_ITEM(__pyx_10, 1, __pyx_2);
  __pyx_4 = 0;
  __pyx_2 = 0;
  __pyx_4 = PyTuple_New(2); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1108; goto __pyx_L1;}
  Py_INCREF(__pyx_v_py_obj);
  PyTuple_SET_ITEM(__pyx_4, 0, __pyx_v_py_obj);
  PyTuple_SET_ITEM(__pyx_4, 1, __pyx_10);
  __pyx_10 = 0;
  __pyx_2 = PyObject_CallObject(__pyx_3, __pyx_4); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1108; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  Py_DECREF(__pyx_4); __pyx_4 = 0;
  __pyx_9 = PyObject_IsTrue(__pyx_2); if (__pyx_9 < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1108; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  if (__pyx_9) {
    __pyx_r = JSVAL_VOID;
    goto __pyx_L0;
    goto __pyx_L2;
  }
  /*else*/ {

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":1115 */
    __pyx_10 = ((PyObject *)__pyx_f_12spidermonkey_get_context(__pyx_v_cx)); if (!__pyx_10) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1115; goto __pyx_L1;}
    Py_DECREF(((PyObject *)__pyx_v_context));
    __pyx_v_context = ((struct __pyx_obj_12spidermonkey_Context *)__pyx_10);
    __pyx_10 = 0;

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":1118 */
    /*try:*/ {
      __pyx_3 = __pyx_f_12spidermonkey_context_get_object_from_obj(__pyx_v_context,__pyx_v_py_obj); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1119; goto __pyx_L13;}
      if (!__Pyx_TypeTest(__pyx_3, __pyx_ptype_12spidermonkey_ProxyObject)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1119; goto __pyx_L13;}
      Py_DECREF(((PyObject *)__pyx_v_proxy_obj));
      __pyx_v_proxy_obj = ((struct __pyx_obj_12spidermonkey_ProxyObject *)__pyx_3);
      __pyx_3 = 0;
    }
    /*else:*/ {
      __pyx_v_jsobj = __pyx_v_proxy_obj->jsobj;
    }
    goto __pyx_L14;
    __pyx_L13:;
    Py_XDECREF(__pyx_4); __pyx_4 = 0;
    Py_XDECREF(__pyx_2); __pyx_2 = 0;
    Py_XDECREF(__pyx_10); __pyx_10 = 0;
    Py_XDECREF(__pyx_3); __pyx_3 = 0;

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":1120 */
    __pyx_1 = PyErr_ExceptionMatches(PyExc_ValueError);
    if (__pyx_1) {
      __Pyx_AddTraceback("spidermonkey.JS_from_Py");
      if (__Pyx_GetException(&__pyx_4, &__pyx_2, &__pyx_10) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1120; goto __pyx_L1;}

      /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":1122 */
      __pyx_3 = __Pyx_GetName(__pyx_m, __pyx_n_js_classname); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1122; goto __pyx_L1;}
      __pyx_11 = PyTuple_New(1); if (!__pyx_11) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1122; goto __pyx_L1;}
      Py_INCREF(__pyx_v_py_obj);
      PyTuple_SET_ITEM(__pyx_11, 0, __pyx_v_py_obj);
      __pyx_12 = PyObject_CallObject(__pyx_3, __pyx_11); if (!__pyx_12) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1122; goto __pyx_L1;}
      Py_DECREF(__pyx_3); __pyx_3 = 0;
      Py_DECREF(__pyx_11); __pyx_11 = 0;
      __pyx_3 = ((PyObject *)__pyx_f_12spidermonkey_context_get_class(__pyx_v_context,__pyx_12)); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1122; goto __pyx_L1;}
      Py_DECREF(__pyx_12); __pyx_12 = 0;
      Py_DECREF(((PyObject *)__pyx_v_proxy_class));
      __pyx_v_proxy_class = ((struct __pyx_obj_12spidermonkey_ProxyClass *)__pyx_3);
      __pyx_3 = 0;

      /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":1127 */
      __pyx_v_jsobj = JS_NewObject(__pyx_v_cx,__pyx_v_proxy_class->jsc,__pyx_v_context->globj,__pyx_v_parent);

      /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":1128 */
      __pyx_9 = (__pyx_v_jsobj == NULL);
      if (__pyx_9) {
        __pyx_11 = PyTuple_New(1); if (!__pyx_11) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1129; goto __pyx_L1;}
        Py_INCREF(__pyx_k90p);
        PyTuple_SET_ITEM(__pyx_11, 0, __pyx_k90p);
        __pyx_12 = PyObject_CallObject(PyExc_SystemError, __pyx_11); if (!__pyx_12) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1129; goto __pyx_L1;}
        Py_DECREF(__pyx_11); __pyx_11 = 0;
        __Pyx_Raise(__pyx_12, 0, 0);
        Py_DECREF(__pyx_12); __pyx_12 = 0;
        {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1129; goto __pyx_L1;}
        goto __pyx_L15;
      }
      __pyx_L15:;

      /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":1130 */
      __pyx_f_12spidermonkey_context_register_object(__pyx_v_context,__pyx_v_py_obj,__pyx_v_jsobj);
      Py_DECREF(__pyx_4); __pyx_4 = 0;
      Py_DECREF(__pyx_2); __pyx_2 = 0;
      Py_DECREF(__pyx_10); __pyx_10 = 0;
      goto __pyx_L14;
    }
    goto __pyx_L1;
    __pyx_L14:;

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":1135 */
    __pyx_r = OBJECT_TO_JSVAL(__pyx_v_jsobj);
    goto __pyx_L0;
  }
  __pyx_L2:;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  Py_XDECREF(__pyx_4);
  Py_XDECREF(__pyx_10);
  Py_XDECREF(__pyx_11);
  Py_XDECREF(__pyx_12);
  __Pyx_AddTraceback("spidermonkey.JS_from_Py");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_context);
  Py_DECREF(__pyx_v_proxy_class);
  Py_DECREF(__pyx_v_proxy_obj);
  Py_DECREF(__pyx_v_key);
  Py_DECREF(__pyx_v_value);
  Py_DECREF(__pyx_v_ok);
  Py_DECREF(__pyx_v_py_obj);
  return __pyx_r;
}

static PyObject *__pyx_f_12spidermonkey_dict_from_JShash(struct JSContext *__pyx_v_cx,struct JSObject *__pyx_v_hash) {
  struct JSIdArray *__pyx_v_prop_arr;
  int __pyx_v_i;
  __pyx_t_12spidermonkey_jsval __pyx_v_jskey;
  __pyx_t_12spidermonkey_jsval __pyx_v_jsvalue;
  struct JSObject *__pyx_v_obj;
  PyObject *__pyx_v_d;
  PyObject *__pyx_v_key;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  __pyx_t_12spidermonkey_jsint __pyx_2;
  __pyx_t_12spidermonkey_JSBool __pyx_3;
  char *__pyx_4;
  __pyx_t_12spidermonkey_jsint __pyx_5;
  PyObject *__pyx_6 = 0;
  __pyx_v_d = Py_None; Py_INCREF(Py_None);
  __pyx_v_key = Py_None; Py_INCREF(Py_None);

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":1145 */
  __pyx_v_prop_arr = JS_Enumerate(__pyx_v_cx,__pyx_v_hash);

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":1147 */
  __pyx_1 = PyDict_New(); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1147; goto __pyx_L1;}
  Py_DECREF(__pyx_v_d);
  __pyx_v_d = __pyx_1;
  __pyx_1 = 0;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":1149 */
  __pyx_2 = __pyx_v_prop_arr->length;
  for (__pyx_v_i = 0; __pyx_v_i < __pyx_2; ++__pyx_v_i) {

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":1150 */
    JS_IdToValue(__pyx_v_cx,(__pyx_v_prop_arr->vector[__pyx_v_i]),(&__pyx_v_jskey));

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":1152 */
    __pyx_3 = JSVAL_IS_STRING(__pyx_v_jskey);
    if (__pyx_3) {

      /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":1153 */
      __pyx_1 = PyString_FromString(JS_GetStringBytes(JSVAL_TO_STRING(__pyx_v_jskey))); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1153; goto __pyx_L1;}
      Py_DECREF(__pyx_v_key);
      __pyx_v_key = __pyx_1;
      __pyx_1 = 0;

      /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":1154 */
      __pyx_4 = PyString_AsString(__pyx_v_key); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1154; goto __pyx_L1;}
      JS_GetProperty(__pyx_v_cx,__pyx_v_hash,__pyx_4,(&__pyx_v_jsvalue));
      goto __pyx_L4;
    }
    __pyx_3 = JSVAL_IS_INT(__pyx_v_jskey);
    if (__pyx_3) {

      /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":1156 */
      __pyx_1 = PyInt_FromLong(JSVAL_TO_INT(__pyx_v_jskey)); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1156; goto __pyx_L1;}
      Py_DECREF(__pyx_v_key);
      __pyx_v_key = __pyx_1;
      __pyx_1 = 0;

      /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":1157 */
      __pyx_5 = PyInt_AsLong(__pyx_v_key); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1157; goto __pyx_L1;}
      JS_GetElement(__pyx_v_cx,__pyx_v_hash,__pyx_5,(&__pyx_v_jsvalue));
      goto __pyx_L4;
    }
    /*else*/ {
      __pyx_1 = PyTuple_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1159; goto __pyx_L1;}
      Py_INCREF(__pyx_k91p);
      PyTuple_SET_ITEM(__pyx_1, 0, __pyx_k91p);
      __pyx_6 = PyObject_CallObject(PyExc_AssertionError, __pyx_1); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1159; goto __pyx_L1;}
      Py_DECREF(__pyx_1); __pyx_1 = 0;
      __Pyx_Raise(__pyx_6, 0, 0);
      Py_DECREF(__pyx_6); __pyx_6 = 0;
      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1159; goto __pyx_L1;}
    }
    __pyx_L4:;

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":1161 */
    __pyx_3 = JSVAL_IS_PRIMITIVE(__pyx_v_jsvalue);
    if (__pyx_3) {
      __pyx_1 = __pyx_f_12spidermonkey_Py_from_JSprimitive(__pyx_v_jsvalue); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1162; goto __pyx_L1;}
      if (PyObject_SetItem(__pyx_v_d, __pyx_v_key, __pyx_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1162; goto __pyx_L1;}
      Py_DECREF(__pyx_1); __pyx_1 = 0;
      goto __pyx_L5;
    }
    /*else*/ {
      __pyx_3 = JSVAL_IS_OBJECT(__pyx_v_jsvalue);
      if (__pyx_3) {

        /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":1165 */
        __pyx_v_obj = JSVAL_TO_OBJECT(__pyx_v_jsvalue);

        /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":1166 */
        __pyx_3 = JS_IsArrayObject(__pyx_v_cx,__pyx_v_obj);
        if (__pyx_3) {
          __pyx_6 = __pyx_f_12spidermonkey_list_from_JSarray(__pyx_v_cx,__pyx_v_obj); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1167; goto __pyx_L1;}
          if (PyObject_SetItem(__pyx_v_d, __pyx_v_key, __pyx_6) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1167; goto __pyx_L1;}
          Py_DECREF(__pyx_6); __pyx_6 = 0;
          goto __pyx_L7;
        }
        /*else*/ {
          __pyx_1 = __pyx_f_12spidermonkey_dict_from_JShash(__pyx_v_cx,__pyx_v_obj); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1169; goto __pyx_L1;}
          if (PyObject_SetItem(__pyx_v_d, __pyx_v_key, __pyx_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1169; goto __pyx_L1;}
          Py_DECREF(__pyx_1); __pyx_1 = 0;
        }
        __pyx_L7:;
        goto __pyx_L6;
      }
      __pyx_L6:;
    }
    __pyx_L5:;
  }

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":1171 */
  JS_DestroyIdArray(__pyx_v_cx,__pyx_v_prop_arr);

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":1173 */
  Py_INCREF(__pyx_v_d);
  __pyx_r = __pyx_v_d;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_6);
  __Pyx_AddTraceback("spidermonkey.dict_from_JShash");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_d);
  Py_DECREF(__pyx_v_key);
  return __pyx_r;
}

static PyObject *__pyx_f_12spidermonkey_list_from_JSarray(struct JSContext *__pyx_v_cx,struct JSObject *__pyx_v_array) {
  int __pyx_v_nr_elems;
  int __pyx_v_i;
  __pyx_t_12spidermonkey_jsval __pyx_v_elem;
  struct JSObject *__pyx_v_jsobj;
  PyObject *__pyx_v_l;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  __pyx_t_12spidermonkey_JSBool __pyx_4;
  __pyx_v_l = Py_None; Py_INCREF(Py_None);

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":1180 */
  JS_GetArrayLength(__pyx_v_cx,__pyx_v_array,(&__pyx_v_nr_elems));

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":1182 */
  __pyx_1 = PyList_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1182; goto __pyx_L1;}
  Py_INCREF(Py_None);
  PyList_SET_ITEM(__pyx_1, 0, Py_None);
  __pyx_2 = PyInt_FromLong(__pyx_v_nr_elems); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1182; goto __pyx_L1;}
  __pyx_3 = PyNumber_Multiply(__pyx_1, __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1182; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_v_l);
  __pyx_v_l = __pyx_3;
  __pyx_3 = 0;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":1184 */
  for (__pyx_v_i = 0; __pyx_v_i < __pyx_v_nr_elems; ++__pyx_v_i) {

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":1185 */
    JS_GetElement(__pyx_v_cx,__pyx_v_array,__pyx_v_i,(&__pyx_v_elem));

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":1187 */
    __pyx_4 = JSVAL_IS_PRIMITIVE(__pyx_v_elem);
    if (__pyx_4) {
      __pyx_1 = __pyx_f_12spidermonkey_Py_from_JSprimitive(__pyx_v_elem); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1188; goto __pyx_L1;}
      if (__Pyx_SetItemInt(__pyx_v_l, __pyx_v_i, __pyx_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1188; goto __pyx_L1;}
      Py_DECREF(__pyx_1); __pyx_1 = 0;
      goto __pyx_L4;
    }
    __pyx_4 = JSVAL_IS_OBJECT(__pyx_v_elem);
    if (__pyx_4) {

      /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":1190 */
      __pyx_v_jsobj = JSVAL_TO_OBJECT(__pyx_v_elem);

      /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":1191 */
      __pyx_4 = JS_IsArrayObject(__pyx_v_cx,__pyx_v_jsobj);
      if (__pyx_4) {
        __pyx_2 = __pyx_f_12spidermonkey_list_from_JSarray(__pyx_v_cx,__pyx_v_jsobj); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1192; goto __pyx_L1;}
        if (__Pyx_SetItemInt(__pyx_v_l, __pyx_v_i, __pyx_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1192; goto __pyx_L1;}
        Py_DECREF(__pyx_2); __pyx_2 = 0;
        goto __pyx_L5;
      }
      /*else*/ {
        __pyx_3 = __pyx_f_12spidermonkey_dict_from_JShash(__pyx_v_cx,__pyx_v_jsobj); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1194; goto __pyx_L1;}
        if (__Pyx_SetItemInt(__pyx_v_l, __pyx_v_i, __pyx_3) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1194; goto __pyx_L1;}
        Py_DECREF(__pyx_3); __pyx_3 = 0;
      }
      __pyx_L5:;
      goto __pyx_L4;
    }
    __pyx_L4:;
  }

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":1196 */
  Py_INCREF(__pyx_v_l);
  __pyx_r = __pyx_v_l;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  __Pyx_AddTraceback("spidermonkey.list_from_JSarray");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_l);
  return __pyx_r;
}

static PyObject *__pyx_f_12spidermonkey_Py_from_JSprimitive(__pyx_t_12spidermonkey_jsval __pyx_v_v) {
  PyObject *__pyx_r;
  int __pyx_1;
  __pyx_t_12spidermonkey_JSBool __pyx_2;
  PyObject *__pyx_3 = 0;
  PyObject *__pyx_4 = 0;
  __pyx_1 = JSVAL_IS_NULL(__pyx_v_v);
  if (!__pyx_1) {
    __pyx_1 = JSVAL_IS_VOID(__pyx_v_v);
  }
  if (__pyx_1) {
    Py_INCREF(Py_None);
    __pyx_r = Py_None;
    goto __pyx_L0;
    goto __pyx_L2;
  }
  __pyx_2 = JSVAL_IS_INT(__pyx_v_v);
  if (__pyx_2) {
    __pyx_3 = PyInt_FromLong(JSVAL_TO_INT(__pyx_v_v)); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1203; goto __pyx_L1;}
    __pyx_r = __pyx_3;
    __pyx_3 = 0;
    goto __pyx_L0;
    goto __pyx_L2;
  }
  __pyx_2 = JSVAL_IS_DOUBLE(__pyx_v_v);
  if (__pyx_2) {
    __pyx_3 = PyFloat_FromDouble((JSVAL_TO_DOUBLE(__pyx_v_v)[0])); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1205; goto __pyx_L1;}
    __pyx_r = __pyx_3;
    __pyx_3 = 0;
    goto __pyx_L0;
    goto __pyx_L2;
  }
  __pyx_2 = JSVAL_IS_STRING(__pyx_v_v);
  if (__pyx_2) {
    __pyx_3 = PyString_FromString(JS_GetStringBytes(JSVAL_TO_STRING(__pyx_v_v))); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1207; goto __pyx_L1;}
    __pyx_r = __pyx_3;
    __pyx_3 = 0;
    goto __pyx_L0;
    goto __pyx_L2;
  }
  __pyx_2 = JSVAL_IS_BOOLEAN(__pyx_v_v);
  if (__pyx_2) {
    __pyx_2 = JSVAL_TO_BOOLEAN(__pyx_v_v);
    if (__pyx_2) {
      Py_INCREF(Py_True);
      __pyx_r = Py_True;
      goto __pyx_L0;
      goto __pyx_L3;
    }
    /*else*/ {
      Py_INCREF(Py_False);
      __pyx_r = Py_False;
      goto __pyx_L0;
    }
    __pyx_L3:;
    goto __pyx_L2;
  }
  /*else*/ {
    __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1214; goto __pyx_L1;}
    Py_INCREF(__pyx_k92p);
    PyTuple_SET_ITEM(__pyx_3, 0, __pyx_k92p);
    __pyx_4 = PyObject_CallObject(PyExc_SystemError, __pyx_3); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1214; goto __pyx_L1;}
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    __Pyx_Raise(__pyx_4, 0, 0);
    Py_DECREF(__pyx_4); __pyx_4 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1214; goto __pyx_L1;}
  }
  __pyx_L2:;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_3);
  Py_XDECREF(__pyx_4);
  __Pyx_AddTraceback("spidermonkey.Py_from_JSprimitive");
  __pyx_r = 0;
  __pyx_L0:;
  return __pyx_r;
}

static PyObject *__pyx_f_12spidermonkey_Py_from_JS(struct JSContext *__pyx_v_cx,__pyx_t_12spidermonkey_jsval __pyx_v_v) {
  struct JSObject *__pyx_v_object;
  struct __pyx_obj_12spidermonkey_ProxyObject *__pyx_v_proxy_obj;
  struct __pyx_obj_12spidermonkey_Context *__pyx_v_context;
  PyObject *__pyx_r;
  __pyx_t_12spidermonkey_JSBool __pyx_1;
  PyObject *__pyx_2 = 0;
  int __pyx_3;
  PyObject *__pyx_4 = 0;
  PyObject *__pyx_5 = 0;
  PyObject *__pyx_6 = 0;
  __pyx_v_proxy_obj = ((struct __pyx_obj_12spidermonkey_ProxyObject *)Py_None); Py_INCREF(Py_None);
  __pyx_v_context = ((struct __pyx_obj_12spidermonkey_Context *)Py_None); Py_INCREF(Py_None);

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":1222 */
  __pyx_1 = JSVAL_IS_PRIMITIVE(__pyx_v_v);
  if (__pyx_1) {
    __pyx_2 = __pyx_f_12spidermonkey_Py_from_JSprimitive(__pyx_v_v); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1223; goto __pyx_L1;}
    __pyx_r = __pyx_2;
    __pyx_2 = 0;
    goto __pyx_L0;
    goto __pyx_L2;
  }
  __pyx_1 = JSVAL_IS_OBJECT(__pyx_v_v);
  if (__pyx_1) {

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":1225 */
    __pyx_v_object = JSVAL_TO_OBJECT(__pyx_v_v);

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":1226 */
    __pyx_2 = ((PyObject *)__pyx_f_12spidermonkey_get_context(__pyx_v_cx)); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1226; goto __pyx_L1;}
    Py_DECREF(((PyObject *)__pyx_v_context));
    __pyx_v_context = ((struct __pyx_obj_12spidermonkey_Context *)__pyx_2);
    __pyx_2 = 0;

    /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":1228 */
    __pyx_1 = JS_IsArrayObject(__pyx_v_cx,__pyx_v_object);
    if (__pyx_1) {
      __pyx_2 = __pyx_f_12spidermonkey_list_from_JSarray(__pyx_v_cx,__pyx_v_object); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1229; goto __pyx_L1;}
      __pyx_r = __pyx_2;
      __pyx_2 = 0;
      goto __pyx_L0;
      goto __pyx_L3;
    }
    __pyx_1 = JS_ObjectIsFunction(__pyx_v_cx,__pyx_v_object);
    if (__pyx_1) {

      /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":1231 */
      __pyx_2 = ((PyObject *)__pyx_f_12spidermonkey_create_proxy_function(__pyx_v_context,__pyx_v_v)); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1231; goto __pyx_L1;}
      __pyx_r = __pyx_2;
      __pyx_2 = 0;
      goto __pyx_L0;
      goto __pyx_L3;
    }
    /*else*/ {
      /*try:*/ {
        __pyx_2 = __pyx_f_12spidermonkey_context_get_object(__pyx_v_context,__pyx_v_object); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1234; goto __pyx_L4;}
        if (!__Pyx_TypeTest(__pyx_2, __pyx_ptype_12spidermonkey_ProxyObject)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1234; goto __pyx_L4;}
        Py_DECREF(((PyObject *)__pyx_v_proxy_obj));
        __pyx_v_proxy_obj = ((struct __pyx_obj_12spidermonkey_ProxyObject *)__pyx_2);
        __pyx_2 = 0;
      }
      /*else:*/ {
        Py_INCREF(__pyx_v_proxy_obj->obj);
        __pyx_r = __pyx_v_proxy_obj->obj;
        goto __pyx_L0;
      }
      goto __pyx_L5;
      __pyx_L4:;
      Py_XDECREF(__pyx_2); __pyx_2 = 0;

      /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":1235 */
      __pyx_3 = PyErr_ExceptionMatches(PyExc_ValueError);
      if (__pyx_3) {
        __Pyx_AddTraceback("spidermonkey.Py_from_JS");
        if (__Pyx_GetException(&__pyx_2, &__pyx_4, &__pyx_5) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1235; goto __pyx_L1;}
        __pyx_6 = __pyx_f_12spidermonkey_dict_from_JShash(__pyx_v_cx,__pyx_v_object); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1236; goto __pyx_L1;}
        __pyx_r = __pyx_6;
        __pyx_6 = 0;
        Py_DECREF(__pyx_2); __pyx_2 = 0;
        Py_DECREF(__pyx_4); __pyx_4 = 0;
        Py_DECREF(__pyx_5); __pyx_5 = 0;
        goto __pyx_L0;
        Py_DECREF(__pyx_2); __pyx_2 = 0;
        Py_DECREF(__pyx_4); __pyx_4 = 0;
        Py_DECREF(__pyx_5); __pyx_5 = 0;
        goto __pyx_L5;
      }
      goto __pyx_L1;
      __pyx_L5:;
    }
    __pyx_L3:;
    goto __pyx_L2;
  }
  __pyx_L2:;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_4);
  Py_XDECREF(__pyx_5);
  Py_XDECREF(__pyx_6);
  __Pyx_AddTraceback("spidermonkey.Py_from_JS");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_proxy_obj);
  Py_DECREF(__pyx_v_context);
  return __pyx_r;
}

static PyObject *__pyx_tp_new_12spidermonkey_Runtime(PyTypeObject *t, PyObject *a, PyObject *k) {
  struct __pyx_obj_12spidermonkey_Runtime *p;
  PyObject *o = (*t->tp_alloc)(t, 0);
  if (!o) return 0;
  p = ((struct __pyx_obj_12spidermonkey_Runtime *)o);
  p->_cxs = Py_None; Py_INCREF(Py_None);
  if (__pyx_f_12spidermonkey_7Runtime___cinit__(o, a, k) < 0) {
    Py_DECREF(o); o = 0;
  }
  return o;
}

static void __pyx_tp_dealloc_12spidermonkey_Runtime(PyObject *o) {
  struct __pyx_obj_12spidermonkey_Runtime *p = (struct __pyx_obj_12spidermonkey_Runtime *)o;
  {
    PyObject *etype, *eval, *etb;
    PyErr_Fetch(&etype, &eval, &etb);
    ++o->ob_refcnt;
    __pyx_f_12spidermonkey_7Runtime___dealloc__(o);
    if (PyErr_Occurred()) PyErr_WriteUnraisable(o);
    --o->ob_refcnt;
    PyErr_Restore(etype, eval, etb);
  }
  Py_XDECREF(p->_cxs);
  (*o->ob_type->tp_free)(o);
}

static int __pyx_tp_traverse_12spidermonkey_Runtime(PyObject *o, visitproc v, void *a) {
  int e;
  struct __pyx_obj_12spidermonkey_Runtime *p = (struct __pyx_obj_12spidermonkey_Runtime *)o;
  if (p->_cxs) {
    e = (*v)(p->_cxs, a); if (e) return e;
  }
  return 0;
}

static int __pyx_tp_clear_12spidermonkey_Runtime(PyObject *o) {
  struct __pyx_obj_12spidermonkey_Runtime *p = (struct __pyx_obj_12spidermonkey_Runtime *)o;
  PyObject *t;
  t = p->_cxs; 
  p->_cxs = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(t);
  return 0;
}

static struct PyMethodDef __pyx_methods_12spidermonkey_Runtime[] = {
  {"new_context", (PyCFunction)__pyx_f_12spidermonkey_7Runtime_new_context, METH_VARARGS|METH_KEYWORDS, 0},
  {"__del__", (PyCFunction)__pyx_f_12spidermonkey_7Runtime___del__, METH_VARARGS|METH_KEYWORDS, 0},
  {0, 0, 0, 0}
};

static PyNumberMethods __pyx_tp_as_number_Runtime = {
  0, /*nb_add*/
  0, /*nb_subtract*/
  0, /*nb_multiply*/
  0, /*nb_divide*/
  0, /*nb_remainder*/
  0, /*nb_divmod*/
  0, /*nb_power*/
  0, /*nb_negative*/
  0, /*nb_positive*/
  0, /*nb_absolute*/
  0, /*nb_nonzero*/
  0, /*nb_invert*/
  0, /*nb_lshift*/
  0, /*nb_rshift*/
  0, /*nb_and*/
  0, /*nb_xor*/
  0, /*nb_or*/
  0, /*nb_coerce*/
  0, /*nb_int*/
  0, /*nb_long*/
  0, /*nb_float*/
  0, /*nb_oct*/
  0, /*nb_hex*/
  0, /*nb_inplace_add*/
  0, /*nb_inplace_subtract*/
  0, /*nb_inplace_multiply*/
  0, /*nb_inplace_divide*/
  0, /*nb_inplace_remainder*/
  0, /*nb_inplace_power*/
  0, /*nb_inplace_lshift*/
  0, /*nb_inplace_rshift*/
  0, /*nb_inplace_and*/
  0, /*nb_inplace_xor*/
  0, /*nb_inplace_or*/
  0, /*nb_floor_divide*/
  0, /*nb_true_divide*/
  0, /*nb_inplace_floor_divide*/
  0, /*nb_inplace_true_divide*/
  #if Py_TPFLAGS_DEFAULT & Py_TPFLAGS_HAVE_INDEX
  0, /*nb_index*/
  #endif
};

static PySequenceMethods __pyx_tp_as_sequence_Runtime = {
  0, /*sq_length*/
  0, /*sq_concat*/
  0, /*sq_repeat*/
  0, /*sq_item*/
  0, /*sq_slice*/
  0, /*sq_ass_item*/
  0, /*sq_ass_slice*/
  0, /*sq_contains*/
  0, /*sq_inplace_concat*/
  0, /*sq_inplace_repeat*/
};

static PyMappingMethods __pyx_tp_as_mapping_Runtime = {
  0, /*mp_length*/
  0, /*mp_subscript*/
  0, /*mp_ass_subscript*/
};

static PyBufferProcs __pyx_tp_as_buffer_Runtime = {
  0, /*bf_getreadbuffer*/
  0, /*bf_getwritebuffer*/
  0, /*bf_getsegcount*/
  0, /*bf_getcharbuffer*/
};

PyTypeObject __pyx_type_12spidermonkey_Runtime = {
  PyObject_HEAD_INIT(0)
  0, /*ob_size*/
  "spidermonkey.Runtime", /*tp_name*/
  sizeof(struct __pyx_obj_12spidermonkey_Runtime), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_12spidermonkey_Runtime, /*tp_dealloc*/
  0, /*tp_print*/
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  0, /*tp_compare*/
  0, /*tp_repr*/
  &__pyx_tp_as_number_Runtime, /*tp_as_number*/
  &__pyx_tp_as_sequence_Runtime, /*tp_as_sequence*/
  &__pyx_tp_as_mapping_Runtime, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  &__pyx_tp_as_buffer_Runtime, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_GC, /*tp_flags*/
  0, /*tp_doc*/
  __pyx_tp_traverse_12spidermonkey_Runtime, /*tp_traverse*/
  __pyx_tp_clear_12spidermonkey_Runtime, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_12spidermonkey_Runtime, /*tp_methods*/
  0, /*tp_members*/
  0, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  0, /*tp_dictoffset*/
  __pyx_f_12spidermonkey_7Runtime___init__, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_12spidermonkey_Runtime, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
};

static PyObject *__pyx_tp_new_12spidermonkey_Context(PyTypeObject *t, PyObject *a, PyObject *k) {
  struct __pyx_obj_12spidermonkey_Context *p;
  PyObject *o = (*t->tp_alloc)(t, 0);
  if (!o) return 0;
  p = ((struct __pyx_obj_12spidermonkey_Context *)o);
  p->rt = ((struct __pyx_obj_12spidermonkey_Runtime *)Py_None); Py_INCREF(Py_None);
  p->_funcs = Py_None; Py_INCREF(Py_None);
  p->_classes = Py_None; Py_INCREF(Py_None);
  p->_objs = Py_None; Py_INCREF(Py_None);
  p->_script = Py_None; Py_INCREF(Py_None);
  p->_evaled_script = Py_None; Py_INCREF(Py_None);
  p->_last_error = Py_None; Py_INCREF(Py_None);
  if (__pyx_f_12spidermonkey_7Context___cinit__(o, a, k) < 0) {
    Py_DECREF(o); o = 0;
  }
  return o;
}

static void __pyx_tp_dealloc_12spidermonkey_Context(PyObject *o) {
  struct __pyx_obj_12spidermonkey_Context *p = (struct __pyx_obj_12spidermonkey_Context *)o;
  {
    PyObject *etype, *eval, *etb;
    PyErr_Fetch(&etype, &eval, &etb);
    ++o->ob_refcnt;
    __pyx_f_12spidermonkey_7Context___dealloc__(o);
    if (PyErr_Occurred()) PyErr_WriteUnraisable(o);
    --o->ob_refcnt;
    PyErr_Restore(etype, eval, etb);
  }
  Py_XDECREF(((PyObject *)p->rt));
  Py_XDECREF(p->_funcs);
  Py_XDECREF(p->_classes);
  Py_XDECREF(p->_objs);
  Py_XDECREF(p->_script);
  Py_XDECREF(p->_evaled_script);
  Py_XDECREF(p->_last_error);
  (*o->ob_type->tp_free)(o);
}

static int __pyx_tp_traverse_12spidermonkey_Context(PyObject *o, visitproc v, void *a) {
  int e;
  struct __pyx_obj_12spidermonkey_Context *p = (struct __pyx_obj_12spidermonkey_Context *)o;
  if (p->rt) {
    e = (*v)(((PyObject*)p->rt), a); if (e) return e;
  }
  if (p->_funcs) {
    e = (*v)(p->_funcs, a); if (e) return e;
  }
  if (p->_classes) {
    e = (*v)(p->_classes, a); if (e) return e;
  }
  if (p->_objs) {
    e = (*v)(p->_objs, a); if (e) return e;
  }
  if (p->_script) {
    e = (*v)(p->_script, a); if (e) return e;
  }
  if (p->_evaled_script) {
    e = (*v)(p->_evaled_script, a); if (e) return e;
  }
  if (p->_last_error) {
    e = (*v)(p->_last_error, a); if (e) return e;
  }
  return 0;
}

static int __pyx_tp_clear_12spidermonkey_Context(PyObject *o) {
  struct __pyx_obj_12spidermonkey_Context *p = (struct __pyx_obj_12spidermonkey_Context *)o;
  PyObject *t;
  t = ((PyObject *)p->rt); 
  p->rt = ((struct __pyx_obj_12spidermonkey_Runtime *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(t);
  t = p->_funcs; 
  p->_funcs = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(t);
  t = p->_classes; 
  p->_classes = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(t);
  t = p->_objs; 
  p->_objs = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(t);
  t = p->_script; 
  p->_script = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(t);
  t = p->_evaled_script; 
  p->_evaled_script = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(t);
  t = p->_last_error; 
  p->_last_error = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(t);
  return 0;
}

static struct PyMethodDef __pyx_methods_12spidermonkey_Context[] = {
  {"finish_initialization", (PyCFunction)__pyx_f_12spidermonkey_7Context_finish_initialization, METH_VARARGS|METH_KEYWORDS, 0},
  {"get_global", (PyCFunction)__pyx_f_12spidermonkey_7Context_get_global, METH_VARARGS|METH_KEYWORDS, __pyx_doc_12spidermonkey_7Context_get_global},
  {"bind_callable", (PyCFunction)__pyx_f_12spidermonkey_7Context_bind_callable, METH_VARARGS|METH_KEYWORDS, 0},
  {"bind_attribute", (PyCFunction)__pyx_f_12spidermonkey_7Context_bind_attribute, METH_VARARGS|METH_KEYWORDS, 0},
  {"bind_class", (PyCFunction)__pyx_f_12spidermonkey_7Context_bind_class, METH_VARARGS|METH_KEYWORDS, 0},
  {"bind_object", (PyCFunction)__pyx_f_12spidermonkey_7Context_bind_object, METH_VARARGS|METH_KEYWORDS, 0},
  {"call_fn", (PyCFunction)__pyx_f_12spidermonkey_7Context_call_fn, METH_VARARGS|METH_KEYWORDS, 0},
  {"eval_script", (PyCFunction)__pyx_f_12spidermonkey_7Context_eval_script, METH_VARARGS|METH_KEYWORDS, 0},
  {0, 0, 0, 0}
};

static PyNumberMethods __pyx_tp_as_number_Context = {
  0, /*nb_add*/
  0, /*nb_subtract*/
  0, /*nb_multiply*/
  0, /*nb_divide*/
  0, /*nb_remainder*/
  0, /*nb_divmod*/
  0, /*nb_power*/
  0, /*nb_negative*/
  0, /*nb_positive*/
  0, /*nb_absolute*/
  0, /*nb_nonzero*/
  0, /*nb_invert*/
  0, /*nb_lshift*/
  0, /*nb_rshift*/
  0, /*nb_and*/
  0, /*nb_xor*/
  0, /*nb_or*/
  0, /*nb_coerce*/
  0, /*nb_int*/
  0, /*nb_long*/
  0, /*nb_float*/
  0, /*nb_oct*/
  0, /*nb_hex*/
  0, /*nb_inplace_add*/
  0, /*nb_inplace_subtract*/
  0, /*nb_inplace_multiply*/
  0, /*nb_inplace_divide*/
  0, /*nb_inplace_remainder*/
  0, /*nb_inplace_power*/
  0, /*nb_inplace_lshift*/
  0, /*nb_inplace_rshift*/
  0, /*nb_inplace_and*/
  0, /*nb_inplace_xor*/
  0, /*nb_inplace_or*/
  0, /*nb_floor_divide*/
  0, /*nb_true_divide*/
  0, /*nb_inplace_floor_divide*/
  0, /*nb_inplace_true_divide*/
  #if Py_TPFLAGS_DEFAULT & Py_TPFLAGS_HAVE_INDEX
  0, /*nb_index*/
  #endif
};

static PySequenceMethods __pyx_tp_as_sequence_Context = {
  0, /*sq_length*/
  0, /*sq_concat*/
  0, /*sq_repeat*/
  0, /*sq_item*/
  0, /*sq_slice*/
  0, /*sq_ass_item*/
  0, /*sq_ass_slice*/
  0, /*sq_contains*/
  0, /*sq_inplace_concat*/
  0, /*sq_inplace_repeat*/
};

static PyMappingMethods __pyx_tp_as_mapping_Context = {
  0, /*mp_length*/
  0, /*mp_subscript*/
  0, /*mp_ass_subscript*/
};

static PyBufferProcs __pyx_tp_as_buffer_Context = {
  0, /*bf_getreadbuffer*/
  0, /*bf_getwritebuffer*/
  0, /*bf_getsegcount*/
  0, /*bf_getcharbuffer*/
};

PyTypeObject __pyx_type_12spidermonkey_Context = {
  PyObject_HEAD_INIT(0)
  0, /*ob_size*/
  "spidermonkey.Context", /*tp_name*/
  sizeof(struct __pyx_obj_12spidermonkey_Context), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_12spidermonkey_Context, /*tp_dealloc*/
  0, /*tp_print*/
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  0, /*tp_compare*/
  0, /*tp_repr*/
  &__pyx_tp_as_number_Context, /*tp_as_number*/
  &__pyx_tp_as_sequence_Context, /*tp_as_sequence*/
  &__pyx_tp_as_mapping_Context, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  &__pyx_tp_as_buffer_Context, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_GC, /*tp_flags*/
  0, /*tp_doc*/
  __pyx_tp_traverse_12spidermonkey_Context, /*tp_traverse*/
  __pyx_tp_clear_12spidermonkey_Context, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_12spidermonkey_Context, /*tp_methods*/
  0, /*tp_members*/
  0, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  0, /*tp_dictoffset*/
  __pyx_f_12spidermonkey_7Context___init__, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_12spidermonkey_Context, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
};

static PyObject *__pyx_tp_new_12spidermonkey_ProxyClass(PyTypeObject *t, PyObject *a, PyObject *k) {
  struct __pyx_obj_12spidermonkey_ProxyClass *p;
  PyObject *o = (*t->tp_alloc)(t, 0);
  if (!o) return 0;
  p = ((struct __pyx_obj_12spidermonkey_ProxyClass *)o);
  p->klass = Py_None; Py_INCREF(Py_None);
  if (__pyx_f_12spidermonkey_10ProxyClass___cinit__(o, a, k) < 0) {
    Py_DECREF(o); o = 0;
  }
  return o;
}

static void __pyx_tp_dealloc_12spidermonkey_ProxyClass(PyObject *o) {
  struct __pyx_obj_12spidermonkey_ProxyClass *p = (struct __pyx_obj_12spidermonkey_ProxyClass *)o;
  {
    PyObject *etype, *eval, *etb;
    PyErr_Fetch(&etype, &eval, &etb);
    ++o->ob_refcnt;
    __pyx_f_12spidermonkey_10ProxyClass___dealloc__(o);
    if (PyErr_Occurred()) PyErr_WriteUnraisable(o);
    --o->ob_refcnt;
    PyErr_Restore(etype, eval, etb);
  }
  Py_XDECREF(p->klass);
  (*o->ob_type->tp_free)(o);
}

static int __pyx_tp_traverse_12spidermonkey_ProxyClass(PyObject *o, visitproc v, void *a) {
  int e;
  struct __pyx_obj_12spidermonkey_ProxyClass *p = (struct __pyx_obj_12spidermonkey_ProxyClass *)o;
  if (p->klass) {
    e = (*v)(p->klass, a); if (e) return e;
  }
  return 0;
}

static int __pyx_tp_clear_12spidermonkey_ProxyClass(PyObject *o) {
  struct __pyx_obj_12spidermonkey_ProxyClass *p = (struct __pyx_obj_12spidermonkey_ProxyClass *)o;
  PyObject *t;
  t = p->klass; 
  p->klass = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(t);
  return 0;
}

static struct PyMethodDef __pyx_methods_12spidermonkey_ProxyClass[] = {
  {0, 0, 0, 0}
};

static PyNumberMethods __pyx_tp_as_number_ProxyClass = {
  0, /*nb_add*/
  0, /*nb_subtract*/
  0, /*nb_multiply*/
  0, /*nb_divide*/
  0, /*nb_remainder*/
  0, /*nb_divmod*/
  0, /*nb_power*/
  0, /*nb_negative*/
  0, /*nb_positive*/
  0, /*nb_absolute*/
  0, /*nb_nonzero*/
  0, /*nb_invert*/
  0, /*nb_lshift*/
  0, /*nb_rshift*/
  0, /*nb_and*/
  0, /*nb_xor*/
  0, /*nb_or*/
  0, /*nb_coerce*/
  0, /*nb_int*/
  0, /*nb_long*/
  0, /*nb_float*/
  0, /*nb_oct*/
  0, /*nb_hex*/
  0, /*nb_inplace_add*/
  0, /*nb_inplace_subtract*/
  0, /*nb_inplace_multiply*/
  0, /*nb_inplace_divide*/
  0, /*nb_inplace_remainder*/
  0, /*nb_inplace_power*/
  0, /*nb_inplace_lshift*/
  0, /*nb_inplace_rshift*/
  0, /*nb_inplace_and*/
  0, /*nb_inplace_xor*/
  0, /*nb_inplace_or*/
  0, /*nb_floor_divide*/
  0, /*nb_true_divide*/
  0, /*nb_inplace_floor_divide*/
  0, /*nb_inplace_true_divide*/
  #if Py_TPFLAGS_DEFAULT & Py_TPFLAGS_HAVE_INDEX
  0, /*nb_index*/
  #endif
};

static PySequenceMethods __pyx_tp_as_sequence_ProxyClass = {
  0, /*sq_length*/
  0, /*sq_concat*/
  0, /*sq_repeat*/
  0, /*sq_item*/
  0, /*sq_slice*/
  0, /*sq_ass_item*/
  0, /*sq_ass_slice*/
  0, /*sq_contains*/
  0, /*sq_inplace_concat*/
  0, /*sq_inplace_repeat*/
};

static PyMappingMethods __pyx_tp_as_mapping_ProxyClass = {
  0, /*mp_length*/
  0, /*mp_subscript*/
  0, /*mp_ass_subscript*/
};

static PyBufferProcs __pyx_tp_as_buffer_ProxyClass = {
  0, /*bf_getreadbuffer*/
  0, /*bf_getwritebuffer*/
  0, /*bf_getsegcount*/
  0, /*bf_getcharbuffer*/
};

PyTypeObject __pyx_type_12spidermonkey_ProxyClass = {
  PyObject_HEAD_INIT(0)
  0, /*ob_size*/
  "spidermonkey.ProxyClass", /*tp_name*/
  sizeof(struct __pyx_obj_12spidermonkey_ProxyClass), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_12spidermonkey_ProxyClass, /*tp_dealloc*/
  0, /*tp_print*/
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  0, /*tp_compare*/
  0, /*tp_repr*/
  &__pyx_tp_as_number_ProxyClass, /*tp_as_number*/
  &__pyx_tp_as_sequence_ProxyClass, /*tp_as_sequence*/
  &__pyx_tp_as_mapping_ProxyClass, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  &__pyx_tp_as_buffer_ProxyClass, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_GC, /*tp_flags*/
  0, /*tp_doc*/
  __pyx_tp_traverse_12spidermonkey_ProxyClass, /*tp_traverse*/
  __pyx_tp_clear_12spidermonkey_ProxyClass, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_12spidermonkey_ProxyClass, /*tp_methods*/
  0, /*tp_members*/
  0, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  0, /*tp_dictoffset*/
  __pyx_f_12spidermonkey_10ProxyClass___init__, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_12spidermonkey_ProxyClass, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
};

static PyObject *__pyx_tp_new_12spidermonkey_ProxyObject(PyTypeObject *t, PyObject *a, PyObject *k) {
  struct __pyx_obj_12spidermonkey_ProxyObject *p;
  PyObject *o = (*t->tp_alloc)(t, 0);
  if (!o) return 0;
  p = ((struct __pyx_obj_12spidermonkey_ProxyObject *)o);
  p->obj = Py_None; Py_INCREF(Py_None);
  return o;
}

static void __pyx_tp_dealloc_12spidermonkey_ProxyObject(PyObject *o) {
  struct __pyx_obj_12spidermonkey_ProxyObject *p = (struct __pyx_obj_12spidermonkey_ProxyObject *)o;
  Py_XDECREF(p->obj);
  (*o->ob_type->tp_free)(o);
}

static int __pyx_tp_traverse_12spidermonkey_ProxyObject(PyObject *o, visitproc v, void *a) {
  int e;
  struct __pyx_obj_12spidermonkey_ProxyObject *p = (struct __pyx_obj_12spidermonkey_ProxyObject *)o;
  if (p->obj) {
    e = (*v)(p->obj, a); if (e) return e;
  }
  return 0;
}

static int __pyx_tp_clear_12spidermonkey_ProxyObject(PyObject *o) {
  struct __pyx_obj_12spidermonkey_ProxyObject *p = (struct __pyx_obj_12spidermonkey_ProxyObject *)o;
  PyObject *t;
  t = p->obj; 
  p->obj = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(t);
  return 0;
}

static struct PyMethodDef __pyx_methods_12spidermonkey_ProxyObject[] = {
  {0, 0, 0, 0}
};

static PyNumberMethods __pyx_tp_as_number_ProxyObject = {
  0, /*nb_add*/
  0, /*nb_subtract*/
  0, /*nb_multiply*/
  0, /*nb_divide*/
  0, /*nb_remainder*/
  0, /*nb_divmod*/
  0, /*nb_power*/
  0, /*nb_negative*/
  0, /*nb_positive*/
  0, /*nb_absolute*/
  0, /*nb_nonzero*/
  0, /*nb_invert*/
  0, /*nb_lshift*/
  0, /*nb_rshift*/
  0, /*nb_and*/
  0, /*nb_xor*/
  0, /*nb_or*/
  0, /*nb_coerce*/
  0, /*nb_int*/
  0, /*nb_long*/
  0, /*nb_float*/
  0, /*nb_oct*/
  0, /*nb_hex*/
  0, /*nb_inplace_add*/
  0, /*nb_inplace_subtract*/
  0, /*nb_inplace_multiply*/
  0, /*nb_inplace_divide*/
  0, /*nb_inplace_remainder*/
  0, /*nb_inplace_power*/
  0, /*nb_inplace_lshift*/
  0, /*nb_inplace_rshift*/
  0, /*nb_inplace_and*/
  0, /*nb_inplace_xor*/
  0, /*nb_inplace_or*/
  0, /*nb_floor_divide*/
  0, /*nb_true_divide*/
  0, /*nb_inplace_floor_divide*/
  0, /*nb_inplace_true_divide*/
  #if Py_TPFLAGS_DEFAULT & Py_TPFLAGS_HAVE_INDEX
  0, /*nb_index*/
  #endif
};

static PySequenceMethods __pyx_tp_as_sequence_ProxyObject = {
  0, /*sq_length*/
  0, /*sq_concat*/
  0, /*sq_repeat*/
  0, /*sq_item*/
  0, /*sq_slice*/
  0, /*sq_ass_item*/
  0, /*sq_ass_slice*/
  0, /*sq_contains*/
  0, /*sq_inplace_concat*/
  0, /*sq_inplace_repeat*/
};

static PyMappingMethods __pyx_tp_as_mapping_ProxyObject = {
  0, /*mp_length*/
  0, /*mp_subscript*/
  0, /*mp_ass_subscript*/
};

static PyBufferProcs __pyx_tp_as_buffer_ProxyObject = {
  0, /*bf_getreadbuffer*/
  0, /*bf_getwritebuffer*/
  0, /*bf_getsegcount*/
  0, /*bf_getcharbuffer*/
};

PyTypeObject __pyx_type_12spidermonkey_ProxyObject = {
  PyObject_HEAD_INIT(0)
  0, /*ob_size*/
  "spidermonkey.ProxyObject", /*tp_name*/
  sizeof(struct __pyx_obj_12spidermonkey_ProxyObject), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_12spidermonkey_ProxyObject, /*tp_dealloc*/
  0, /*tp_print*/
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  0, /*tp_compare*/
  0, /*tp_repr*/
  &__pyx_tp_as_number_ProxyObject, /*tp_as_number*/
  &__pyx_tp_as_sequence_ProxyObject, /*tp_as_sequence*/
  &__pyx_tp_as_mapping_ProxyObject, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  &__pyx_tp_as_buffer_ProxyObject, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_GC, /*tp_flags*/
  0, /*tp_doc*/
  __pyx_tp_traverse_12spidermonkey_ProxyObject, /*tp_traverse*/
  __pyx_tp_clear_12spidermonkey_ProxyObject, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_12spidermonkey_ProxyObject, /*tp_methods*/
  0, /*tp_members*/
  0, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  0, /*tp_dictoffset*/
  __pyx_f_12spidermonkey_11ProxyObject___init__, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_12spidermonkey_ProxyObject, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
};

static PyObject *__pyx_tp_new_12spidermonkey_ProxyFunction(PyTypeObject *t, PyObject *a, PyObject *k) {
  struct __pyx_obj_12spidermonkey_ProxyFunction *p;
  PyObject *o = (*t->tp_alloc)(t, 0);
  if (!o) return 0;
  p = ((struct __pyx_obj_12spidermonkey_ProxyFunction *)o);
  p->cx = ((struct __pyx_obj_12spidermonkey_Context *)Py_None); Py_INCREF(Py_None);
  return o;
}

static void __pyx_tp_dealloc_12spidermonkey_ProxyFunction(PyObject *o) {
  struct __pyx_obj_12spidermonkey_ProxyFunction *p = (struct __pyx_obj_12spidermonkey_ProxyFunction *)o;
  Py_XDECREF(((PyObject *)p->cx));
  (*o->ob_type->tp_free)(o);
}

static int __pyx_tp_traverse_12spidermonkey_ProxyFunction(PyObject *o, visitproc v, void *a) {
  int e;
  struct __pyx_obj_12spidermonkey_ProxyFunction *p = (struct __pyx_obj_12spidermonkey_ProxyFunction *)o;
  if (p->cx) {
    e = (*v)(((PyObject*)p->cx), a); if (e) return e;
  }
  return 0;
}

static int __pyx_tp_clear_12spidermonkey_ProxyFunction(PyObject *o) {
  struct __pyx_obj_12spidermonkey_ProxyFunction *p = (struct __pyx_obj_12spidermonkey_ProxyFunction *)o;
  PyObject *t;
  t = ((PyObject *)p->cx); 
  p->cx = ((struct __pyx_obj_12spidermonkey_Context *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(t);
  return 0;
}

static struct PyMethodDef __pyx_methods_12spidermonkey_ProxyFunction[] = {
  {0, 0, 0, 0}
};

static PyNumberMethods __pyx_tp_as_number_ProxyFunction = {
  0, /*nb_add*/
  0, /*nb_subtract*/
  0, /*nb_multiply*/
  0, /*nb_divide*/
  0, /*nb_remainder*/
  0, /*nb_divmod*/
  0, /*nb_power*/
  0, /*nb_negative*/
  0, /*nb_positive*/
  0, /*nb_absolute*/
  0, /*nb_nonzero*/
  0, /*nb_invert*/
  0, /*nb_lshift*/
  0, /*nb_rshift*/
  0, /*nb_and*/
  0, /*nb_xor*/
  0, /*nb_or*/
  0, /*nb_coerce*/
  0, /*nb_int*/
  0, /*nb_long*/
  0, /*nb_float*/
  0, /*nb_oct*/
  0, /*nb_hex*/
  0, /*nb_inplace_add*/
  0, /*nb_inplace_subtract*/
  0, /*nb_inplace_multiply*/
  0, /*nb_inplace_divide*/
  0, /*nb_inplace_remainder*/
  0, /*nb_inplace_power*/
  0, /*nb_inplace_lshift*/
  0, /*nb_inplace_rshift*/
  0, /*nb_inplace_and*/
  0, /*nb_inplace_xor*/
  0, /*nb_inplace_or*/
  0, /*nb_floor_divide*/
  0, /*nb_true_divide*/
  0, /*nb_inplace_floor_divide*/
  0, /*nb_inplace_true_divide*/
  #if Py_TPFLAGS_DEFAULT & Py_TPFLAGS_HAVE_INDEX
  0, /*nb_index*/
  #endif
};

static PySequenceMethods __pyx_tp_as_sequence_ProxyFunction = {
  0, /*sq_length*/
  0, /*sq_concat*/
  0, /*sq_repeat*/
  0, /*sq_item*/
  0, /*sq_slice*/
  0, /*sq_ass_item*/
  0, /*sq_ass_slice*/
  0, /*sq_contains*/
  0, /*sq_inplace_concat*/
  0, /*sq_inplace_repeat*/
};

static PyMappingMethods __pyx_tp_as_mapping_ProxyFunction = {
  0, /*mp_length*/
  0, /*mp_subscript*/
  0, /*mp_ass_subscript*/
};

static PyBufferProcs __pyx_tp_as_buffer_ProxyFunction = {
  0, /*bf_getreadbuffer*/
  0, /*bf_getwritebuffer*/
  0, /*bf_getsegcount*/
  0, /*bf_getcharbuffer*/
};

PyTypeObject __pyx_type_12spidermonkey_ProxyFunction = {
  PyObject_HEAD_INIT(0)
  0, /*ob_size*/
  "spidermonkey.ProxyFunction", /*tp_name*/
  sizeof(struct __pyx_obj_12spidermonkey_ProxyFunction), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_12spidermonkey_ProxyFunction, /*tp_dealloc*/
  0, /*tp_print*/
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  0, /*tp_compare*/
  0, /*tp_repr*/
  &__pyx_tp_as_number_ProxyFunction, /*tp_as_number*/
  &__pyx_tp_as_sequence_ProxyFunction, /*tp_as_sequence*/
  &__pyx_tp_as_mapping_ProxyFunction, /*tp_as_mapping*/
  0, /*tp_hash*/
  __pyx_f_12spidermonkey_13ProxyFunction___call__, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  &__pyx_tp_as_buffer_ProxyFunction, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_GC, /*tp_flags*/
  0, /*tp_doc*/
  __pyx_tp_traverse_12spidermonkey_ProxyFunction, /*tp_traverse*/
  __pyx_tp_clear_12spidermonkey_ProxyFunction, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_12spidermonkey_ProxyFunction, /*tp_methods*/
  0, /*tp_members*/
  0, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  0, /*tp_dictoffset*/
  __pyx_f_12spidermonkey_13ProxyFunction___init__, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_12spidermonkey_ProxyFunction, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
};

static struct PyMethodDef __pyx_methods[] = {
  {"compat_isinstance", (PyCFunction)__pyx_f_12spidermonkey_compat_isinstance, METH_VARARGS|METH_KEYWORDS, 0},
  {"isinteger", (PyCFunction)__pyx_f_12spidermonkey_isinteger, METH_VARARGS|METH_KEYWORDS, 0},
  {"isfloat", (PyCFunction)__pyx_f_12spidermonkey_isfloat, METH_VARARGS|METH_KEYWORDS, 0},
  {"isstringlike", (PyCFunction)__pyx_f_12spidermonkey_isstringlike, METH_VARARGS|METH_KEYWORDS, 0},
  {"issequence", (PyCFunction)__pyx_f_12spidermonkey_issequence, METH_VARARGS|METH_KEYWORDS, 0},
  {"ismapping", (PyCFunction)__pyx_f_12spidermonkey_ismapping, METH_VARARGS|METH_KEYWORDS, 0},
  {"trap", (PyCFunction)__pyx_f_12spidermonkey_trap, METH_VARARGS|METH_KEYWORDS, 0},
  {"js_classname", (PyCFunction)__pyx_f_12spidermonkey_js_classname, METH_VARARGS|METH_KEYWORDS, 0},
  {0, 0, 0, 0}
};

static void __pyx_init_filenames(void); /*proto*/

PyMODINIT_FUNC initspidermonkey(void); /*proto*/
PyMODINIT_FUNC initspidermonkey(void) {
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  __pyx_init_filenames();
  __pyx_m = Py_InitModule4("spidermonkey", __pyx_methods, 0, 0, PYTHON_API_VERSION);
  if (!__pyx_m) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 64; goto __pyx_L1;};
  Py_INCREF(__pyx_m);
  __pyx_b = PyImport_AddModule("__builtin__");
  if (!__pyx_b) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 64; goto __pyx_L1;};
  if (PyObject_SetAttrString(__pyx_m, "__builtins__", __pyx_b) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 64; goto __pyx_L1;};
  if (__Pyx_InitStrings(__pyx_string_tab) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 64; goto __pyx_L1;};
  __pyx_type_12spidermonkey_Runtime.tp_free = _PyObject_GC_Del;
  if (PyType_Ready(&__pyx_type_12spidermonkey_Runtime) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 457; goto __pyx_L1;}
  if (PyObject_SetAttrString(__pyx_m, "Runtime", (PyObject *)&__pyx_type_12spidermonkey_Runtime) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 457; goto __pyx_L1;}
  __pyx_ptype_12spidermonkey_Runtime = &__pyx_type_12spidermonkey_Runtime;
  __pyx_type_12spidermonkey_Context.tp_free = _PyObject_GC_Del;
  if (PyType_Ready(&__pyx_type_12spidermonkey_Context) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 492; goto __pyx_L1;}
  if (PyObject_SetAttrString(__pyx_m, "Context", (PyObject *)&__pyx_type_12spidermonkey_Context) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 492; goto __pyx_L1;}
  __pyx_ptype_12spidermonkey_Context = &__pyx_type_12spidermonkey_Context;
  __pyx_type_12spidermonkey_ProxyClass.tp_free = _PyObject_GC_Del;
  if (PyType_Ready(&__pyx_type_12spidermonkey_ProxyClass) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 701; goto __pyx_L1;}
  if (PyObject_SetAttrString(__pyx_m, "ProxyClass", (PyObject *)&__pyx_type_12spidermonkey_ProxyClass) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 701; goto __pyx_L1;}
  __pyx_ptype_12spidermonkey_ProxyClass = &__pyx_type_12spidermonkey_ProxyClass;
  __pyx_type_12spidermonkey_ProxyObject.tp_free = _PyObject_GC_Del;
  if (PyType_Ready(&__pyx_type_12spidermonkey_ProxyObject) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 775; goto __pyx_L1;}
  if (PyObject_SetAttrString(__pyx_m, "ProxyObject", (PyObject *)&__pyx_type_12spidermonkey_ProxyObject) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 775; goto __pyx_L1;}
  __pyx_ptype_12spidermonkey_ProxyObject = &__pyx_type_12spidermonkey_ProxyObject;
  __pyx_type_12spidermonkey_ProxyFunction.tp_free = _PyObject_GC_Del;
  if (PyType_Ready(&__pyx_type_12spidermonkey_ProxyFunction) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 782; goto __pyx_L1;}
  if (PyObject_SetAttrString(__pyx_m, "ProxyFunction", (PyObject *)&__pyx_type_12spidermonkey_ProxyFunction) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 782; goto __pyx_L1;}
  __pyx_ptype_12spidermonkey_ProxyFunction = &__pyx_type_12spidermonkey_ProxyFunction;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":64 */
  __pyx_1 = __Pyx_Import(__pyx_n_sys, 0); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 64; goto __pyx_L1;}
  if (PyObject_SetAttr(__pyx_m, __pyx_n_sys, __pyx_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 64; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":65 */
  __pyx_1 = __Pyx_Import(__pyx_n_traceback, 0); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 65; goto __pyx_L1;}
  if (PyObject_SetAttr(__pyx_m, __pyx_n_traceback, __pyx_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 65; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":66 */
  __pyx_1 = __Pyx_Import(__pyx_n_inspect, 0); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 66; goto __pyx_L1;}
  if (PyObject_SetAttr(__pyx_m, __pyx_n_inspect, __pyx_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 66; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":67 */
  __pyx_1 = PyList_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 67; goto __pyx_L1;}
  Py_INCREF(__pyx_n_StringIO);
  PyList_SET_ITEM(__pyx_1, 0, __pyx_n_StringIO);
  __pyx_2 = __Pyx_Import(__pyx_n_cStringIO, __pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 67; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  __pyx_1 = PyObject_GetAttr(__pyx_2, __pyx_n_StringIO); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 67; goto __pyx_L1;}
  if (PyObject_SetAttr(__pyx_m, __pyx_n_StringIO, __pyx_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 67; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":68 */
  __pyx_2 = PyList_New(11); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 68; goto __pyx_L1;}
  Py_INCREF(__pyx_n_FloatType);
  PyList_SET_ITEM(__pyx_2, 0, __pyx_n_FloatType);
  Py_INCREF(__pyx_n_IntType);
  PyList_SET_ITEM(__pyx_2, 1, __pyx_n_IntType);
  Py_INCREF(__pyx_n_LongType);
  PyList_SET_ITEM(__pyx_2, 2, __pyx_n_LongType);
  Py_INCREF(__pyx_n_DictType);
  PyList_SET_ITEM(__pyx_2, 3, __pyx_n_DictType);
  Py_INCREF(__pyx_n_LambdaType);
  PyList_SET_ITEM(__pyx_2, 4, __pyx_n_LambdaType);
  Py_INCREF(__pyx_n_MethodType);
  PyList_SET_ITEM(__pyx_2, 5, __pyx_n_MethodType);
  Py_INCREF(__pyx_n_FunctionType);
  PyList_SET_ITEM(__pyx_2, 6, __pyx_n_FunctionType);
  Py_INCREF(__pyx_n_StringType);
  PyList_SET_ITEM(__pyx_2, 7, __pyx_n_StringType);
  Py_INCREF(__pyx_n_StringTypes);
  PyList_SET_ITEM(__pyx_2, 8, __pyx_n_StringTypes);
  Py_INCREF(__pyx_n_ListType);
  PyList_SET_ITEM(__pyx_2, 9, __pyx_n_ListType);
  Py_INCREF(__pyx_n_TupleType);
  PyList_SET_ITEM(__pyx_2, 10, __pyx_n_TupleType);
  __pyx_1 = __Pyx_Import(__pyx_n_types, __pyx_2); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 68; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_2 = PyObject_GetAttr(__pyx_1, __pyx_n_FloatType); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 68; goto __pyx_L1;}
  if (PyObject_SetAttr(__pyx_m, __pyx_n_FloatType, __pyx_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 68; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_2 = PyObject_GetAttr(__pyx_1, __pyx_n_IntType); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 68; goto __pyx_L1;}
  if (PyObject_SetAttr(__pyx_m, __pyx_n_IntType, __pyx_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 68; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_2 = PyObject_GetAttr(__pyx_1, __pyx_n_LongType); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 68; goto __pyx_L1;}
  if (PyObject_SetAttr(__pyx_m, __pyx_n_LongType, __pyx_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 68; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_2 = PyObject_GetAttr(__pyx_1, __pyx_n_DictType); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 68; goto __pyx_L1;}
  if (PyObject_SetAttr(__pyx_m, __pyx_n_DictType, __pyx_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 68; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_2 = PyObject_GetAttr(__pyx_1, __pyx_n_LambdaType); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 68; goto __pyx_L1;}
  if (PyObject_SetAttr(__pyx_m, __pyx_n_LambdaType, __pyx_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 68; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_2 = PyObject_GetAttr(__pyx_1, __pyx_n_MethodType); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 68; goto __pyx_L1;}
  if (PyObject_SetAttr(__pyx_m, __pyx_n_MethodType, __pyx_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 69; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_2 = PyObject_GetAttr(__pyx_1, __pyx_n_FunctionType); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 68; goto __pyx_L1;}
  if (PyObject_SetAttr(__pyx_m, __pyx_n_FunctionType, __pyx_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 69; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_2 = PyObject_GetAttr(__pyx_1, __pyx_n_StringType); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 68; goto __pyx_L1;}
  if (PyObject_SetAttr(__pyx_m, __pyx_n_StringType, __pyx_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 69; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_2 = PyObject_GetAttr(__pyx_1, __pyx_n_StringTypes); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 68; goto __pyx_L1;}
  if (PyObject_SetAttr(__pyx_m, __pyx_n_StringTypes, __pyx_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 69; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_2 = PyObject_GetAttr(__pyx_1, __pyx_n_ListType); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 68; goto __pyx_L1;}
  if (PyObject_SetAttr(__pyx_m, __pyx_n_ListType, __pyx_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 69; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_2 = PyObject_GetAttr(__pyx_1, __pyx_n_TupleType); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 68; goto __pyx_L1;}
  if (PyObject_SetAttr(__pyx_m, __pyx_n_TupleType, __pyx_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 69; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":368 */
  __pyx_1 = PyDict_New(); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 368; goto __pyx_L1;}
  __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 368; goto __pyx_L1;}
  Py_INCREF(PyExc_Exception);
  PyTuple_SET_ITEM(__pyx_2, 0, PyExc_Exception);
  __pyx_3 = __Pyx_CreateClass(__pyx_2, __pyx_1, __pyx_n_JSError, "spidermonkey"); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 368; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  if (PyObject_SetAttr(__pyx_m, __pyx_n_JSError, __pyx_3) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 368; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":455 */
  __pyx_2 = PyList_New(0); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 455; goto __pyx_L1;}
  if (PyObject_SetAttr(__pyx_m, __pyx_n_RUNTIMES, __pyx_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 455; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":470 */
  Py_INCREF(Py_None);
  __pyx_d1 = Py_None;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":586 */
  Py_INCREF(Py_True);
  __pyx_d2 = Py_True;
  Py_INCREF(Py_False);
  __pyx_d3 = Py_False;
  __pyx_3 = PyInt_FromLong(0); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 587; goto __pyx_L1;}
  __pyx_d4 = __pyx_3;
  __pyx_3 = 0;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":754 */
  __pyx_1 = PyList_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 754; goto __pyx_L1;}
  Py_INCREF(__pyx_n_InstanceType);
  PyList_SET_ITEM(__pyx_1, 0, __pyx_n_InstanceType);
  __pyx_2 = __Pyx_Import(__pyx_n_types, __pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 754; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  __pyx_1 = PyObject_GetAttr(__pyx_2, __pyx_n_InstanceType); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 754; goto __pyx_L1;}
  if (PyObject_SetAttr(__pyx_m, __pyx_n_InstanceType, __pyx_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 754; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;

  /* "/usr/local/src/python-spidermonkey/spidermonkey.pyx":1216 */
  return;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  __Pyx_AddTraceback("spidermonkey");
}

static char *__pyx_filenames[] = {
  "spidermonkey.pyx",
};

/* Runtime support code */

static void __pyx_init_filenames(void) {
  __pyx_f = __pyx_filenames;
}

static PyObject *__Pyx_GetName(PyObject *dict, PyObject *name) {
    PyObject *result;
    result = PyObject_GetAttr(dict, name);
    if (!result)
        PyErr_SetObject(PyExc_NameError, name);
    return result;
}

static void __Pyx_WriteUnraisable(char *name) {
    PyObject *old_exc, *old_val, *old_tb;
    PyObject *ctx;
    PyErr_Fetch(&old_exc, &old_val, &old_tb);
    ctx = PyString_FromString(name);
    PyErr_Restore(old_exc, old_val, old_tb);
    if (!ctx)
        ctx = Py_None;
    PyErr_WriteUnraisable(ctx);
}

static void __Pyx_Raise(PyObject *type, PyObject *value, PyObject *tb) {
    Py_XINCREF(type);
    Py_XINCREF(value);
    Py_XINCREF(tb);
    /* First, check the traceback argument, replacing None with NULL. */
    if (tb == Py_None) {
        Py_DECREF(tb);
        tb = 0;
    }
    else if (tb != NULL && !PyTraceBack_Check(tb)) {
        PyErr_SetString(PyExc_TypeError,
            "raise: arg 3 must be a traceback or None");
        goto raise_error;
    }
    /* Next, replace a missing value with None */
    if (value == NULL) {
        value = Py_None;
        Py_INCREF(value);
    }
    #if PY_VERSION_HEX < 0x02050000
    if (!PyClass_Check(type))
    #else
    if (!PyType_Check(type))
    #endif
    {
        /* Raising an instance.  The value should be a dummy. */
        if (value != Py_None) {
            PyErr_SetString(PyExc_TypeError,
                "instance exception may not have a separate value");
            goto raise_error;
        }
        /* Normalize to raise <class>, <instance> */
        Py_DECREF(value);
        value = type;
        #if PY_VERSION_HEX < 0x02050000
            if (PyInstance_Check(type)) {
                type = (PyObject*) ((PyInstanceObject*)type)->in_class;
                Py_INCREF(type);
            }
            else {
                PyErr_SetString(PyExc_TypeError,
                    "raise: exception must be an old-style class or instance");
                goto raise_error;
            }
        #else
            type = (PyObject*) type->ob_type;
            Py_INCREF(type);
            if (!PyType_IsSubtype((PyTypeObject *)type, (PyTypeObject *)PyExc_BaseException)) {
                PyErr_SetString(PyExc_TypeError,
                    "raise: exception class must be a subclass of BaseException");
                goto raise_error;
            }
        #endif
    }
    PyErr_Restore(type, value, tb);
    return;
raise_error:
    Py_XDECREF(value);
    Py_XDECREF(type);
    Py_XDECREF(tb);
    return;
}

static int __Pyx_TypeTest(PyObject *obj, PyTypeObject *type) {
    if (!type) {
        PyErr_Format(PyExc_SystemError, "Missing type object");
        return 0;
    }
    if (obj == Py_None || PyObject_TypeCheck(obj, type))
        return 1;
    PyErr_Format(PyExc_TypeError, "Cannot convert %s to %s",
        obj->ob_type->tp_name, type->tp_name);
    return 0;
}

static int __Pyx_GetStarArgs(
    PyObject **args, 
    PyObject **kwds,
    char *kwd_list[], 
    Py_ssize_t nargs,
    PyObject **args2, 
    PyObject **kwds2,
    char rqd_kwds[])
{
    PyObject *x = 0, *args1 = 0, *kwds1 = 0;
    int i;
    char **p;
    
    if (args2)
        *args2 = 0;
    if (kwds2)
        *kwds2 = 0;
    
    if (args2) {
        args1 = PyTuple_GetSlice(*args, 0, nargs);
        if (!args1)
            goto bad;
        *args2 = PyTuple_GetSlice(*args, nargs, PyTuple_GET_SIZE(*args));
        if (!*args2)
            goto bad;
    }
    else if (PyTuple_GET_SIZE(*args) > nargs) {
        int m = nargs;
        int n = PyTuple_GET_SIZE(*args);
        PyErr_Format(PyExc_TypeError,
            "function takes at most %d positional arguments (%d given)",
                m, n);
        goto bad;
    }
    else {
        args1 = *args;
        Py_INCREF(args1);
    }
    
    if (rqd_kwds && !*kwds)
            for (i = 0, p = kwd_list; *p; i++, p++)
                if (rqd_kwds[i])
                    goto missing_kwarg;
    
    if (kwds2) {
        if (*kwds) {
            kwds1 = PyDict_New();
            if (!kwds1)
                goto bad;
            *kwds2 = PyDict_Copy(*kwds);
            if (!*kwds2)
                goto bad;
            for (i = 0, p = kwd_list; *p; i++, p++) {
                x = PyDict_GetItemString(*kwds, *p);
                if (x) {
                    if (PyDict_SetItemString(kwds1, *p, x) < 0)
                        goto bad;
                    if (PyDict_DelItemString(*kwds2, *p) < 0)
                        goto bad;
                }
                else if (rqd_kwds && rqd_kwds[i])
                    goto missing_kwarg;
            }
        }
        else {
            *kwds2 = PyDict_New();
            if (!*kwds2)
                goto bad;
        }
    }
    else {
        kwds1 = *kwds;
        Py_XINCREF(kwds1);
        if (rqd_kwds && *kwds)
            for (i = 0, p = kwd_list; *p; i++, p++)
                if (rqd_kwds[i] && !PyDict_GetItemString(*kwds, *p))
                        goto missing_kwarg;
    }
    
    *args = args1;
    *kwds = kwds1;
    return 0;
missing_kwarg:
    PyErr_Format(PyExc_TypeError,
        "required keyword argument '%s' is missing", *p);
bad:
    Py_XDECREF(args1);
    Py_XDECREF(kwds1);
    if (args2) {
        Py_XDECREF(*args2);
    }
    if (kwds2) {
        Py_XDECREF(*kwds2);
    }
    return -1;
}

static int __Pyx_ArgTypeTest(PyObject *obj, PyTypeObject *type, int none_allowed, char *name) {
    if (!type) {
        PyErr_Format(PyExc_SystemError, "Missing type object");
        return 0;
    }
    if ((none_allowed && obj == Py_None) || PyObject_TypeCheck(obj, type))
        return 1;
    PyErr_Format(PyExc_TypeError,
        "Argument '%s' has incorrect type (expected %s, got %s)",
        name, type->tp_name, obj->ob_type->tp_name);
    return 0;
}

static void __Pyx_UnpackError(void) {
    PyErr_SetString(PyExc_ValueError, "unpack sequence of wrong size");
}

static PyObject *__Pyx_UnpackItem(PyObject *iter) {
    PyObject *item;
    if (!(item = PyIter_Next(iter))) {
        if (!PyErr_Occurred())
            __Pyx_UnpackError();
    }
    return item;
}

static int __Pyx_EndUnpack(PyObject *iter) {
    PyObject *item;
    if ((item = PyIter_Next(iter))) {
        Py_DECREF(item);
        __Pyx_UnpackError();
        return -1;
    }
    else if (!PyErr_Occurred())
        return 0;
    else
        return -1;
}

static int __Pyx_GetException(PyObject **type, PyObject **value, PyObject **tb) {
    PyThreadState *tstate = PyThreadState_Get();
    PyErr_Fetch(type, value, tb);
    PyErr_NormalizeException(type, value, tb);
    if (PyErr_Occurred())
        goto bad;
    Py_INCREF(*type);
    Py_INCREF(*value);
    Py_INCREF(*tb);
    Py_XDECREF(tstate->exc_type);
    Py_XDECREF(tstate->exc_value);
    Py_XDECREF(tstate->exc_traceback);
    tstate->exc_type = *type;
    tstate->exc_value = *value;
    tstate->exc_traceback = *tb;
    return 0;
bad:
    Py_XDECREF(*type);
    Py_XDECREF(*value);
    Py_XDECREF(*tb);
    return -1;
}

static PyObject *__Pyx_GetItemInt(PyObject *o, Py_ssize_t i) {
    PyTypeObject *t = o->ob_type;
    PyObject *r;
    if (t->tp_as_sequence && t->tp_as_sequence->sq_item)
        r = PySequence_GetItem(o, i);
    else {
        PyObject *j = PyInt_FromLong(i);
        if (!j)
            return 0;
        r = PyObject_GetItem(o, j);
        Py_DECREF(j);
    }
    return r;
}

static int __Pyx_SetItemInt(PyObject *o, Py_ssize_t i, PyObject *v) {
    PyTypeObject *t = o->ob_type;
    int r;
    if (t->tp_as_sequence && t->tp_as_sequence->sq_item)
        r = PySequence_SetItem(o, i, v);
    else {
        PyObject *j = PyInt_FromLong(i);
        if (!j)
            return -1;
        r = PyObject_SetItem(o, j, v);
        Py_DECREF(j);
    }
    return r;
}

static int __Pyx_InitStrings(__Pyx_StringTabEntry *t) {
    while (t->p) {
        *t->p = PyString_FromStringAndSize(t->s, t->n - 1);
        if (!*t->p)
            return -1;
        if (t->i)
            PyString_InternInPlace(t->p);
        ++t;
    }
    return 0;
}

static PyObject *__Pyx_Import(PyObject *name, PyObject *from_list) {
    PyObject *__import__ = 0;
    PyObject *empty_list = 0;
    PyObject *module = 0;
    PyObject *global_dict = 0;
    PyObject *empty_dict = 0;
    PyObject *list;
    __import__ = PyObject_GetAttrString(__pyx_b, "__import__");
    if (!__import__)
        goto bad;
    if (from_list)
        list = from_list;
    else {
        empty_list = PyList_New(0);
        if (!empty_list)
            goto bad;
        list = empty_list;
    }
    global_dict = PyModule_GetDict(__pyx_m);
    if (!global_dict)
        goto bad;
    empty_dict = PyDict_New();
    if (!empty_dict)
        goto bad;
    module = PyObject_CallFunction(__import__, "OOOO",
        name, global_dict, empty_dict, list);
bad:
    Py_XDECREF(empty_list);
    Py_XDECREF(__import__);
    Py_XDECREF(empty_dict);
    return module;
}

static PyObject *__Pyx_CreateClass(
    PyObject *bases, PyObject *dict, PyObject *name, char *modname)
{
    PyObject *py_modname;
    PyObject *result = 0;
    
    py_modname = PyString_FromString(modname);
    if (!py_modname)
        goto bad;
    if (PyDict_SetItemString(dict, "__module__", py_modname) < 0)
        goto bad;
    result = PyClass_New(bases, dict, name);
bad:
    Py_XDECREF(py_modname);
    return result;
}

#include "compile.h"
#include "frameobject.h"
#include "traceback.h"

static void __Pyx_AddTraceback(char *funcname) {
    PyObject *py_srcfile = 0;
    PyObject *py_funcname = 0;
    PyObject *py_globals = 0;
    PyObject *empty_tuple = 0;
    PyObject *empty_string = 0;
    PyCodeObject *py_code = 0;
    PyFrameObject *py_frame = 0;
    
    py_srcfile = PyString_FromString(__pyx_filename);
    if (!py_srcfile) goto bad;
    py_funcname = PyString_FromString(funcname);
    if (!py_funcname) goto bad;
    py_globals = PyModule_GetDict(__pyx_m);
    if (!py_globals) goto bad;
    empty_tuple = PyTuple_New(0);
    if (!empty_tuple) goto bad;
    empty_string = PyString_FromString("");
    if (!empty_string) goto bad;
    py_code = PyCode_New(
        0,            /*int argcount,*/
        0,            /*int nlocals,*/
        0,            /*int stacksize,*/
        0,            /*int flags,*/
        empty_string, /*PyObject *code,*/
        empty_tuple,  /*PyObject *consts,*/
        empty_tuple,  /*PyObject *names,*/
        empty_tuple,  /*PyObject *varnames,*/
        empty_tuple,  /*PyObject *freevars,*/
        empty_tuple,  /*PyObject *cellvars,*/
        py_srcfile,   /*PyObject *filename,*/
        py_funcname,  /*PyObject *name,*/
        __pyx_lineno,   /*int firstlineno,*/
        empty_string  /*PyObject *lnotab*/
    );
    if (!py_code) goto bad;
    py_frame = PyFrame_New(
        PyThreadState_Get(), /*PyThreadState *tstate,*/
        py_code,             /*PyCodeObject *code,*/
        py_globals,          /*PyObject *globals,*/
        0                    /*PyObject *locals*/
    );
    if (!py_frame) goto bad;
    py_frame->f_lineno = __pyx_lineno;
    PyTraceBack_Here(py_frame);
bad:
    Py_XDECREF(py_srcfile);
    Py_XDECREF(py_funcname);
    Py_XDECREF(empty_tuple);
    Py_XDECREF(empty_string);
    Py_XDECREF(py_code);
    Py_XDECREF(py_frame);
}
